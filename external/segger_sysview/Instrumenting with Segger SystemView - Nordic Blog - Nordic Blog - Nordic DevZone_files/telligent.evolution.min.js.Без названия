(function(){var X,u;(function(f){var e={},k=function(h){var n=e[h];if(n==f)throw"Module not defined or loaded: "+h;if(n.compiled)return n.compiled;var g=[];if(n.dependencies&&0<n.dependencies.length)for(var c=0;c<n.dependencies.length;c++)g.push(k(n.dependencies[c]));n.compiled=n.factory.apply(this,g.concat(n.extraArguments));if(!n.compiled)throw"Module defined but not loadable: "+h;return n.compiled};X=function(e,n){var g=e,c=n,d=2;g.splice||(c=g,g=f,d--);for(var d=Array.prototype.slice.call(arguments,
d),a=[],b=0;b<g.length;b++)a.push(k(g[b]));c.apply(this,a.concat(d))};u=function(h,n,g){var c=n,d=g,a=3;c.splice||(d=c,c=f,a--);a=Array.prototype.slice.call(arguments,a);e[h]={dependencies:c,factory:d,extraArguments:a||[]}}})();u("components","component.bookmark component.collapseexpand component.like component.links component.moderate component.page component.rate component.searchresult component.tag component.theater component.webpreview component.tourtip component.viewhtml component.previewhtml component.masonry component.resizedimage component.tip component.select component.poll component.convertcontent component.feature component.forumvotes component.forumqualityvotes component.vote component.squeezetext component.code component.loading component.presentcontent component.presentservice component.userpresence component.agodate".split(" "),
function(){return{}});u("component.agodate",["module.ui"],function(f,e,k,h){function n(d){d=e(d);d.html(c.formatAgoDate(c.parseDate(d.attr("data-dateutc"))))}function g(){e(".ui-agodate").each(function(){n(this)})}var c=e.telligent.evolution;e.telligent.evolution.ui.components.agodate={setup:function(){k.setInterval(g,15E3)},add:function(c,a){n(c)}};return{}},jQuery,window);u("component.bookmark",["module.ui"],function(f,e,k,h){e.telligent.evolution.ui.components.bookmark={setup:function(){},add:function(f,
g){f.empty();var c={contentId:g.contentid,contentTypeId:g.contenttypeid,typeId:g.bookmarktypeid,initialState:"true"==g.value,contentTypeName:g.contenttypename,onBookmark:function(c,a,b,p){e.telligent.evolution.post({url:e.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/bookmark.json?ContentId={ContentId}&ContentTypeId={ContentTypeId}"+(b?"&TypeId="+b:""),data:{ContentId:c,ContentTypeId:a},dataType:"json",success:function(a){p()}})},onUnbookmark:function(c,a,b,p){e.telligent.evolution.del({url:e.telligent.evolution.site.getBaseUrl()+
"api.ashx/v2/bookmark.json?ContentId={ContentId}"+(b?"&TypeId="+b:""),data:{ContentId:c},dataType:"json",success:function(a){p()}})}};g.configuration.deleteBookmarkText&&(c.deleteBookmarkText=g.configuration.deleteBookmarkText);g.configuration.addBookmarkText&&(c.addBookmarkText=g.configuration.addBookmarkText);g.configuration.processingText&&(c.processingText=g.configuration.processingText);g.configuration.addBookmarkCssClass&&(c.addBookmarkCssClass=g.configuration.addBookmarkCssClass);g.configuration.deleteBookmarkCssClass&&
(c.deleteBookmarkCssClass=g.configuration.deleteBookmarkCssClass);g.configuration.processingCssClass&&(c.processingCssClass=g.configuration.processingCssClass);e(f).evolutionBookmark(c)}};return{}},jQuery,window);u("component.code",["module.ui"],function(f,e,k,h){e.telligent.evolution.ui.components.code={setup:function(){},add:function(f,g){var c={};e(f).data("_code_init")||(e(f).data("_code_init",!0),g.mode&&(c.mode=g.mode),g.theme!==h&&(c.theme=g.theme),g.minlines!==h&&(c.minLines=parseInt(g.minlines,
10)),g.maxlines!==h&&(c.maxLines=parseInt(g.maxlines,10)),g.readonly&&(c.readOnly="true"===g.readonly?!0:!1),g.gutter&&(c.gutter="true"===g.gutter?!0:!1),g.wordwrap&&(c.wordWrap="true"===g.wordwrap?!0:!1),g.enablefullscreen&&(c.enableFullScreen="false"===g.enablefullscreen?!1:!0),g.sourcecomparison&&(c.sourceComparison=sourceComparison),e(f).evolutionCodeEditor(c))}};return{}},jQuery,window);u("component.collapseexpand",["module.ui"],function(f,e,k,h){e.telligent.evolution.ui.components.collapseexpand=
{setup:function(){},add:function(f,g){var c=e("<a></a>").attr({href:"#"}).text(g.collapsetext),d=!1;c.click(function(){d?(f.slideUp(),c.text(g.collapsetext)):(f.slideDown(),c.text(g.expandtext));d=!d;return!1});f.removeClass().before(c).hide()}};return{}},jQuery,window);u("component.convertcontent",["module.ui","lib.util"],function(f,e,k,h,n){k.telligent=k.telligent||{};k.telligent.evolution=k.telligent.evolution||{};k.telligent.evolution.ui=k.telligent.evolution.ui||{};k.telligent.evolution.ui.components=
k.telligent.evolution.ui.components||{};k.telligent.evolution.ui.components.convertcontent={setup:function(){},add:function(g,c){var d=k('<a href="#">'+c.label+"</a>");k(g).empty().append(d);d.on("click.convertcontent",function(a){a.preventDefault();h.location="#_cptype=panel&_cpcontexttype=Explicit&_cppanelid=63f2015f-0f61-49e0-ac07-598d70cdcbff&sourceContentId="+c.sourcecontentid+"&sourceContentTypeId="+c.sourcecontenttypeid;return!1})}};return{}},jQuery,window);u("component.docpreview",["module.ui"],
function(f,e,k,h){var n=function(a){var b=!1,c=[],d={index:-1,offsetLeft:0,offsetTop:0},p=e('<div class="doc-preview-highlight"></div>').css({position:"absolute",display:"none",opacity:".5","box-sizing":"border-box","z-index":"3"}),g=e('<div class="doc-preview-current-page"></div>').css({position:"absolute",display:"none",opacity:".75","box-sizing":"border-box","z-index":"4",bottom:"32px",right:"32px"}),v=null,s=1,f={duration:250,queue:!1,easing:"swing"},n=null;scrollbarWidth=pageOffsetWidth=pageOffsetHeight=
0;isAdjusting=!1;var z=function(b,c){a.width=b;a.height=c;C.css({width:a.width+"px",height:a.height+"px"});A()},A=function(){if(b){isAdjusting=!0;for(var g=C.width(),r=C.height(),z=E=0,A=0,h=0;h<c.length;h++)z=c[h].height,c[h].scale="height"==a.fit?r/a.pageData[h][1]*s:"width"==a.fit?g/a.pageData[h][0]*s:Math.min(r/a.pageData[h][1],g/a.pageData[h][0])*s,c[h].width=a.pageData[h][0]*c[h].scale,c[h].width>A&&(A=c[h].width+pageOffsetWidth),c[h].height=a.pageData[h][1]*c[h].scale,c[h].left=Math.max(0,
(g-c[h].width-pageOffsetWidth)/2),c[h].top+=E,c[h].url=null,c[h].elm&&(c[h].elm.animate({width:c[h].width+"px",height:c[h].height+"px",left:c[h].left+"px",top:c[h].top+"px"},f),e("img",c[h].elm).animate({width:c[h].width+"px",height:c[h].height+"px"},f)),E+=c[h].height-z,z=c[h].top+c[h].height;n.animate({height:z+"px",width:Math.max(g,A)+"px"},e.extend({},f,{done:function(){isAdjusting=!1}}))}else{c=[];C.empty();n=e("<div></div>").css({position:"relative",padding:"0px",margin:"0px","border-width":"0px"});
C.append(n);g=e("<div></div>").css({width:"100px",height:"100px",overflow:"scroll",position:"absolute",top:"-99999px","-webkit-transform":"translate3d(0,0,0)"});e("body").append(g);scrollbarWidth=g.get(0).offsetWidth-g.get(0).clientWidth;r=parseInt(C.css("padding-left"),10);isNaN(r)&&(r=0);C.css({"padding-right":scrollbarWidth+r+"px"});g.remove();g=e('<div class="doc-preview-page"></div>').css({width:"0px",height:"0px",position:"absolute",top:"0px","margin-left":"auto","margin-right":"auto","-webkit-transform":"translate3d(0,0,0)"});
n.append(g);pageOffsetHeight=g.outerHeight();pageOffsetWidth=g.outerWidth();g.remove();for(var g=C.width(),r=C.height(),E=0,h=0;h<a.pageData.length;h++)A="height"==a.fit?r/a.pageData[h][1]*s:"width"==a.fit?g/a.pageData[h][0]*s:Math.min(r/a.pageData[h][1],g/a.pageData[h][0])*s,c.push({width:a.pageData[h][0]*A,height:a.pageData[h][1]*A,url:null,top:E,left:Math.max(0,(g-a.pageData[h][0]*A-pageOffsetWidth)/2),elm:null,scale:A}),E+=pageOffsetHeight+a.pageData[h][1]*A;n.css({height:E+"px"});b=!0}v&&(0<=
v.pageIndex&&v.pageIndex<c.length)&&(g=c[v.pageIndex],p.appendTo(g.elm).animate({top:v.y*g.scale+"px",left:v.x*g.scale+"px",width:v.width*g.scale+"px",height:v.height*g.scale+"px"},f).show());0<=d.index&&d.index<c.length&&(g=c[d.index].top+d.offsetTop*c[d.index].scale,r=d.offsetLeft*c[d.index].scale,d.centerOffset&&(g=Math.max(0,g-C.height()/2),r=Math.max(0,r-C.width()/2),c[d.index].width-r<C.width()&&(r=Math.max(0,c[d.index].width-C.width()))),C.animate({scrollTop:g,scrollLeft:r},f));k.setTimeout(function(){D(!0)},
349)},h=function(b,c){for(var d=Math.round(window.devicePixelRatio||1)||1,d=72*c*s*d,l=null,t=null,p=0;p<a.pageUrlFormats.length;p++)if(null==t||Math.abs(t-d)>Math.abs(a.pageUrlFormats[p].dpi-d))l=a.pageUrlFormats[p].format,t=a.pageUrlFormats[p].dpi;return null!=l?l.replace(/\{PAGE\}/,b+1):null},D=function(a){if(b){for(var m=C.scrollTop(),p=m+C.height(),g=-1,s=0;s<c.length;s++)if(m<=c[s].top+c[s].height&&p>=c[s].top){g=s;break}if(0<=g){var r={};d.index=g;d.offsetTop=Math.max(0,(m-c[g].top)/c[g].scale);
d.offsetLeft=Math.max(0,(C.scrollLeft()-c[g].left)/c[g].scale);d.centerOffset=!1;L(g,a);r[g]=!0;for(s=g+1;s<c.length&&m<=c[s].top+c[s].height&&p>=c[s].top;s++)L(s,a),r[s]=!0;n.children(".doc-preview-page").each(function(){var a=e(this),b=parseInt(a.data("pageindex"));isNaN(b)||(!0===r[b]||null!=v&&v.pageIndex==b)||(k.clearTimeout(a.data("imageLoadTimeout")),a.remove(),c[b].elm=null)})}}},L=function(a,d){if(b){var l=c[a];if(l&&(null===l.elm&&(l.elm=e('<div class="doc-preview-page"></div>').attr("data-pageindex",
a).css({position:"absolute",top:l.top+"px",width:l.width+"px",height:l.height+"px",left:l.left+"px","-webkit-transform":"translate3d(0,0,0)"}),n.append(l.elm)),d)){var m=l.url,p=!1;null==m&&(l.url=m=h(a,l.scale),p=!0);0==l.elm.children("img").length?(m=new Image,m.onload=function(){l.elm&&l.elm.append(e("<img />").attr("src",l.url).css({width:l.width+"px",height:l.height+"px","-webkit-transform":"translate3d(0,0,0)",position:"absolute",top:"0px",left:"0px",opacity:"0"}).animate({opacity:"1"},f))},
m.src=l.url):p&&0>l.elm.children("img").attr("src").indexOf(l.url)&&(m=new Image,m.onload=function(){if(l.elm){var a=l.elm.children("img");a.css({"z-index":"2"}).animate({opacity:"0"},e.extend({},f,{complete:function(){a.remove()}}));l.elm.append(e("<img />").attr("src",l.url).css({width:l.width+"px",height:l.height+"px","-webkit-transform":"translate3d(0,0,0)",position:"absolute",top:"0px",left:"0px",opacity:"0"}).animate({opacity:"1"},f))}},m.src=l.url)}}},B=null,G=null,J=-1,M=0;a.parent.css({position:"relative"}).append(g);
var P=function(){J=1;k.clearTimeout(G);g.text(a.currentPageText.replace(/\{currentpage\}/g,d.index+1).replace(/\{totalpages\}/g,c.length));g.finish().fadeIn(f);J=0;G=k.setTimeout(function(){0==J&&(g.finish().fadeOut(f),J=-1)},1E3)},C=e('<div class="doc-preview-container"></div>').css({overflow:"auto","box-sizing":"border-box",position:"relative","-webkit-overflow-scrolling":"touch","-webkit-transform":"translate3d(0,0,0)"}).on("scroll",function(a){a=(new Date).getTime();50<a-M&&!isAdjusting&&(M=a,
D(!1),C.scrollTop(),b&&P(),clearTimeout(B),B=k.setTimeout(function(){b&&(D(!0),P())},150))}).on("doubletap",function(a){if(a.pointers&&0<a.pointers.length){var b=a.pointers[0].pageX;a=a.pointers[0].pageY;var m=C.offset();if(0<scrollbarWidth&&(a>=C.height()+m.top-scrollbarWidth||b>=C.width()+m.left-scrollbarWidth))return;a=a-m.top+C.scrollTop();b=b-m.left+C.scrollLeft();for(m=0;m<c.length;m++)if(a<=c[m].top+c[m].height&&a>=c[m].top){d.index=m;d.offsetTop=Math.max(0,(a-c[m].top)/c[m].scale);d.offsetLeft=
Math.max(0,(b-c[m].left)/c[m].scale);d.centerOffset=!0;break}}s=1!=s?1:2;A();return!1}).on("panstart panend pan swipe",function(a){("left"==a.direction||"right"==a.direction)&&C.width()<C.get(0).scrollWidth?a.stopPropagation():("up"==a.direction||"down"==a.direction)&&C.height()<C.get(0).scrollHeight&&a.stopPropagation()});a.parent.append(C);0<a.pageData.length&&(d.index=0,d.offsetLeft=0,d.offsetTop=0,d.centerOffset=!1);z(a.width,a.height);return{showPage:function(a,b){var m=c[a];m&&(d.index=a,d.offsetLeft=
0,d.offsetTop=0,!1!==b?C.animate({scrollTop:m.top},f):C.scrollTop(m.top))},highlight:function(a,b,m,q,g,s){var r=c[a];if(r&&(L(a,!0),page=r.elm)){var z=page.get(0);v={pageIndex:a,x:b,y:m,width:q,height:g};p.appendTo(page).css({top:m*r.scale+"px",left:b*r.scale+"px",width:q*r.scale+"px",height:g*r.scale+"px"}).show();g=z.offsetTop+m*r.scale+(g*r.scale-C.height())/2;0>g&&(g=0);var e=0;page.width()>C.width()&&(e=z.offsetLeft+b*r.scale+(q*r.scale-C.width())/2);0>e&&(e=0);d.index=a;d.offsetLeft=b;d.offsetTop=
m;d.centerOffset=!0;!1!==s?C.animate({scrollTop:g,scrollLeft:e},f):C.scrollTop(g).scrollLeft(e)}},clearHighlight:function(){v&&(p.hide(),v=null)},resize:z,changeFit:function(b){a.fit=b;s=1;A()},getCurrentPage:function(){return d.index},getPageCount:function(){return a.pageData.length}}},g=function(a){var b=0.8*e(k).height();b<a.settings.height?a.internal.state.css({"max-height":b+"px"}):a.internal.state.css({"max-height":"100%"})},c=function(a){if(a.internal.initialized){var b=a.internal.container.width(),
c=a.internal.container.height();if(b!=a.internal.lastWidth||c!=a.internal.lastHeight)a.internal.lastWidth=b,a.internal.lastHeight=c,c-=a.internal.toolbar.outerHeight(),a.internal.initialized&&(a.internal.pageRenderer.resize(b,c),480>=b?(e(".fit-width, .fit-height, .fit-page",a.internal.container).hide(),d(a,"width")):e(".fit-width, .fit-height, .fit-page",a.internal.container).show())}},d=function(a,b){e(".doc-preview-toolbar-item.fit-width, .doc-preview-toolbar-item.fit-height, .doc-preview-toolbar-item.fit-page",
a.internal.toolbar).removeClass("selected");a.settings.fit=b;e(".doc-preview-toolbar-item.fit-"+a.settings.fit,a.internal.toolbar).addClass("selected");a.internal.initialized&&a.internal.pageRenderer.changeFit(a.settings.fit)},a=function(b,c,d,l){if(b.settings.keywordUrlFormat)if(!c||0>=c.length)b.internal.pageRenderer.clearHighlight();else{var p=function(){if(c==b.internal.findContext.keyword){var p=b.internal.findContext.matchIndex;if(b.internal.findContext.pageIndex!=d||l)p=-1;for(var g=b.internal.keywordData[d],
s=!1,p=p+1;p<g.length&&!s;p++)0<=g[p][0].indexOf(c)&&(b.internal.findContext.matchIndex=p,b.internal.findContext.pageIndex=d,s=!0);s?0<=b.internal.findContext.matchIndex&&(g=g[b.internal.findContext.matchIndex],b.internal.pageRenderer.highlight(d,g[1],g[2],g[3],g[4])):l&&b.internal.findContext.pageIndex==d?b.internal.pageRenderer.clearHighlight():d+1<b.internal.pageRenderer.getPageCount()?a(b,c,d+1,l):a(b,c,0,!0)}};void 0===b.internal.keywordData[d]?(b.internal.keywordData.size>b.settings.keywordCachePageSize&&
(b.internal.keywordData={size:0}),e.telligent.evolution.get({url:b.settings.keywordUrlFormat.replace(/\{PAGE\}/,d+1),dataType:"json",success:function(a){a&&a.text?(b.internal.keywordData[d]=a.text,b.internal.keywordData.size++):b.internal.keywordData[d]=[];p()},error:function(){b.internal.keywordData[d]=[];p()}})):p()}},b=function(a){return this.each(function(){var b={settings:e.extend({},e.fn.documentPreview.defaults,a||{}),internal:{state:e(this),initialized:!1,pageRenderer:null,lastWidth:0,lastHeight:0,
toolbar:null,findHandle:null,isFullscreen:!1}};b.internal.state.data("documentPreview",b).css({width:b.settings.width+"px",height:b.settings.height+"px"});b.internal.lastWidth=0;b.internal.lastHeight=0;b.internal.container=e("<div></div>").css({width:"100%",height:"100%",overflow:"hidden"});b.internal.state.css({"max-width":"100%","max-height":"100%",overflow:"hidden"});k.setInterval(function(){c(b)},499);g(b);e(k).on("resized",function(){g(b)});b.internal.state.append(b.internal.container);b.internal.toolbar=
e('<div class="doc-preview-toolbar"></div>').append(e('<a class="doc-preview-toolbar-item fit-width" href="#"></a>').html(b.settings.text.fitwidth).attr("title",b.settings.text.fitwidth).click(function(){b.internal.state.documentPreview("fit","width");return!1})).append(e('<a class="doc-preview-toolbar-item fit-height" href="#"></a>').html(b.settings.text.fitheight).attr("title",b.settings.text.fitheight).click(function(){b.internal.state.documentPreview("fit","height");return!1})).append(e('<a class="doc-preview-toolbar-item fit-page" href="#"></a>').html(b.settings.text.fitpage).attr("title",
b.settings.text.fitpage).click(function(){b.internal.state.documentPreview("fit","page");return!1})).append(e('<a class="doc-preview-toolbar-item fullscreen" href="#"></a>').html(b.settings.text.enterfullscreen).attr("title",b.settings.text.enterfullscreen).click(function(){b.internal.state.documentPreview("fullscreen")?b.internal.state.documentPreview("fullscreen",!1):b.internal.state.documentPreview("fullscreen",!0);return!1})).append(e('<span class="doc-preview-toolbar-item find"><input type="text" /></span>').on("keyup",
"input",function(a){k.clearTimeout(b.internal.findHandle);var c=e(this).val();b.internal.findContext&&b.internal.findContext.keyword==c?13==a.which&&b.internal.state.documentPreview("findNext",c):b.internal.findHandle=k.setTimeout(function(){b.internal.state.documentPreview("findNext",c)},249)})).append(e('<a class="doc-preview-toolbar-item download-pdf" href="#"></a>').html(b.settings.text.downloadpdf).attr("title",b.settings.text.downloadpdf).click(function(){b.internal.state.documentPreview("downloadPdf");
return!1}));e("input",b.internal.toolbar).attr("placeholder",b.settings.text.find);e(".doc-preview-toolbar-item.fit-"+b.settings.fit,b.internal.toolbar).addClass("selected");var d=b.internal.container.get(0);d.requestFullscreen||(d.msRequestFullscreen||d.mozRequestFullScreen||d.webkitRequestFullscreen)||e(".doc-preview-toolbar-item.fullscreen",b.internal.toolbar).hide();b.settings.keywordUrlFormat&&!/(Android|iPhone|iPad|iPod)/.test(navigator.userAgent)||e(".doc-preview-toolbar-item.find",b.internal.toolbar).hide();
b.internal.container.attr("tabindex","0").css({outline:"none !important"}).on("keydown",function(a){if(78==a.which&&!e(a.target).is("input")||34==a.which)return b.internal.state.documentPreview("pageIndex","+1"),a.stopPropagation(),a.preventDefault(),!1;if(80==a.which&&!e(a.target).is("input")||33==a.which)return b.internal.state.documentPreview("pageIndex","-1"),a.stopPropagation(),a.preventDefault(),!1});b.internal.container.append(b.internal.toolbar);e.telligent.evolution.get({url:b.settings.jsonUrl,
dataType:"json",success:function(a){var d=b.settings.height-b.internal.toolbar.outerHeight();b.internal.pageRenderer=new n({parent:b.internal.container,pageData:a.pages,pageUrlFormats:b.settings.imageUrlFormats,width:b.settings.width,height:d,fit:b.settings.fit,currentPageText:b.settings.text.page});b.internal.keywordData={size:0};b.internal.findContext={keyword:null,matchIndex:-1,pageIndex:-1};b.internal.initialized=!0;c(b)}})})},p={fit:function(a){if(void 0===a){var b=this.data("documentPreview");
return b?b.settings.fit:null}return this.each(function(){var b=e(this).data("documentPreview");b&&d(b,a)})},resize:function(a,b){return this.each(function(){var d=e(this).data("documentPreview");d&&(d.settings.width=a,d.settings.height=b,d.internal.state.css({width:a+"px",height:b+"px"}),g(d),c(d))})},fullscreen:function(a){if(void 0==a){var b=e(this).data("documentPreview");return null!=b&&b.internal.isFullscreen}return this.each(function(){var b=e(this).data("documentPreview");if(b&&b.internal.initialized)if(a){if(!b.internal.isFullscreen){var d=
b.internal.container.get(0);if(d.requestFullscreen)d.requestFullScreen();else if(d.msRequestFullscreen)d.msRequestFullscreen();else if(d.mozRequestFullScreen)d.mozRequestFullScreen();else if(d.webkitRequestFullscreen)d.webkitRequestFullscreen();else{b.internal.isFullscreen=!1;return}b.internal.isFullscreen=!0;e(".fullscreen",b.internal.toolbar).addClass("selected").html(b.settings.text.exitfullscreen).attr("title",b.settings.text.exitfullscreen);var p=k.setInterval(function(){document.fullscreenElement||
document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?c(b):(c(b),k.clearInterval(p),b.internal.isFullscreen=!1,e(".fullscreen",b.internal.toolbar).removeClass("selected").html(b.settings.text.enterfullscreen).attr("title",b.settings.text.enterfullscreen))},249);e(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",function(){document.fullscreenElement||(document.mozFullScreenElement||document.webkitFullscreenElement||
document.msFullscreenElement)||(c(b),k.clearInterval(p),b.internal.isFullscreen=!1,e(".fullscreen",b.internal.toolbar).removeClass("selected").html(b.settings.text.enterfullscreen).attr("title",b.settings.text.enterfullscreen))})}}else b.internal.isFullscreen&&(d=document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.msExitFullscreen)&&(d.call(document,[]),c(b),k.clearInterval(p),b.internal.isFullscreen=!1,e(".fullscreen",b.internal.toolbar).removeClass("selected").html(b.settings.text.enterfullscreen).attr("title",
b.settings.text.enterfullscreen))})},findNext:function(b){return this.each(function(){var c=e(this).data("documentPreview");c&&c.internal.initialized&&(keyword=(b||"").toLowerCase(),c.internal.findContext.keyword!=keyword&&(c.internal.findContext.keyword=keyword,e("input",c.internal.toolbar).val(b),c.internal.findContext.matchIndex=-1,c.internal.findContext.pageIndex=c.internal.pageRenderer.getCurrentPage()),a(c,keyword,c.internal.findContext.pageIndex,!1))})},clearFind:function(){return this.each(function(){var a=
e(this).data("documentPreview");a&&a.internal.initialized&&(a.internal.findContext.keyword="",a.internal.findContext.matchIndex=-1,e("input",a.internal.toolbar).val(""),a.internal.pageRenderer.clearHighlight())})},pageIndex:function(a){if(void 0==a){var b=e(this).data("documentPreview");return null!=b&&b.internal.initialized?b.internal.pageRenderer.getCurrentPage():-1}return this.each(function(){var b=e(this).data("documentPreview");if(b&&b.internal.initialized){var c=(a+"").substr(0,1);"+"==c?(c=
parseInt((a+"").substr(1),10),isNaN(c)||b.internal.pageRenderer.showPage(b.internal.pageRenderer.getCurrentPage()+c)):"-"==c?(c=parseInt((a+"").substr(1),10),isNaN(c)||b.internal.pageRenderer.showPage(b.internal.pageRenderer.getCurrentPage()-c)):(c=parseInt(a,10),isNaN(c)||b.internal.pageRenderer.showPage(c))}})},pageCount:function(){var a=e(this).data("documentPreview");return null!=a&&a.internal.initialized?a.internal.pageRenderer.getPageCount():0},downloadPdf:function(){return this.each(function(){var a=
e(this).data("documentPreview");a&&a.settings.pdfUrl&&k.open(a.settings.pdfUrl,"_system")})}};e.fn.documentPreview=function(a){if(a in p)return p[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)e.error("Method "+a+" does not exist on jQuery.fn.documentPreview");else return b.apply(this,arguments)};e.extend(e.fn.documentPreview,{defaults:{jsonUrl:null,imageUrlFormats:[],keywordUrlFormat:null,pdfUrl:null,width:400,height:300,fit:"width",keywordCachePageSize:5,text:{fitwidth:"Fit to width",
fitheight:"Fit to height",fitpage:"Fit entire page",enterfullscreen:"Fullscreen",exitfullscreen:"Exit fullscreen",downloadpdf:"Download as a PDF",find:"Search...",page:"{currentpage} of {totalpages}"}}});return{}},jQuery,window);u("component.feature",["module.ui"],function(f,e,k,h){e.telligent.evolution.messaging.subscribe("ui-feature",function(f){(f.typeId?e('.ui-feature[data-contentid="'+f.contentId+'"][data-contenttypeid="'+f.contentTypeId+'"][data-typeid="'+f.typeId+'"]'):e('.ui-feature[data-contentid="'+
f.contentId+'"][data-contenttypeid="'+f.contentTypeId+'"]')).attr("data-value",f.result.toString())});e.telligent.evolution.ui.components.feature={setup:function(){},add:function(f,g){f.empty();var c={contentId:g.contentid,contentTypeId:g.contenttypeid,typeId:g.typeid,panelUrl:g.panelurl,initialState:"true"==g.value,contentTypeName:g.contenttypename};g.configuration.editFeatureText&&(c.editFeatureText=g.configuration.editFeatureText);g.configuration.addFeatureText&&(c.addFeatureText=g.configuration.addFeatureText);
g.configuration.processingText&&(c.processingText=g.configuration.processingText);g.configuration.addFeatureCssClass&&(c.addFeatureCssClass=g.configuration.addFeatureCssClass);g.configuration.editFeatureCssClass&&(c.editFeatureCssClass=g.configuration.editFeatureCssClass);g.configuration.processingCssClass&&(c.processingCssClass=g.configuration.processingCssClass);e(f).evolutionFeature(c)}};return{}},jQuery,window);u("component.forumqualityvotes",["module.ui","module.messaging"],function(f,e,k,h,
n){function g(b){var c=k.extend({},a.defaults,b||{}),m=k.telligent.evolution.template.compile(c.votersTemplate),q=k.telligent.evolution.template.compile(c.votersPopupTemplate),t=function(a,b,c){k.telligent.evolution.get({url:k.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/forums/threads/{ThreadId}/votes.json",data:{ThreadId:a.id,VoteType:"Quality",PageSize:a.pageSize,PageIndex:b,SortBy:"Date",SortOrder:"Descending",PageSize:a.pageSize||20,PageIndex:b||0},cache:!1,dataType:"json"}).then(function(a){a.Votes=
a.ForumThreadVotes;k.telligent.evolution.batch(function(){k.each(a.Votes,function(a,b){k.telligent.evolution.get({url:k.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/ui/image.json",data:{url:b.User.AvatarUrl,maxWidth:32,maxHeight:32,resizeMethod:"ZoomAndCrop"}}).done(function(a){b.userAvatarHtml=a.Html})})}).done(function(){c({voters:k.map(a.Votes,function(a){return{displayName:a.User.DisplayName,profileUrl:a.User.ProfileUrl,avatarHtml:a.userAvatarHtml}}),hasMorePages:(a.PageIndex+1)*a.PageSize<
a.TotalCount})})})},l=function(a,b){var l=0,g=k(m(k.extend(a,{noVotesText:d.noVotesText}))),e=k.telligent.evolution.ui.data(k(b).closest(c.delegatedSelector)),f=k(q({voters:g,hasMorePages:a.hasMorePages,showMoreText:c.modalShowMoreText})),z=f.find("ul"),A=f.find(".show-more");z.html(g);A.on("click",function(a){a.preventDefault();l++;t(e,l,function(a){z.append(m(a));a.hasMorePages?A.show():A.hide();z.scrollTop(z[0].scrollHeight)})});k.glowModal({title:c.modalTitleText,html:f,width:450,height:"100%"})};
(function(){k(c.containerSelector).on("click",c.popupSelector,function(a){a.preventDefault();var b=k(this);a=k.telligent.evolution.ui.data(k(b).closest(c.delegatedSelector));t(a,0,function(a){l(a,b)});return!1})})()}function c(a){return k.telligent.evolution.get({url:k.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/forums/threads/{ThreadId}/vote.json",data:{ThreadId:a,VoteType:"Quality"}}).then(function(a){return null==a.ForumThreadVote?null:a.ForumThreadVote.Value})}var d={votersTemplate:' <% if(voters && voters.length > 0) { %> \t<% foreach(voters, function(voter) { %> \t\t<li class="content-item"> \t\t\t<div class="full-post-header"></div> \t\t\t<div class="full-post"> \t\t\t\t<span class="avatar"> \t\t\t\t\t<a href="<%: voter.profileUrl %>"  class="internal-link view-user-profile"> \t\t\t\t\t\t<% if(voter.avatarHtml) { %> \t\t\t\t\t\t\t<%= voter.avatarHtml %> \t\t\t\t\t\t<% } else { %> \t\t\t\t\t\t\t<img src="<%: voter.avatarUrl %>" alt="" border="0" width="32" height="32" style="width:32px;height:32px" /> \t\t\t\t\t\t<% } %> \t\t\t\t\t</a> \t\t\t\t</span> \t\t\t\t<span class="user-name"> \t\t\t\t\t<a href="<%: voter.profileUrl %>" class="internal-link view-user-profile"><%= voter.displayName %></a> \t\t\t\t</span> \t\t\t</div> \t\t\t<div class="full-post-footer"></div> \t\t</li> \t<% }); %> <% } else { %> \t<li> \t\t<span class="content"><%= noVotesText %></span> \t</li> <% } %>',
votersPopupTemplate:' <div class="who-likes-list">      <div class="content-list-header"></div>      <ul class="content-list"><%= voters %></ul>      <div class="content-list-footer"></div>      <% if(hasMorePages) { %>          <a href="#" class="show-more"><%= showMoreText %></a>     <% } %>  </div> ',voteTemplate:' <div class="thread-vote updownvote">  \t  <span class="vote-indicator ui-tip voter-popup" data-tip="<%= tipTextThread %>"><%= tipTextThread %></span>      <a href="#" class="vote up ui-tip <% if(voted == "true") { %>selected<% } %>" data-tip="<%= upvoteText %>" data-messagename="ui.forumqualityvotes.vote.message" data-threadid="<%= id %>" data-value="true"><%= upvoteText %></a>      <span class="score ui-tip voter-popup" data-tip="<%= tipTextThread %>"><%= scoreformatted %></span>      <a href="#" class="vote down ui-tip <% if(voted == "false") { %>selected<% } %>" data-tip="<%= downvoteText %>" data-messagename="ui.forumqualityvotes.vote.message" data-threadid="<%= id %>" data-value="false"><%= downvoteText %></a>  </div> ',
anonymousVoteTemplate:' <div class="thread-vote updownvote">  \t  <span class="vote-indicator ui-tip voter-popup" data-tip="<%= tipTextThread %>"><%= tipTextThread %></span>      <a href="<%= loginurl %>" class="vote up ui-tip" data-tip="<%= logintext %>"><%= logintext %></a>      <span class="score ui-tip voter-popup" data-tip="<%= tipTextThread %>"><%= scoreformatted %></span>      <a href="<%= loginurl %>" class="vote down ui-tip" data-tip="<%= logintext %>"><%= logintext %></a>  </div> ',noVotesText:"No Votes",
modalTitleText:"People who voted on this thread",tipTextThread:"View Voters",modalShowMoreText:"More",containerSelector:".content-fragment",delegatedSelector:".ui-forumqualityvotes",popupSelector:".voter-popup",upVoteText:"Vote Up",downVoteText:"Vote Down",logintext:"Login to vote on this thread",loginurl:""},a={setup:function(){g({})},add:function(b,p){b=k(this);var m=k.extend({},a.defaults,p||{});p.loginurl&&""!=p.loginurl?(anonymousVoteTemplate=k.telligent.evolution.template.compile(m.anonymousVoteTemplate),
b.html(k(anonymousVoteTemplate(k.extend(p,{id:p.id,tipTextThread:d.tipTextThread,score:p.score,scoreformatted:0<p.score?"+"+p.score:p.score,logintext:d.logintext,loginurl:p.loginurl}))))):(voteTemplate=k.telligent.evolution.template.compile(m.voteTemplate),b.html(k(voteTemplate(k.extend(p,{id:p.id,voted:p.voted,tipTextThread:d.tipTextThread,upvoteText:m.upVoteText,score:p.score,scoreformatted:0<p.score?"+"+p.score:p.score,downvoteText:m.downVoteText})))),e.subscribe("ui.forumqualityvotes.vote.message",
function(a){a=k(a.target);k.fn.evolutionTip.hide();a.hasClass("selected")?k.telligent.evolution.del({url:k.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/forums/threads/{ThreadId}/vote.json",data:{ThreadId:a.data("threadid"),VoteType:"Quality"}}):k.telligent.evolution.post({url:k.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/forums/threads/{ThreadId}/vote.json",data:{ThreadId:a.data("threadid"),VoteType:"Quality",Value:a.data("value")}})}));e.subscribe("forumThread.voted",function(a){if(b.data("id")==
a.threadId&&"Quality"==a.voteType){var d=b;if(0<d.length){var l=d.find(".thread-vote .vote.up"),m=d.find(".thread-vote .vote.down"),p=d.find(".thread-vote .score"),g=0<a.count?"+"+a.count:a.count;p.html(g);d.attr("data-score",g).attr("data-scoreformatted",g);c(a.threadId).then(function(a){null==a?(l.removeClass("selected"),m.removeClass("selected"),d.attr("data-value","")):a?(l.addClass("selected"),m.removeClass("selected"),d.attr("data-value",a)):a||(l.removeClass("selected"),m.addClass("selected"),
d.attr("data-value",a))})}}});m=k.map((p.presentservices||"").split(","),function(a){a=a.split("|");var b={};2<=a.length&&(b={ContentId:a[0],ContentTypeId:a[1]},2<a.length&&(b.TypeId=a[2]));return b});k.telligent.evolution.presence.register({node:b.get(0),contents:m})},defaults:d};k.telligent.evolution.ui.components.forumqualityvotes=a;return{}},jQuery,window);u("component.forumvotes",["module.ui","module.messaging"],function(f,e,k,h,n){function g(a){var b=k.extend({},d.defaults,a||{}),p=k.telligent.evolution.template.compile(b.votersTemplate),
m=k.telligent.evolution.template.compile(b.votersPopupTemplate),q=function(a,b,c){("thread"==a.type?k.telligent.evolution.get({url:k.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/forums/threads/{ThreadId}/votes.json",data:{ThreadId:a.id,PageSize:a.pageSize,PageIndex:b,SortBy:"Date",SortOrder:"Descending",PageSize:a.pageSize||20,PageIndex:b||0},cache:!1,dataType:"json"}):k.telligent.evolution.get({url:k.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/forums/threads/replies/{ReplyId}/votes.json",
data:{ReplyId:a.id,PageSize:a.pageSize,PageIndex:b,SortBy:"Date",SortOrder:"Descending",PageSize:a.pageSize||20,PageIndex:b||0},cache:!1,dataType:"json"})).then(function(a){a.Votes=a.ForumThreadVotes||a.ForumReplyVotes;k.telligent.evolution.batch(function(){k.each(a.Votes,function(a,b){k.telligent.evolution.get({url:k.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/ui/image.json",data:{url:b.User.AvatarUrl,maxWidth:32,maxHeight:32,resizeMethod:"ZoomAndCrop"}}).done(function(a){b.userAvatarHtml=
a.Html})})}).done(function(){c({voters:k.map(a.Votes,function(a){return{displayName:a.User.DisplayName,profileUrl:a.User.ProfileUrl,avatarHtml:a.userAvatarHtml}}),hasMorePages:(a.PageIndex+1)*a.PageSize<a.TotalCount})})})},t=function(a,d){var t=0,g=k(p(k.extend(a,{noVotesText:c.noVotesText}))),s=k.telligent.evolution.ui.data(k(d).closest(b.delegatedSelector)),e=k(m({voters:g,hasMorePages:a.hasMorePages,showMoreText:b.modalShowMoreText})),f=e.find("ul"),z=e.find(".show-more");f.html(g);z.on("click",
function(a){a.preventDefault();t++;q(s,t,function(a){f.append(p(a));a.hasMorePages?z.show():z.hide();f.scrollTop(f[0].scrollHeight)})});k.glowModal({title:"thread"==s.type?b.modalTitleTextThread:b.modalTitleTextReply,html:e,width:450,height:"100%"})};(function(){k(b.containerSelector).on("click",b.delegatedSelector,function(a){a.preventDefault();var c=k(this);a=k.telligent.evolution.ui.data(k(c).closest(b.delegatedSelector));q(a,0,function(a){t(a,c)});return!1})})()}var c={votersTemplate:' <% if(voters && voters.length > 0) { %> \t<% foreach(voters, function(voter) { %> \t\t<li class="content-item"> \t\t\t<div class="full-post-header"></div> \t\t\t<div class="full-post"> \t\t\t\t<span class="avatar"> \t\t\t\t\t<a href="<%: voter.profileUrl %>"  class="internal-link view-user-profile"> \t\t\t\t\t\t<% if(voter.avatarHtml) { %> \t\t\t\t\t\t\t<%= voter.avatarHtml %> \t\t\t\t\t\t<% } else { %> \t\t\t\t\t\t\t<img src="<%: voter.avatarUrl %>" alt="" border="0" width="32" height="32" style="width:32px;height:32px" /> \t\t\t\t\t\t<% } %> \t\t\t\t\t</a> \t\t\t\t</span> \t\t\t\t<span class="user-name"> \t\t\t\t\t<a href="<%: voter.profileUrl %>" class="internal-link view-user-profile"><%= voter.displayName %></a> \t\t\t\t</span> \t\t\t</div> \t\t\t<div class="full-post-footer"></div> \t\t</li> \t<% }); %> <% } else { %> \t<li> \t\t<span class="content"><%= noVotesText %></span> \t</li> <% } %>',
votersPopupTemplate:' <div class="who-likes-list">      <div class="content-list-header"></div>      <ul class="content-list"><%= voters %></ul>      <div class="content-list-footer"></div>      <% if(hasMorePages) { %>          <a href="#" class="show-more"><%= showMoreText %></a>     <% } %>  </div> ',noVotesText:"No Votes",modalTitleTextThread:"People who had this question",modalTitleTextReply:"People helped by this answer",modalShowMoreText:"More",containerSelector:".content-fragment",delegatedSelector:".ui-forumvotes"},
d={setup:function(){g({})},add:function(a,b){a.attr("data-tip","thread"==b.type?d.defaults.modalTitleTextThread:d.defaults.modalTitleTextReply).addClass("ui-tip");e.subscribe("ui-forumvote",function(c){if(c.id==b.id&&c.type==b.type){var d=0<c.count?"+"+c.count:c.count;k(a).html(d).attr("data-count",d);c.voted?k(a).attr("data-voted","true"):k(a).attr("data-voted","false")}});e.subscribe("forumThread.voted",function(b){b.threadId==k(a).data("id")&&"Interest"==b.voteType&&(b=0<b.count?"+"+b.count:b.count,
k(a).html(b).attr("data-count",b))});var c=k.map((b.presentservices||"").split(","),function(a){a=a.split("|");var b={};2<=a.length&&(b={ContentId:a[0],ContentTypeId:a[1]},2<a.length&&(b.TypeId=a[2]));return b});k.telligent.evolution.presence.register({node:a.get(0),contents:c})},defaults:c};k.telligent.evolution.ui.components.forumvotes=d;return{}},jQuery,window);u("component.like",["module.ui","module.messaging"],function(f,e,k,h,n){var g=function(c,d,a,b){k.telligent.evolution.get({url:k.telligent.evolution.site.getBaseUrl()+
"api.ashx/v2/likes.json",data:{ContentId:c,ContentTypeId:d,TypeId:a,SortBy:"Date",SortOrder:"Descending",PageSize:1,PageIndex:0},cache:!1,dataType:"json",success:function(a){b.call(this,{count:a.TotalCount,latestLike:0<a.Likes.length?a.Likes[0]:null})}})};k.telligent.evolution.messaging.subscribe("ui.like",function(c){(c.typeId?k('.ui-like[data-contentid="'+c.contentId+'"][data-contenttypeid="'+c.contentTypeId+'"][data-configuration*="LikeTypeId='+c.typeId+'"]'):k('.ui-like[data-contentid="'+c.contentId+
'"][data-contenttypeid="'+c.contentTypeId+'"]')).attr("data-initialstate",c.liked.toString()).attr("data-initialcount",c.count.toString()).attr("data-initialmessage",c.message.toString())});k.telligent.evolution.ui.components.like={setup:function(){k.fn.evolutionLike.delegatePopups({containerSelector:".content-fragment",delegatedSelector:".ui-like",onList:function(c,d,a,b,p,m){k.telligent.evolution.get({url:k.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/likes.json",data:{ContentId:c,ContentTypeId:d,
TypeId:a,SortBy:"Date",SortOrder:"Descending",PageSize:p||20,PageIndex:m||0},cache:!1,dataType:"json",success:function(a){k.telligent.evolution.batch(function(){k.each(a.Likes,function(a,b){k.telligent.evolution.get({url:k.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/ui/image.json",data:{url:b.User.AvatarUrl,maxWidth:32,maxHeight:32,resizeMethod:"ZoomAndCrop"}}).done(function(a){b.userAvatarHtml=a.Html})})}).done(function(){b({likers:k.map(a.Likes,function(a){return{displayName:a.User.DisplayName,
profileUrl:a.User.ProfileUrl,avatarHtml:a.userAvatarHtml}}),hasMorePages:(a.PageIndex+1)*a.PageSize<a.TotalCount})})}})},onOptions:function(c){c=k.telligent.evolution.ui.data(c);return{contentId:c.contentid,contentTypeId:c.contenttypeid,typeId:c.configuration.LikeTypeId}}})},add:function(c,d){var a="true"===d.readonly;k(c).evolutionLike({contentId:d.contentid,contentTypeId:d.contenttypeid,initialState:d.initialstate,initialMessage:d.initialmessage,initialCount:d.initialcount,format:a?d.format.replace("{toggle}",
""):d.format,typeId:d.configuration.LikeTypeId,onLike:function(a,c,d,q){k.fn.evolutionTip.hide();var t={ContentId:a,ContentTypeId:c};null!==d&&0<d.length&&(t.TypeId=d);k.telligent.evolution.post({url:k.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/likes.json",data:t,cache:!1,dataType:"json",success:function(l){g(a,c,d,q)}})},onUnlike:function(a,c,d,q){k.fn.evolutionTip.hide();var t={ContentId:a};null!==d&&0<d.length&&(t.TypeId=d);k.telligent.evolution.del({url:k.telligent.evolution.site.getBaseUrl()+
"api.ashx/v2/like.json",data:t,cache:!1,dataType:"json",success:function(l){g(a,c,d,q)}})}})}};return{}},jQuery,window);u("component.links",["module.ui","lib.dynamicLinks","lib.sheetProvider","lib.util"],function(f,e,k,h,n,g,c){function d(c,d,l){!0===c.data("linkshown")?(c.data("linkshown",!1),n.fn.uilinks.hide()):(n.telligent.evolution.messaging.publish("ui.links.show"),n(window).width()<r.minWidth?b(d,l):a(c,d))}function a(a,b){a.css({position:"relative "});for(var c=n(document.createElement("ul")),
d=0;d<b.length;d++){var l=n(document.createElement("li"));l.append(n(b[d].element).css("float","none").get(0));c.append(l)}w||(w=n("<div></div>").glowPopUpPanel({cssClass:"links-popup-panel",zIndex:1500,hideOnDocumentClick:!0,position:"updown"}));w.glowPopUpPanel("hide",!0).glowPopUpPanel("html",c).one("glowPopUpPanelShown",function(){a.data("linkshown",!0);var b=!1;c.on("mouseenter",function(){b=!0});c.on("mouseleave",function(){b&&(n.fn.uilinks.hide(),a.data("linkshown",!1))})}).one("glowPopUpPanelHidden",
function(){a.data("linkshown",!1)}).off(".uilinks").on("glowPopUpPanelShowing.uilinks",function(b,c){a.addClass("links-expanded").attr("data-position",c.position)}).on("glowPopUpPanelHiding.uilinks",function(b,c){a.removeClass("links-expanded").attr("data-position","")}).glowPopUpPanel("show",a)}function b(a,b){var c=a.slice(0);c.push(b);k.actionSheet.show({links:n.map(c,function(a){return a.element})});k.actionSheet.content().on("click","a",function(a){k.actionSheet.hide()});b.element.on("click",
function(a){a.preventDefault();k.actionSheet.hide();n.telligent.evolution.messaging.publish("ui.links.hide");return!1});var d=n.telligent.evolution.messaging.subscribe("sheet.closed",function(){n.each(a,function(a,b){p(n(b.element))});n.telligent.evolution.messaging.unsubscribe(d)})}function p(a){a.is('[class^="ui-"]')&&!a.hasClass("ui-tourtip")?a.empty().remove():a.detach()}function m(a,b,c){clearTimeout(a.reflowWaitTimeout);n(g).width()<b.width()?(a.reflowWaitCheckCount++,10>a.reflowWaitCheckCount&&
(a.reflowWaitTimeout=setTimeout(function(){m(a,b,c)},250))):c.render()}function q(a,b){var c=a.find("> li, > ul > li"),m=b.maxlinks,g=b.minlinks,q=null;a.removeClass("ui-links");var f={parent:a,links:[],onShowMore:function(a,b){d(q,a,b)}};m&&(f.maxLinks=parseInt(m,10));g&&(f.minLinks=parseInt(g,10));f.direction=b.direction;for(m=0;m<c.length;m++){var g=n(c[m]),w=g.children();p(w);var k=w.is("[data-selected]");w.is("[data-more]")?(q=w,f.moreLink={element:w,selected:k,className:g.get(0).className}):
w.is("[data-cancel]")?f.cancelLink={element:w,selected:k,className:g.get(0).className}:f.links.push({element:w,selected:k,className:g.get(0).className})}a.empty();var B=new e(f);a.show();b.reflowWaitCheckCount=0;b.reflowWaitTimeout=null;var G=h.scrollParent(a);h.isPartiallyVisible(G,a)?t(a,b,B):(r.delayedInits.push({container:G,attempt:function(){return h.isInDom(a)?!b.finalized&&h.isPartiallyVisible(G,a)?(t(a,b,B),!1):!0:!1}}),l(G))}function t(a,b,c){b.finalized=!0;m(b,a,c);a.data("_dynamic_links",
c);var d=function(b,l){h.isInDom(a)?l.oldWidth!=l.newWidth&&c.render():n(window).off("resized",d)};b=a.closest(".layout-region");if(0<b.length)b.on("resized",d);else n(window).on("resized",d);var l=n.telligent.evolution.messaging.subscribe("mobile.orientationchange",function(){h.isInDom(a)?g.setTimeout(function(){c.render()},300):n.telligent.evolution.messaging.unsubscribe(l)})}function l(a){a.data("_delayed_uilinks_monitored")||(a.data("_delayed_uilinks_monitored",!0),a.on("scroll._delayed_uilinks",
h.throttle(n.fn.uilinks.forceRender,100)),a.on("resized._delayed_uilinks",h.throttle(n.fn.uilinks.forceRender,100)),r.delayedInitContainers.push(a))}var w;n.fn.uilinks=function(){var a=this.data("_dynamic_links"),b=Array.prototype.slice.call(arguments,0),c=b[0];if(!a)return this;if("add"==c)return c=b[1],b=n.extend({},{className:null,selected:!1},b[2]||{}),a.addLink({element:c,className:b.className,selected:b.selected}).element;if("insert"==c){var c=b[1],l=b[2],b=n.extend({},{className:null,selected:!1},
b[3]||{});return a.addLink({element:c,className:b.className,selected:b.selected},l).element}if("remove"==c)a.removeLink(b[1]);else if("show"==c)b=b[1]||a.moreLink().element,d(b,a.links(!0),a.cancelLink());else if("hide"==c)n.fn.uilinks.hide();else if("resize"==c)a.resize();else{if("isVisible"==c)return c=b[1],a.isVisible(c);if("update"==c)return c=b[1],b=n.extend({},{index:null,className:null,selected:null},b[2]||{}),a.update(c,b);if("links"==c)return n.map(a.links(),function(a){return a.element});
if("list"==c)return b=b[1]||{},a.links(b&&!0===b.hidden);"reconfigure"==c&&(c=b[1]||{},l=f.data(this),b={},l.minlinks&&(b.minLinks=l.minlinks),l.maxlinks&&(b.maxLinks=l.maxlinks),l.direction&&(b.direction=l.direction),n.extend(b,c),a.reconfigure(b))}return this};n.fn.uilinks.hide=function(){n.telligent.evolution.messaging.publish("ui.links.hide");k.actionSheet.hide();w&&w.glowPopUpPanel("hide")};n.fn.uilinks.forceRender=function(){for(var a=[],b=0;b<r.delayedInits.length;b++)r.delayedInits[b].attempt()||
a.push(b);a.reverse();for(b=0;b<a.length;b++)r.delayedInits.splice(a[b],1);if(0===r.delayedInits.length)for(a=0;a<r.delayedInitContainers.length;a++)r.delayedInitContainers[a].off("._delayed_uilinks").data("_delayed_uilinks_monitored",!1)};var r={setup:function(){r.delayedInits=[];r.delayedInitContainers=[]},add:function(a,b){a=n(a);q(a,b)},minWidth:570};n.telligent=n.telligent||{};n.telligent.evolution=n.telligent.evolution||{};n.telligent.evolution.ui=n.telligent.evolution.ui||{};n.telligent.evolution.ui.components=
n.telligent.evolution.ui.components||{};return n.telligent.evolution.ui.components.links=r},jQuery,window);u("component.loading",["module.ui"],function(f,e,k,h){e.telligent.evolution.ui.components.loading={setup:function(){},add:function(f,g){function c(){var d=f.css("color");if(d){var a=parseInt(g.width,10);isNaN(a)&&(a=48);var b=parseInt(g.height,10);isNaN(b)&&(b=48);var p=Math.min(a/3,b);f.css({display:"block",width:a+"px",height:b+"px",margin:"0 auto",padding:(b-p)/2+"px 0","text-align":"center",
"box-sizing":"border-box"}).html(e(['<div class="spinner"><div class="bounce1" style="width:',p,"px;height:",p,"px;background-color:",d,';"></div><div class="bounce2" style="width:',p,"px;height:",p,"px;background-color:",d,';"></div><div class="bounce3" style="width:',p,"px;height:",p,"px;background-color:",d,';"></div></div>'].join("")))}else k.setTimeout(function(){c()},50)}c()}};return{}},jQuery,window);u("component.masonry",["module.ui","plugin.evolutionMasonry"],function(f,e,k,h,n){f={setup:function(){},
add:function(g,c){k(g).data("_evolutionMasonry")||(k(g).data("_evolutionMasonry",!0),k(g).evolutionMasonry({columnClass:c.columnclass||k.fn.evolutionMasonry.defaults.columnClass}).css({visibility:"visible"}))}};k.telligent=k.telligent||{};k.telligent.evolution=k.telligent.evolution||{};k.telligent.evolution.ui=k.telligent.evolution.ui||{};k.telligent.evolution.ui.components=k.telligent.evolution.ui.components||{};return k.telligent.evolution.ui.components.masonry=f},jQuery,window);u("component.moderate",
["module.ui"],function(f,e,k,h){var n=function(g,c,d){e.telligent.evolution.post({url:e.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/abusereports.json",data:{ContentId:g,ContentTypeId:c},cache:!1,dataType:"json",success:function(a){d(a)}})};e.telligent.evolution.ui.components.moderate={setup:function(){},add:function(g,c){g=e(g);var d={contentId:c.contentid,contentTypeId:c.contenttypeid,supportsAbuse:"true"===c.supportsabuse,initialState:"true"===c.initialstate,onReport:n};if(c.configuration&&
c.configuration.AdditionalLinks){var a=e.parseJSON(c.configuration.AdditionalLinks);if(!d.supportsAbuse&&0===a.length)return;d.onGetAdditionalLinks=function(b){b(a)}}else if(c.configuration&&c.configuration.AdditionalLinksUrl){if(!d.supportsAbuse&&0===c.configuration.AdditionalLinksUrl.length)return;d.onGetAdditionalLinks=function(a){e.telligent.evolution.get({url:c.configuration.AdditionalLinksUrl,cache:!1,dataType:"json",success:function(c){a(c.links||[])}})}}if(d.supportsAbuse||d.onGetAdditionalLinks)c.configuration&&
c.configuration.LinkClassName&&(d.linkClassName=c.configuration.LinkClassName),g.evolutionModerate(d)}};return{}},jQuery,window);u("component.page",["module.ui"],function(f,e,k,h){var n={};e.telligent.evolution.ui.components.page={setup:function(){},add:function(g,c){var d={currentPage:parseInt(c.currentpage,10),pageSize:parseInt(c.pagesize,10),totalItems:parseInt(c.totalitems,10),showPrevious:"undefined"===typeof c.configuration.ShowPrevious?!1:"true"===c.configuration.ShowPrevious,showNext:"undefined"===
typeof c.configuration.ShowNext?!1:"true"===c.configuration.ShowNext,showFirst:"undefined"===typeof c.configuration.ShowFirst?!0:"true"===c.configuration.ShowFirst,showLast:"undefined"===typeof c.configuration.ShowLast?!0:"true"===c.configuration.ShowLast,showIndividualPages:"undefined"===typeof c.configuration.ShowIndividualPages?!0:"true"===c.configuration.ShowIndividualPages,numberOfPagesToDisplay:"undefined"===typeof c.configuration.NumberOfPagesToDisplay?5:parseInt(c.configuration.NumberOfPagesToDisplay,
10),pageKey:c.pagekey,hash:c.configuration.Target,baseUrl:c.configuration.BaseUrl||window.location.href,template:"undefined"!==typeof c.configuration.Template?c.configuration.Template:' <% foreach(links, function(link, i) { %>      <% if(link.type === "first") { %>          <a href="<%: link.url %>" class="first" data-type="first" data-page="<%= link.page %>" data-selected="false"><span>&#171;</span></a>      <% } else if(link.type === "previous") { %>          <a href="<%: link.url %>" class="previous" data-type="previous" data-page="<%= link.page %>" data-selected="false"><span>&#60;</span></a>      <% } else if(link.type === "page") { %>          <a href="<%: link.url %>" class="page<%= link.selected ? " selected" : "" %>" data-type="page" data-page="<%= link.page %>" data-selected="<%= link.selected ? "true" : "false" %>"><span><%= link.page %></span></a>      <% } else if(link.type === "next") { %>          <a href="<%: link.url %>" class="next" data-type="next" data-page="<%= link.page %>" data-selected="false"><span>&#62;</span></a>      <% } else if(link.type === "last") { %>          <a href="<%: link.url %>" class="last" data-type="last" data-page="<%= link.page %>" data-selected="false"><span>&#187;</span></a>      <% } %>      <% if(i < (links.length - 1)) { %>          <span class="separator"></span>      <% } %>  <% }); %> '};
c.pagedcontenturl&&(n[c.pagedcontentpagingevent]={onPage:function(a,b,d){d=d||{};d[c.pagekey]=a;a=e.telligent.evolution.url.modify({url:c.pagedcontenturl,query:d});e.telligent.evolution.get({url:a,cache:!1,success:function(a){b(a)}})}},e.extend(d,{onPage:function(a,b,d){n[c.pagedcontentpagingevent].onPage(a,b,d)},refreshOnAnyHashChange:"true"===c.loadonanyhashchange,pagedContentContainer:"#"+c.pagedcontentwrapperid,pagedContentPagingEvent:c.pagedcontentpagingevent,pagedContentPagedEvent:c.pagedcontentpagedevent,
transition:c.configuration.Transition,transitionDuration:"undefined"===typeof c.configuration.TransitionDuration?200:parseInt(c.configuration.TransitionDuration,10)}));e(g).evolutionPager(d);if("true"===c.loadingindicator){var a=e("#"+c.pagedcontentwrapperid),b=e("<div></div>").css({backgroundColor:"#fff",position:"absolute",opacity:0.75,zIndex:1});e.telligent.evolution.messaging.subscribe(c.pagedcontentpagingevent,function(){var c=a.offset();b.hide().appendTo("body").css({width:a.width(),height:a.height(),
top:c.top,left:c.left}).show()});e.telligent.evolution.messaging.subscribe(c.pagedcontentpagedevent,function(){b.hide()})}}};return{}},jQuery,window);u("component.poll",["module.ui"],function(f,e,k,h){e.telligent.evolution.messaging.subscribe("socket.connected",function(){e.telligent.evolution.sockets.polls.on("updated",function(a){e.telligent.evolution.messaging.publish("polls.updated",a)})});var n="Vote",g="Voting Ends: {0}",c="View Results",d="Voting Ended: {0}",a="Your vote was received, check back when the poll expires to view the result.",
b="Total Votes : {0}",p="You voted for '{0}'.",m="User Vote Report",q="Vote",t="You have already voted for '{0}'.",l="Please login to vote",w=function(a,b,c){var d=a.data("pollview");"vote"!=d&&("results"!=d?(d=v(a,b,c),a.data("pollview","vote"),a.html(d)):c.canShowResults&&e.telligent.evolution.get({url:e.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/poll/"+b.Id+"/summary.json",cache:!1,success:function(d){d=r(a,b,d.VoteSummary,c);a.data("pollview","results");a.html(d)}}))},r=function(a,c,l,
t){a=e("<div></div>").addClass("poll results");var r=0,s=e("<div></div>").addClass("poll-header"),f=e('<div class="poll-content"></div>'),w=e('<ul class="poll-answers-container"><ul>');s.append(e("<h4></h4>").addClass("poll-question").html(c.Question));a.append(s);c.Description&&f.append(e("<div></div>").addClass("poll-description").html(c.Description));e.each(l.Summary,function(a,b){r+=l.Summary[a].VoteCount});e.each(l.Summary,function(a,b){var c=l.Summary[a],d=0==r?0:Math.round(c.VoteCount*(100/
r));w.append(e('<li><div class="poll-answer">'+c.PollOption.Option+' <span class="poll-result-value">'+d+'%</span></div><div class="poll-graph-container"><div class="poll-graph" style="width:'+d+'%;"></div></div></li>').attr("data-polloptionid",c.PollOption.OptionId))});f.append(w);a.append(f);s=e('<div class="poll-footer"></div>');f=e('<ul class="poll-footer-attributes"></ul>');if(null!=t.expiredDate){var v=new Date>t.expiredDate?d:g,n=e("<li></li>").addClass("poll-expires");f.append(n);e.telligent.evolution.language.formatDateAndTime(new Date(t.expiredDate),
function(a){n.html(v.replace("{0}",a))})}var h=e("<li></li>");f.append(h);e.telligent.evolution.get({url:e.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/poll/"+c.Id+"/vote.json",cache:!1,success:function(a){if(null==a.Errors){if(a.OptionId){var b=null;e.each(c.Options,function(c,d){d.OptionId==a.OptionId&&(b=d.Option)});b?(w.find('li[data-polloptionid="'+a.OptionId+'"]').addClass("selected"),h.addClass("poll-voted").html(p.replace("{0}",b))):h.remove()}}else h.remove()}});f.append(e("<li></li>").addClass("poll-votecount").html(b.replace("{0}",
r)));t.canVote&&f.append(e("<li></li>").html('<a href="javascript:void(0)" class="poll-view-vote">'+q+"</a>"));t.reporturl&&(t=e("<li></li>").addClass("poll-report").html(e("<a></a>").attr("href",t.reporturl).html(m)),f.append(t));s.append(f);a.append(s);return a},v=function(a,d,p){a=e("<div></div>").addClass("poll voting").css("visibility","none");var q=e.telligent.evolution.user.accessing.isSystemAccount,r=e("<div></div>").addClass("poll-header"),f=e('<div class="poll-content"></div>'),s=e('<ul class="poll-answers-container"></ul>');
r.append(e("<h4></h4>").addClass("poll-question").html(d.Question));a.append(r);d.Description&&f.append(e("<div></div>").addClass("poll-description").html(d.Description));e.each(d.Options,function(a,b){var c=e("<li></li>"),l=e("<span></span>").addClass("poll-input").html(e('<input type="radio" />').val(b.OptionId).attr("name",d.Id).addClass("options-"+d.Id).attr("id",d.Id+"-"+b.OptionId)),m=e('<label for="'+d.Id+"-"+b.OptionId+'"></label>').addClass("poll-answer").html(b.Option);p.readOnly||c.append(l);
c.append(m);s.append(c)});f.append(s);p.canVote&&f.append(e('<a href="#"></a>').addClass("button poll-vote").html(n));a.append(f);var r=e('<div class="poll-footer"></div>'),w=e('<ul class="poll-footer-attributes"></ul>');if(null!=d.ExpiredDate){var v=e("<li></li>").addClass("poll-expires");w.append(v);e.telligent.evolution.language.formatDateAndTime(new Date(d.ExpiredDate),function(a){v.html(g.replace("{0}",a))})}e.telligent.evolution.get({url:e.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/poll/"+
d.Id+"/vote.json",cache:!1,success:function(a){if(a.OptionId){var g=null;e.each(d.Options,function(b,c){c.OptionId==a.OptionId&&(g=c.Option)});w.append(e("<li></li>").addClass("poll-alreadyvoted").html(t.replace("{0}",g)))}null==a.Errors?e("#"+d.Id+"-"+a.OptionId).attr("checked","checked"):alert(a.Errors);if(p.canShowResults){var r=e("<li></li>").addClass("poll-votecount");w.append(r);w.append(e("<li></li>").html('<a href="javascript:void(0)" class="poll-view-results">'+c+"</a>"));e.telligent.evolution.get({url:e.telligent.evolution.site.getBaseUrl()+
"api.ashx/v2/poll/"+d.Id+"/summary.json",cache:!1,success:function(a){if(null==a.Errors){var c=0;e.each(a.VoteSummary.VoteCount,function(b,d){c+=a.VoteSummary.VoteCount[b]});r.html(b.replace("{0}",c))}else alert(a.Errors)}})}if(q){var f=e("<li></li>").html(e("<a></a>").attr("href",p.loginurl).html(l));w.append(f)}p.reporturl&&(f=e("<li></li>").html(e("<a></a>").attr("href",p.reporturl).html(m)),w.append(f))}});r.append(w);a.append(r);return a},s=function(b,c,d){b.on("click",".poll-view-results",function(){e.telligent.evolution.get({url:e.telligent.evolution.site.getBaseUrl()+
"api.ashx/v2/poll/"+c.Id+"/summary.json",success:function(a){null==a.Errors?b.evolutionTransform({opacity:0},{duration:200,complete:function(){var l=r(b,c,a.VoteSummary,d);b.data("pollview","results");b.html(l);b.evolutionTransform({opacity:1},{duration:200})}}):alert(a.Errors)}});return!1});b.on("click",".poll-view-vote",function(){b.evolutionTransform({opacity:0},{duration:200,complete:function(){var a=v(b,c,d);b.data("pollview","vote");b.html(a);b.evolutionTransform({opacity:1},{duration:200})}});
return!1});b.on("click",".button.poll-vote",function(){var l=e(".options-"+c.Id+":checked").val();e.telligent.evolution.post({url:e.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/poll/"+c.Id+"/vote.json",data:{OptionId:l},success:function(l){e.telligent.evolution.get({url:e.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/poll/"+c.Id+"/summary.json",cache:!1,success:function(a){null==a.Errors?b.evolutionTransform({opacity:0},{duration:200,complete:function(){if(d.showResultsBeforeExpiration||
d.expiredDate>new Date)d.canShowResults=!0;if(d.canShowResults){var l=r(b,c,a.VoteSummary,d);b.data("pollview","results");b.html(l);b.evolutionTransform({opacity:1},{duration:200})}}}):alert(a.Errors)},error:function(b){e.telligent.evolution.notifications.show(a,{type:"success",duration:5E3})}})}});return!1})},y=function(a,b){return e.Deferred(function(c){a.readOnly?(a.canVote=!1,a.canShowResults=a.showResultsBeforeExpiration||a.expiredDate<new Date,c.resolve(!1)):!a.showResultsBeforeExpiration&&
a.expiredDate>new Date?(a.canVote=!0,a.canShowResults=!1,c.resolve(!0)):(a.canVote=null==a.expiredDate||a.expiredDate>new Date,e.telligent.evolution.get({url:e.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/poll/"+b+"/vote.json",cache:!1,success:function(b){null==b.Errors?b.OptionId?(a.canShowResults=!0,c.resolve(!1)):(a.canShowResults=a.showResultsBeforeVote,c.resolve(!0)):(a.canShowResults=a.showResultsBeforeVote,c.resolve(!1))},error:function(){a.canShowResults=a.showResultsBeforeVote;c.resolve(!1)}}))}).promise()},
x=function(r){r&&(r=e.telligent.evolution.url.parseQuery(r),null!=r.voteButton&&(n=r.voteButton),null!=r.expiredText&&(g=r.expiredText),null!=r.viewResults&&(c=r.viewResults),null!=r.alreadyExpiredText&&(d=r.alreadyExpiredText),null!=r.voteMessage&&(a=r.voteMessage),null!=r.voteCountText&&(b=r.voteCountText),null!=r.votedOnText&&(p=r.votedOnText),null!=r.alreadyVotedOnText&&(t=r.alreadyVotedOnText),null!=r.userVoteReport&&(m=r.userVoteReport),null!=r.anonymousUserLoginText&&(l=r.anonymousUserLoginText),
null!=r.viewVote&&(q=r.viewVote))};e.telligent.evolution.ui.components.poll={setup:function(){},add:function(a,b){x(b.resources);var c=b.pollid,d=null;if(c){var l={reporturl:b.reporturl,loginurl:b.loginurl,readOnly:"True"===b.readonly};e.telligent.evolution.get({url:e.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/poll/"+c+".json",success:function(b){b.Poll&&(l.showResultsBeforeExpiration=b.Poll.ShowResultsBeforeExpiration,l.showResultsBeforeVote=b.Poll.ShowResultsBeforeVote,l.expiredDate=null==
b.Poll.ExpiredDate?null:e.telligent.evolution.parseDate(b.Poll.ExpiredDate),y(l,c).then(function(m){null==b.Errors?(!m&&l.canShowResults&&a.data("pollview","results"),w(a,b.Poll,l),s(a,b.Poll,l),e.telligent.evolution.messaging.subscribe("polls.updated",function(m){c==m.pollId&&(k.clearTimeout(d),d=k.setTimeout(function(){w(a,b.Poll,l)},1E3))})):alert(b.Errors)}))}})}}};return{}},jQuery,window);u("component.presentcontent",["module.ui"],function(f,e,k,h){e.telligent.evolution.ui.components.presentcontent=
{setup:function(){},add:function(f,g){var c=e.map((g.presentcontents||"").split(","),function(c){c=c.split("|");var a={};2<=c.length&&(a={ContentId:c[0],ContentTypeId:c[1]},2<c.length&&(a.TypeId=c[2]));return a});e.telligent.evolution.presence.register({node:f.get(0),contents:c})}};return{}},jQuery,window);u("component.presentservice",["module.ui"],function(f,e,k,h){e.telligent.evolution.ui.components.presentservice={setup:function(){},add:function(f,g){var c=e.map((g.presentservices||"").split(","),
function(c){c=c.split("|");var a={};2<=c.length&&(a={ContentId:c[0],ContentTypeId:c[1]},2<c.length&&(a.TypeId=c[2]));return a});e.telligent.evolution.presence.register({node:f.get(0),contents:c})}};return{}},jQuery,window);u("component.previewhtml",["module.ui"],function(f,e,k,h){function n(c,d,a,b){c={url:c,width:0,height:0,outputIsPersisted:!1};d&&(c.width=d);a&&(c.height=a);b&&(c.outputIsPersisted=b);return e.telligent.evolution.get({url:jQuery.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/ui/preview.json",
data:c})}function g(c,d){var a=c.parent().width();a>d.width&&(a=d.width);n(d.url,a,d.height,d.persist).done(function(a){c.html(a.Html)})}e.telligent.evolution.ui.components.previewhtml={setup:function(){},add:function(c,d){g(c,d);e(window).on("resized",function(){g(c,d)})}};return{}},jQuery,window);u("component.rate",["module.ui"],function(f,e,k,h){e.telligent.evolution.ui.components.rate={setup:function(){},add:function(f,g){var c=e.extend({},{isReadOnly:"true"===g.readonly,value:parseFloat(g.initialvalue),
ratingCount:parseFloat(g.initialcount)});c.value*=e.fn.evolutionStarRating.defaults.maxRating;c.onRate=function(c){g.contentid&&g.contenttypeid&&(c/=e.fn.evolutionStarRating.defaults.maxRating,c={ContentId:g.contentid,ContentTypeId:g.contenttypeid,Value:c},g.ratingtypeid&&(c.TypeId=g.ratingtypeid),e.telligent.evolution.post({url:e.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/ratings.json",data:c,success:function(a){a={ContentId:g.contentid};g.ratingtypeid&&(a.TypeId=g.ratingtypeid);e.telligent.evolution.get({url:e.telligent.evolution.site.getBaseUrl()+
"api.ashx/v2/rateditem.json",data:a,success:function(a){a&&a.RatedItem&&a.RatedItem.AverageValue?e(f).evolutionStarRating("option",{value:a.RatedItem.AverageValue*e.fn.evolutionStarRating.defaults.maxRating,ratingCount:a.RatedItem.Count}):e(f).evolutionStarRating("option",{value:0,ratingCount:0})}})}}))};0==c.ratingCount&&c.isReadOnly||e(f).evolutionStarRating(c)}};return{}},jQuery,window);u("component.resizedimage",["module.ui"],function(f,e,k,h){e.telligent.evolution.ui.components.resizedimage=
{setup:function(){},add:function(f,g){f.removeClass("ui-resizedimage");e.telligent.evolution.media.previewHtml(g.src,{width:g.width||0,height:g.height||0,resizeMethod:g.resizemethod||"ZoomAndCrop",success:function(c){c=e(c.html);c.attr("style")&&f.attr("style",c.attr("style"));f.attr("src",c.attr("src"))}})}};return{}},jQuery,window);u("component.searchresult",["module.ui","module.template"],function(f,e,k,h,n){var g=k.telligent.evolution.template.compile('<% foreach(properties, function(property) { %> <li class="property-item"><%= property %></li> <% }); %> '),
c=function(c,a){k.telligent.evolution.get({url:c,dataType:"json",success:function(b){b&&a(g(b))}})};k.telligent.evolution.ui.components.searchresult={setup:function(){},add:function(d,a){if(a.detailsurl){var b=null,p=d.find("ul.details"),m=p.html();d.bind("mouseenter",function(d){null!==b?p.html(b):c(a.detailsurl,function(a){b=a;p.html(b)})}).bind("mouseleave",function(a){p.html(m)})}}};return{}},jQuery,window);u("component.select",["module.ui","module.messaging"],function(f,e,k,h,n){function g(c){if(c.is("select")&&
k(window).width()>(k.telligent.evolution.theme.getReflowBreakpoint()||670))if(c.data("renderedUiSelect"))c.hide(),c.data("renderedUiSelect").show();else{var d="uiselect "+c.get(0).className.replace("ui-select-enabled","");0<c.closest(".view,.filter,.sort").length&&(d+=" options-slim");c.show().glowDropDownList({selectedItemWidth:"auto",selectedItemHeight:"auto",itemsWidth:"auto",itemsHeight:"auto",buttonImageUrl:null,className:d,activeClassName:"active"});d=c.prevUntil("uiselect").prev();c.data("renderedUiSelect",
d)}else c.show(),(c=c.data("renderedUiSelect"))&&c.hide()}k.telligent.evolution.ui.components.select={setup:function(){e.subscribe("reflow.reflowend",function(){k(".ui-select-enabled").each(function(){g(k(this))})})},add:function(c,d){c.removeClass("ui-select").addClass("ui-select-enabled");g(c)}};return{}},jQuery,window);u("component.squeezetext",["module.ui","plugin.evolutionSqueezeText"],function(f,e,k,h,n){f={setup:function(){},add:function(g,c){k(g).evolutionSqueezeText({minSize:parseFloat(c.minsize)||
k.fn.evolutionSqueezeText.defaults.minSize,minSpacing:parseFloat(c.minspacing)||k.fn.evolutionSqueezeText.defaults.minSpacing,enableSpacing:c.enablespacing!==n?"true"===c.enablespacing:k.fn.evolutionSqueezeText.defaults.enableSpacing,resetOnFailure:c.resetonfailure!==n?"true"===c.resetonfailure:k.fn.evolutionSqueezeText.defaults.resetOnFailure,truncateOnFailure:c.truncateonfailure!==n?"true"===c.truncateonfailure:k.fn.evolutionSqueezeText.defaults.truncateOnFailure,onFailure:function(){k(this).attr("data-tip",
k(this).text()).evolutionTip()}})}};k.telligent=k.telligent||{};k.telligent.evolution=k.telligent.evolution||{};k.telligent.evolution.ui=k.telligent.evolution.ui||{};k.telligent.evolution.ui.components=k.telligent.evolution.ui.components||{};return k.telligent.evolution.ui.components.squeezetext=f},jQuery,window);u("component.tag",["module.ui"],function(f,e,k,h){var n=function(g,c,d){var a=e(d);a.html("");if(g){var b=!0;e.each(g.split(/,/),function(d,m){var g=e.trim(m);g&&(b?b=!1:a.append(", "),c?
a.append(e("<a>").attr("rel","nofollow tag").attr("href",c.replace(/{tag}/g,e.telligent.evolution.url.encodePathComponent(e.telligent.evolution.html.decode(g)))).text(g)):a.append(g))})}};e.telligent.evolution.ui.components.tag={setup:function(){},add:function(g,c){var d=jQuery("<span></span>");e(g).append(d);n(c.tags,c.urlformat,d);var a=null;"true"!==c.readonly&&(a=e('<a href="javascript:void(0);" class="internal-link edit-tags"></a>'),e(g).append(a),a.evolutionInlineTagEditor({allTags:e.grep(c.selectabletags.split(","),
function(a){return a}),currentTags:e.grep(c.tags.split(","),function(a){return a}),onSave:function(a,p){var m={Tags:a&&0<a.length?a.join(","):"",ContentId:c.contentid,ContentTypeId:c.contenttypeid};c.tagtypeid&&(m.TypeId=c.tagtypeid);e.telligent.evolution.put({url:e.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/contenttags.json",data:m,success:function(a){n(m.Tags,c.urlformat,d);p()}})}}))}};return{}},jQuery,window);u("component.theater",["module.ui"],function(f,e,k,h){var n=function(g,c){e.telligent.evolution.get({url:g,
cache:!1,success:function(d){c(d)}})};e.telligent.evolution.ui.components.theater={setup:function(){},add:function(g,c){g=e(g);g.bind("click",function(d){!0!==g.data("disabletheater")&&(d.preventDefault(),e.evolutionTheater.show({content:function(a){n(c.theaterurl,a)},loaded:function(a){}}))})}};return{}},jQuery,window);u("component.tip",["module.ui"],function(f,e,k,h){e.telligent.evolution.ui.components.tip={setup:function(){},add:function(f,g){e(f).evolutionTip({attribute:g.tipcontent||e.fn.evolutionTip.defaults.attribute,
horizontal:g.tiphorizontal,vertical:g.tipvertical})}};return{}},jQuery,window);u("component.tourtip",["module.ui","module.tourtips"],function(f,e,k,h,n){k.telligent.evolution.ui.components.tourtip={setup:function(){},add:function(g,c){k.telligent.evolution.tourTips.register({key:c.tourtipkey,message:c.tourtipmessage,index:c.tourtipindex,element:g.get(0)})}};return{}},jQuery,window);u("component.userpresence",["module.ui","module.messaging","lib.util"],function(f,e,k,h,n,g){var c;h.telligent.evolution.ui.components.userpresence=
{setup:function(){c=h("body")},add:function(d,a){var b=a.presentlabel,p=a.notpresentlabel;h.telligent.evolution.sockets&&h.telligent.evolution.sockets.presence&&(h.telligent.evolution.presence.register({node:c,contents:[{ContentId:a.contentid,ContentTypeId:a.contenttypeid}]}),e.subscribe("user.presenceChanged",function(c){c&&a.userid==c.userId&&(!0===c.present?d.show().html(b).attr("data-tip",b).addClass("present"):!1===c.present?d.show().html(p).attr("data-tip",p).removeClass("present"):d.hide())}))}};
return{}},jQuery,window);u("component.viewhtml",["module.ui","module.messaging"],function(f,e,k,h,n){function g(a,c,d,g){a={url:a,width:0,height:0,outputIsPersisted:!1};c&&(a.width=c);d&&(a.height=d);g&&(a.outputIsPersisted=g);return k.telligent.evolution.get({url:jQuery.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/ui/view.json",data:a})}function c(a,p,m){h.clearTimeout(p.reflowWaitTimeout);if("none"==a.css("display")||"none"==a.parent().css("display")||document.fullScreen||document.mozFullScreen||
document.webkitIsFullScreen||document.fullscreenElement)h.setTimeout(function(){c(a,p,m)},499);else if(!m||"viewable"==p.resizedBy){var q=k(h).width(),t=a.parent().width(),l=a.parent().height(),f="parent",r=l;if(q<t)p.reflowWaitCheckCount++,10>p.reflowWaitCheckCount&&(p.reflowWaitTimeout=setTimeout(function(){c(a,p,m)},250));else{0==t&&(t=a.parents(".layout-region-inner").width());t>p.width&&(t=p.width);if(0==l||"parent"!=p.resizedBy||l>d)r=d,l=Math.round(0.8*d),f="viewable";l>p.height&&0<p.height&&
(r=l=p.height,f="configured");p.resizedBy=f;if(r!=p.lastHeight||t!=p.lastHeight){var f=a.width(),e=a.height();if(!(t==p.lastWidth&&r<=p.lastHeight&&(e<=r||0==r)||r==p.lastHeight&&t<=p.lastWidth&&(f<=t||0==t))){var s=[],n=!0;a.children().each(function(){k(this);var a=(this.nodeName||"").toLowerCase();"video"==a||"audio"==a||"embed"==a||"object"==a?s.push(this):"script"!=a&&("style"!=a&&"meta"!=a)&&(n=!1)});n&&0<a.children().length?(k.each(s,function(){var a=k(this),b=a.width()||1,c=a.height()||1;b/
t>c/l?a.attr({width:t+"px !important",height:c*t/b+"px !important"}):a.attr({width:b*l/c+"px !important",height:l+"px !important"})}),a.trigger("rendered")):(""==p.lastHtml&&a.html(k('<div><span class="ui-loading"></span></div>').css({display:"inline-block",width:t?t+"px":0.8*q+"px",height:l?l+"px":0.8*d+"px",display:"flex","align-items":"center","justify-content":"center"})),g(p.url,t,l,p.persist).done(function(c){p.lastHtml!=c.Html&&(a.html(c.Html),p.lastHtml=c.Html,a.trigger("rendered"))}));p.lastHeight=
r;p.lastWidth=t}}}}}var d,a=!1;k.telligent.evolution.ui.components.viewhtml={setup:function(){d=k(window).height();k(window).on("resized",function(){a||(d=k(window).height())});k.telligent.evolution.messaging.subscribe("window.scrollableheight",function(b){d=b.height;a=!0})},add:function(a,d){d.resizedBy="parent";d.lastWidth=-1;d.lastHeight=-1;d.lastHtml="";d.reflowWaitCheckCount=0;d.reflowWaitTimeout=null;c(a,d,!1);k(window).on("resized",function(){c(a,d,!1)});k.telligent.evolution.messaging.subscribe("window.scrollableheight",
function(m){c(a,d,!0)})}};return{}},jQuery,window);u("component.vote",["module.ui"],function(f,e,k,h){function n(c){return e.Deferred(function(d){e.telligent.evolution.get({url:e.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/ideas/vote.json",data:{IdeaId:c,UserId:e.telligent.evolution.user.accessing.id},error:function(){d.resolve(null)}}).done(function(a){d.resolve(a.Vote.Value)})}).promise()}function g(c,d,a){a.contentId==c.contentid&&n(a.contentId).done(function(b){e(d).evolutionUpDownVoting("option",
{yesVotes:a.yesVotes,noVotes:a.noVotes,voteCount:a.totalVotes,score:a.score,userVote:b})})}e.telligent.evolution.ui.components.vote={setup:function(){},add:function(c,d){var a=e.extend({},{isReadOnly:"true"===d.readonly,yesVotes:parseInt(d.initialyesvotes),noVotes:parseInt(d.initialnovotes),voteCount:parseInt(d.initialvotes),score:parseInt(d.initialscore),userVote:d.initialuservote,canUserUpVote:"true"===d.canuserupvote,canUserDownVote:"true"===d.canuserdownvote,isUserRegistered:"true"===d.isuserregistered,
isUserGroupMember:"true"===d.isusergroupmember,loginUrl:d.loginurl});e.telligent.evolution.messaging.subscribe("ideaVote.created",function(a){g(d,c,a)});e.telligent.evolution.messaging.subscribe("ideaVote.deleted",function(a){g(d,c,a)});a.onVote=function(a){d.contentid&&e.telligent.evolution.post({url:e.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/ideas/vote.json",data:{IdeaId:d.contentid,Value:a},success:function(a){a&&a.Vote&&a.Vote.Idea?e(c).evolutionUpDownVoting("option",{yesVotes:a.Vote.Idea.YesVotes,
noVotes:a.Vote.Idea.NoVotes,voteCount:a.Vote.Idea.TotalVotes,score:a.Vote.Idea.Score,userVote:a.Vote.Value}):e(c).evolutionUpDownVoting("option",{yesVotes:0,noVotes:0,voteCount:0,score:0,userVote:null})}})};a.onDeleteVote=function(){d.contentid&&e.telligent.evolution.del({url:e.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/ideas/vote.json",data:{IdeaId:d.contentid},success:function(a){e.telligent.evolution.get({url:e.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/ideas/idea.json",data:{Id:d.contentid},
success:function(a){a&&a.Idea?e(c).evolutionUpDownVoting("option",{yesVotes:a.Idea.YesVotes,noVotes:a.Idea.NoVotes,voteCount:a.Idea.TotalVotes,score:a.Idea.Score,userVote:null}):e(c).evolutionUpDownVoting("option",{yesVotes:0,noVotes:0,voteCount:0,score:0,userVote:null})}})}})};0==a.voteCount&&a.isReadOnly||e(c).evolutionUpDownVoting(a)}};return{}},jQuery,window);u("component.webpreview",["module.ui"],function(f,e,k,h){e.telligent.evolution.ui.components.webpreview={setup:function(){},add:function(f,
g){var c=g.configuration.url,d,a;"undefined"!==typeof g.configuration.maximagewidth&&(d=g.configuration.maximagewidth);"undefined"!==typeof g.configuration.maximageheight&&(a=g.configuration.maximageheight);f.hasClass("preview")||(f.parents(".ui-theater").data("disabletheater",!0),0>g.configuration.url.indexOf(e.telligent.evolution.site.getBaseUrl(!0))&&f.parents(".ui-theater").attr("target","_blank"));e.telligent.evolution.preview.load(c,{maxImageWidth:d,maxImageHeight:a,success:function(a){a&&(a.excerpt||
a.imageUrl)&&(a=e.telligent.evolution.preview.render(a,{template:e.telligent.evolution.preview.defaults.template}),"undefined"!==typeof a&&(null!==a&&0<a.length)&&f.html(a))}})}};return{}},jQuery,window);u("composers",["composer.hashtags","composer.mentions","composer.urlhighlight","composer.autocomplete"],function(){return{}});u("composer.autocomplete",["plugin.evolutionComposer"],function(f,e,k,h){var n={},g=null,c=function(){};f=function(){return{init:function(a){c=a.settings.onSuggestionList||
e.fn.evolutionComposer.plugins.autocomplete.defaults.onSuggestionList;selectSuggestion=a.settings.onSuggestionSelect||e.fn.evolutionComposer.plugins.autocomplete.defaults.onSuggestionSelect;a.input.bind(d.selectedEventName,function(){selectSuggestion(d.selection());a.release()})},onTransform:function(a){},shouldActivate:function(a){return(a=a.currentWord())&&a.value&&3<=a.value.length?!0:!1},onActivate:function(a){a.data("_autocomplete_composer_active",!0);e(document).bind("click.autocomplete",function(b){a.release();
e(document).unbind(".autocomplete")})},onDeactivate:function(a){a.data("_autocomplete_composer_active",!1);d.hide();a.input.focus()},val:function(a,b){return a},onkeydown:function(a,b){if(27===b.which)return a.release(),!1;if(9==b.which)a.release();else{if(13===b.which){var c=d.selection();c&&selectSuggestion(c);a.release();return!1}if(38===b.which)return d.moveHighlightUp(),!1;if(40===b.which)return d.moveHighlightDown(),!1}return!0},onkeypress:function(a,b){return!0},oninput:function(a,b){clearTimeout(g);
d.loading(a.input);g=setTimeout(function(){var b=a.val();if(1<b.length){var m=function(b){null!==b&&0<b.length?d.show(a.input,b,a.settings.suggestionHeader):a.release()};"undefined"!==typeof n[b]?a.data("_autocomplete_composer_active")&&m(n[b]):c(b,function(c){a.data("_autocomplete_composer_active")&&(n[b]=c,a.val()==b&&m(c))})}else a.release()},500);return!0},defaults:{}}}();var d=function(){var a=null,b=null,c=null,d=null,g=null,t=function(l){d=l;if(null===a){a=e('<div class="composer-suggestion-selector popup-list content"></div>').hide().appendTo(e("body"));
c=e('<span class="heading"></span>').appendTo(a);b=e('<ul class="content-list content suggestions"></ul>').appendTo(a);g=e('<li class="loading">...</li>');var t=0,s=["<strong>&bull;</strong>&bull;&bull;","&bull;<strong>&bull;</strong>&bull;","&bull;&bull;<strong>&bull;</strong>"];setInterval(function(){t+=1;3===t&&(t=0);g.get(0).innerHTML=s[t]},175);a.delegate("li","click",function(b){null!==d&&(a.find("li.highlight").removeClass("highlight"),e(this).addClass("highlight"),d.trigger(f.selectedEventName))})}},
l=function(){if(null!==d){var b=d.offset(),c=e(d);a.css({width:c.outerWidth()-2,top:b.top+c.outerHeight()-1,left:b.left})}},f={selectedEventName:"SUGGESTION_SELECTED",show:function(d,m,g){c.html(g);t(d);l();a.hide();b.empty();e.each(m,function(a,c){var d=e('<li class="content-item suggestion">'+c.viewHtml+"</li>");d.data("suggestionData",c);b.append(d)});a.show()},hide:function(){null!==a&&(a.hide(),b.empty())},loading:function(c){t(c);l();a.hide();b.empty().append(g);a.show()},moveHighlightUp:function(){var b=
a.find("li.suggestion");if(0!==b.length){var c=b.length;e.each(b,function(a,b){e(b).hasClass("highlight")&&(c=a,e(b).removeClass("highlight"))});0>c-1&&(c=b.length);e(b.get(c-1)).addClass("highlight")}},moveHighlightDown:function(){var b=a.find("li.suggestion");if(0!==b.length){var c=-1;e.each(b,function(a,b){e(b).hasClass("highlight")&&(c=a,e(b).removeClass("highlight"))});c+1>=b.length&&(c=-1);e(b.get(c+1)).addClass("highlight")}},selection:function(){var b=a.find("li.suggestion");if(0===b.length)return null;
var c=b.filter("li.suggestion.highlight");return null!==c&&0<c.length?c.data("suggestionData"):e(b.get(0)).data("suggestionData")}};return f}();e.fn.evolutionComposer.plugins.autocomplete=f;e.fn.evolutionComposer.plugins.autocomplete.defaults={onSuggestionList:function(a,b){b(null)},onSuggestionSelect:function(a){}};return{}},jQuery,window);u("composer.hashtags",["plugin.evolutionComposer","lib.globalConfiguration","module.rest"],function(f,e,k,h,n,g){f=function(){for(var d=null,a=!1,b={},p=function(a){var b=
a.data("_tagged_tags");if("undefined"===typeof b||null===b)b=[],a.data("_tagged_tags",b);return b},m=function(a){return a.currentWord({additionalWhiteSpaceSymbols:"()\"'<>.,".split("")})},g=function(a,b,d,l,g){var q=p(a)||[];q[q.length]=b;d&&(d=m(a),a.replace(d.start,d.stop+1,b.decodedName+(l?" ":"")),b=d.start+(b.decodedName+(l?" ":"")).length,l=a.input.get(0),l.setSelectionRange?l.setSelectionRange(b,b):l.createTextRange&&(l=l.createTextRange(),l.collapse(!0),l.moveEnd("character",b),l.moveStart("character",
b),l.select()));t(a);a.data("_hashtag_composer_active",!1);c.hide();a.input.focus();g&&a.release()},t=function(a){var b=p(a).reverse(),c=a.val();a.clearHighlights(a.settings.highlightClass||r);var d={};h.each(b,function(l,m){if(m&&null!==m.decodedName&&0<m.decodedName.length){var t=c.indexOf(m.decodedName);if(0>t||d[t])b.splice(l,1);else for(;0<=t;)a.addHighlight({start:t,stop:m.decodedName.length+t,className:a.settings.highlightClass||r}),d[t]=!0,t=c.indexOf(m.decodedName,t+1)}});a.renderHighlights()},
l=function(a){return 2<a.length&&0===a.indexOf("#")&&!d.test(a.substr(1))&&isNaN(parseInt(a[1],10))},f=function(b){return h.Deferred(function(c){k.get({url:e.baseUrl+"tinymce/apis/hashtags",cache:!0,data:{t:"m",contenttypeid:b||""}}).then(function(b){(a=b&&"true"===b.supported)?c.resolve():c.reject()}).fail(function(){c.reject()})}).promise()},r="composer-hashtag-highlight",v=function(){},s=null,n=null,x=/\[tag:([^\]]+)\]/gi,d=RegExp("["+"-_~`!@#$%^&*()=+{[}]\\|;:'\",<.>/? ".replace("]","\\]")+"]",
"i"),z=0;33>z;z++)b["-_~`!@#$%^&*()=+{[}]\\|;:'\",<.>/? ".charCodeAt(z)]=!0;return{init:function(a){f(a.settings.contentTypeId).then(function(){v=a.settings.onTagList||h.fn.evolutionComposer.plugins.hashtags.defaults.onTagList;a.input.bind(c.selectedEventName,function(){g(a,c.selection(),!0,!0,!0)});a.input.bind("blur",function(){setTimeout(function(){a.data("_hashtag_composer_active")&&a.release()},500)})})},onTransform:function(a,b){if(b)for(var c=a.val(),d=x.exec(c);null!==d&&0<=d.index&&null!==
d&&1<d.length;){var l={token:"[tag:"+d[1]+"]",name:"#"+d[1],decodedName:"#"+h.telligent.evolution.html.decode(d[1])};a.val(a.val().replace(d[0],l.name));g(a,l,!1);d=x.exec(c)}t(a)},shouldActivate:function(b){return a?l(m(b).value):!1},onActivate:function(a){a.data("_hashtag_composer_active",!0);h(document).bind("click.ui-composer-hashtags",function(){a.release();h(document).unbind(".ui-composer-hashtags")})},onDeactivate:function(a){var b=m(a);l(b.value)&&g(a,{decodedName:b.value,name:b.value,token:"[tag:"+
b.value.substr(1)+"]"},!0,!1,!1);a.data("_hashtag_composer_active",!1);c.hide();a.input.focus()},val:function(b,c){if(!a)return b;var d=p(c);h.each(d,function(a,c){b=b.replace(RegExp(h.telligent.evolution.regex.encode(c.decodedName),"g"),c.token)});return b},onkeydown:function(b,d){if(!a)return!0;if(27===d.which||32===d.which)b.release();else if(13===d.which||9===d.which){var l=c.selection();if(l)return g(b,l,!0,!0,!0),!1;b.release()}else{if(38===d.which)return c.moveHighlightUp(),!1;if(40===d.which)return c.moveHighlightDown(),
!1}return!0},onkeypress:function(c,d){if(!a)return!0;"undefined"!==typeof b[d.which]&&c.release();return!0},oninput:function(b,d){if(!a)return!0;if(!l(m(b).value))return b.release(),!0;if(b.currentWord().value==n&&b.data("_hashtag_composer_active"))return!0;clearTimeout(s);c.loading(b.input);s=setTimeout(function(){var a=n=b.currentWord().value;l(a)?2<=a.length&&v(a.substr(1),function(d){if(b.data("_hashtag_composer_active")){d&&(d=h.map(d,function(a){return{name:a.name,token:a.token,decodedName:h.telligent.evolution.html.decode(a.name)}}));
var t=m(b).value;t==a&&l(t)&&null!==d&&0<d.length?c.show(b.input,d,a):c.hide()}}):b.release()},500);return!0}}}();var c=function(){var c=null,a=null,b=null,p=function(m){a=m;if(null===c){c=h('<ul class="composer-hashtag-selector"></ul>').hide().appendTo(h("body"));b=h('<li class="loading">...</li>');var l=0,p=["<strong>&bull;</strong>&bull;&bull;","&bull;<strong>&bull;</strong>&bull;","&bull;&bull;<strong>&bull;</strong>"];setInterval(function(){l+=1;3===l&&(l=0);b.get(0).innerHTML=p[l]},175);c.delegate("li",
"click",function(b){null!==a&&(c.find("li.highlight").removeClass("highlight"),h(this).addClass("highlight"),a.trigger(g.selectedEventName))})}},m=function(){if(null!==a){var b=a.offset(),l=h(a);c.css({width:l.outerWidth()-2,top:b.top+l.outerHeight()-1,left:b.left})}},g={selectedEventName:"HASHTAG_SELECTED",show:function(a,b,g){p(a);m();c.hide().empty();var q=RegExp(h.telligent.evolution.regex.encode(h.telligent.evolution.html.encode(g)),"i");h.each(b,function(a,b){var l=b.name.match(q),l=null!==
l?h("<li>"+b.name.replace(q,"<strong>"+l[0]+"</strong>")+"</li>"):h("<li>"+b.name+"</li>");l.data("tagData",b);c.append(l)});c.show()},hide:function(){null!==c&&c.hide().empty()},loading:function(a){p(a);m();c.hide().empty().append(b).show()},moveHighlightUp:function(){var a=c.find("li");if(0!==a.length){var b=a.length;h.each(a,function(a,c){h(c).hasClass("highlight")&&(b=a,h(c).removeClass("highlight"))});0>b-1&&(b=a.length);h(a.get(b-1)).addClass("highlight")}},moveHighlightDown:function(){var a=
c.find("li");if(0!==a.length){var b=-1;h.each(a,function(a,c){h(c).hasClass("highlight")&&(b=a,h(c).removeClass("highlight"))});b+1>=a.length&&(b=-1);h(a.get(b+1)).addClass("highlight")}},selection:function(){var a=c.find("li");if(0===a.length)return null;var b=a.filter("li.highlight");return null!==b&&0<b.length?b.data("tagData"):h(a.get(0)).data("tagData")}};return g}();h.fn.evolutionComposer.plugins.hashtags=f;h.fn.evolutionComposer.plugins.hashtags.defaults={onTagList:function(c,a){h.telligent.evolution.get({url:h.telligent.evolution.site.getBaseUrl()+
"api.ashx/v2/hashtags.json?IncludeFields=Token,PreviewHtml",data:{QueryText:c,PageSize:5},cache:!1,dataType:"json",success:function(b){b.HashTags&&0<b.HashTags.length?(b=h.map(b.HashTags,function(a){return{name:a.PreviewHtml,token:a.Token}}),a(b)):a(null)}})}};return{}},jQuery,window);u("composer.mentions",["plugin.evolutionComposer","lib.globalConfiguration","module.rest"],function(f,e,k,h,n,g){f=function(){var d={};allowedSpacesKey="_allowed_spaces";isActiveKey="_hashtag_composer_active";caretPosition=
0;supported=!1;getMentions=function(a){var b=a.data("_mentioned_mentionables");if("undefined"===typeof b||null===b)b=[],a.data("_mentioned_mentionables",b);return b};setCursorPosition=function(a,b){var c=a.input.get(0);c.setSelectionRange?c.setSelectionRange(b,b):c.createTextRange&&(c=c.createTextRange(),c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",b),c.select())};mentionMentionable=function(a,b,c){var d=getMentions(a)||[];d[d.length]=b;c&&(c=effectiveCurrentWord(a),a.replace(c.start,
c.stop+1,b.decodedName+" "),allowedSpaces(a,0),setCursorPosition(a,c.start+(b.decodedName+" ").length));a.release();updateHighlights(a)};updateHighlights=function(a){var b=getMentions(a),c=a.val();a.clearHighlights(a.settings.highlightClass||mentionHighlightClass);h.each(b,function(d,g){if(g&&null!==g.decodedName&&0<g.decodedName.length){var t=c.indexOf(g.decodedName);if(0>t)b.splice(d,1);else for(;0<=t;)a.addHighlight({start:t,stop:g.decodedName.length+t,className:a.settings.highlightClass||mentionHighlightClass}),
t=c.indexOf(g.decodedName,t+1)}});a.renderHighlights()};mentionHighlightClass="composer-mentionable-mention-highlight";getMentionables=function(){};getContent=getMentionablesTimeout=null;allowedSpaces=function(a,b){return"undefined"!==typeof b?(a.data("_allowed_spaces",b),b):a.data("_allowed_spaces")||0};effectiveCurrentWord=function(a){var b=a.val().substring(0,caretPosition),c=null;h.each(d,function(a,d){if(null!==d&&0<d.length&&b.match("@"+h.telligent.evolution.regex.encode(a)+"$"))return c="@"+
a,!1});if(null!==c){var m=b.length-c.length;allowedSpaces(a,c.split(" ").length-1);return{value:c,start:m,stop:m+c.length}}return a.currentWord({caretPosition:caretPosition,allowedWhiteSpaceBeforeCaret:allowedSpaces(a),additionalWhiteSpaceSymbols:"()\"'<>.,".split("")})};collectRawTokens=function(a){for(var b=a.val(),c=[];null!==(tokens=rToken.exec(b));)c.push({match:tokens,contentTypeId:tokens[2],contentId:tokens[1]});0<c.length&&getContent&&getContent(c,function(b){h.each(b,function(b,c){var d=
{token:c.match[0],name:c.name,decodedName:h.trim(c.name)};a.val(a.val().replace(d.token,d.name));mentionMentionable(a,d,!1)});a.input.trigger("input")})};initSupported=function(a){return h.Deferred(function(b){k.get({url:e.baseUrl+"tinymce/apis/mentions",cache:!0,data:{t:"m",contenttypeid:a||""}}).then(function(a){(supported=a&&"true"===a.supported)?b.resolve():b.reject()}).fail(function(){b.reject()})}).promise()};rToken=/\[mention:([^:]+):([^\]]+)\]/gi;return{init:function(a){initSupported(a.settings.contentTypeId).then(function(){getMentionables=
a.settings.onMentionableList||h.fn.evolutionComposer.plugins.mentions.defaults.onMentionableList;getContent=a.settings.onListContent||h.fn.evolutionComposer.plugins.mentions.defaults.onListContent;a.input.bind(c.selectedEventName,function(){mentionMentionable(a,c.selection(),!0)});a.input.bind({blur:function(){setTimeout(function(){a.data(isActiveKey)&&a.release()},500)},keydown:function(){caretPosition=a.caretPosition()+1}})})},onTransform:function(a,b){b&&collectRawTokens(a);updateHighlights(a)},
shouldActivate:function(a){return supported&&0===effectiveCurrentWord(a).value.indexOf("@")},onActivate:function(a){a.data(isActiveKey,!0);h(document).bind("click.mentions",function(){a.release();h(document).unbind(".mentions")})},onDeactivate:function(a){a.data(isActiveKey,!1);c.hide();a.input.focus();allowedSpaces(a,0)},val:function(a,b){if(!supported)return a;var c=getMentions(b);h.each(c,function(b,c){a=a.replace(c.decodedName,c.token)});return a},onkeydown:function(a,b){if(!supported)return!0;
if(32===b.which)allowedSpaces(a,allowedSpaces(a)+1);else{if(27===b.which)return a.release(),!1;if(13===b.which||9===b.which){var d=c.selection();d?mentionMentionable(a,d,!0):a.release();return!1}if(38===b.which)return c.moveHighlightUp(),!1;if(40===b.which)return c.moveHighlightDown(),!1}return!0},onkeypress:function(a,b){return!0},oninput:function(a,b){if(!supported)return!0;clearTimeout(getMentionablesTimeout);c.loading(a.input);getMentionablesTimeout=setTimeout(function(){var b=effectiveCurrentWord(a).value.substring(1);
if(1<b.length){var m=function(d){null!==d&&0<d.length?c.show(a.input,d,b):a.release()};"undefined"!==typeof d[b]?a.data(isActiveKey)&&m(d[b]):getMentionables(b,function(c){a.data(isActiveKey)&&(c&&(c=h.map(c,function(a){return{name:a.name,token:a.token,decodedName:h.trim(h.telligent.evolution.html.decode(a.name))}})),d[b]=c,effectiveCurrentWord(a).value.substring(1)==b&&m(c))})}else a.release()},500);return!0}}}();var c=function(){var c=null,a=null,b=null,g=function(m){a=m;if(null===c){c=h('<ul class="composer-mentionable-selector"></ul>').hide().appendTo(h("body"));
b=h('<li class="loading">...</li>');var l=0,g=["<strong>&bull;</strong>&bull;&bull;","&bull;<strong>&bull;</strong>&bull;","&bull;&bull;<strong>&bull;</strong>"];setInterval(function(){l+=1;3===l&&(l=0);b.get(0).innerHTML=g[l]},175);c.delegate("li","click",function(b){null!==a&&(c.find("li.highlight").removeClass("highlight"),h(this).addClass("highlight"),a.trigger(q.selectedEventName))})}},m=function(){if(null!==a){var b=a.offset(),l=h(a);c.css({width:l.outerWidth()-2,top:b.top+l.outerHeight()-1,
left:b.left})}},q={selectedEventName:"MENTIONABLE_SELECTED",show:function(a,b,q){g(a);m();c.hide().empty();var r=RegExp(h.telligent.evolution.regex.encode(h.telligent.evolution.html.encode(q)),"i");h.each(b,function(a,b){var l=b.name.match(r),l=null!==l?h("<li>"+b.name.replace(r,"<strong>"+l[0]+"</strong>")+"</li>"):h("<li>"+b.name+"</li>");l.data("mentionableData",b);c.append(l)});c.show()},hide:function(){null!==c&&c.hide().empty()},loading:function(a){g(a);m();c.hide().empty().append(b).show()},
moveHighlightUp:function(){var a=c.find("li");if(0!==a.length){var b=a.length;h.each(a,function(a,c){h(c).hasClass("highlight")&&(b=a,h(c).removeClass("highlight"))});0>b-1&&(b=a.length);h(a.get(b-1)).addClass("highlight")}},moveHighlightDown:function(){var a=c.find("li");if(0!==a.length){var b=-1;h.each(a,function(a,c){h(c).hasClass("highlight")&&(b=a,h(c).removeClass("highlight"))});b+1>=a.length&&(b=-1);h(a.get(b+1)).addClass("highlight")}},selection:function(){var a=c.find("li");if(0===a.length)return null;
var b=a.filter("li.highlight");return null!==b&&0<b.length?b.data("mentionableData"):h(a.get(0)).data("mentionableData")}};return q}();h.fn.evolutionComposer.plugins.mentions=f;h.fn.evolutionComposer.plugins.mentions.defaults={onListContent:function(c,a){h.telligent.evolution.batch(function(){h.each(c,function(a,c){h.telligent.evolution.get({url:h.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/genericcontent/{contentId}/{contentTypeId}.json",data:{contentId:c.contentId,contentTypeId:c.contentTypeId}}).then(function(a){c.name=
a.Content.HtmlName})})}).then(function(){a(c)})},onMentionableList:function(c,a){h.telligent.evolution.get({url:h.fn.evolutionComposer.plugins.mentions.defaults.mentionablesEndpoint,data:{QueryText:c,PageSize:20},cache:!1,dataType:"json",success:function(b){b.Mentionables&&0<b.Mentionables.length?(b=h.map(b.Mentionables,function(a){return{name:a.PreviewHtml,token:a.Token}}),a(b)):a(null)}})},mentionablesEndpoint:h.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/mentionables.json?IncludeFields=Token,PreviewHtml"};
return{}},jQuery,window);u("composer.urlhighlight",["plugin.evolutionComposer"],function(f,e,k,h){var n=/(\b(http):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;f=function(){var g={init:function(c){c.highlighClassName=c.highlighClassName||g.defaults.highlighClassName},onTransform:function(c){var d;d=(c.val()||"").match(n);d=null!==d&&0<d.length?d[0]:null;if(null!==d){var a;a=c.data("_composer_urlpreview_data");if(null===a||"undefined"===typeof a)a={},c.data("_composer_urlpreview_data",a);
var b=c.val().indexOf(d);if(0<=b&&"undefined"===typeof a.lastRange||a.lastRange.start!==b||a.lastRange.stop!==b+d.length)a.lastRange={start:b,stop:b+d.length},c.clearHighlights(c.highlighClassName),c.addHighlight({start:b,stop:b+d.length,className:c.highlighClassName}),c.renderHighlights()}else c.clearHighlights(c.highlighClassName)},shouldActivate:function(c){return!1},val:function(c,d){return c},onkeydown:function(c,d){return!0},oninput:function(c,d){return!0},defaults:{highlighClassName:"composer-url-highlight",
loadingText:"..."}};return g}();e.fn.evolutionComposer.plugins.urlhighlight=f;return{}},jQuery,window);u("events","events.gestures events.hashchange events.notifications events.systemnotifications events.pointers events.scroll events.textinput events.resized events.comments events.presence events.activitystories events.wake events.forums events.quote events.rendered events.likes events.ideaVotes events.mutate".split(" "),function(){return{}});u("events.activitystories",["module.messaging"],function(f,
e,k){f.subscribe("socket.connected",function(){e.telligent.evolution.sockets.activitystories.on("created",function(e){f.publish("activitystory.created",e)});e.telligent.evolution.sockets.activitystories.on("updated",function(e){f.publish("activitystory.updated",e)});e.telligent.evolution.sockets.activitystories.on("deleted",function(e){f.publish("activitystory.deleted",e)})});return{}},jQuery,window);u("events.comments",["module.messaging"],function(f,e,k){f.subscribe("socket.connected",function(){e.telligent.evolution.sockets.comments.on("created",
function(e){f.publish("comment.created",e)});e.telligent.evolution.sockets.comments.on("updated",function(e){f.publish("comment.updated",e)});e.telligent.evolution.sockets.comments.on("deleted",function(e){f.publish("comment.deleted",e)});e.telligent.evolution.sockets.comments.on("typing",function(e){f.publish("comment.typing",e)});e.telligent.evolution.sockets.comments.on("voted",function(e){f.publish("comment.voted",e)});e.telligent.evolution.sockets.comments.on("presenceChanged",function(e){f.publish("comments.presenceChanged",
e)})});return{}},jQuery,window);u("events.forums",["module.messaging"],function(f,e,k){f.subscribe("socket.connected",function(){e.telligent.evolution.sockets.forums.on("thread.updated",function(e){f.publish("forumThread.updated",e)});e.telligent.evolution.sockets.forums.on("created",function(e){f.publish("forumReply.created",e)});e.telligent.evolution.sockets.forums.on("updated",function(e){f.publish("forumReply.updated",e)});e.telligent.evolution.sockets.forums.on("deleted",function(e){f.publish("forumReply.deleted",
e)});e.telligent.evolution.sockets.forums.on("typing",function(e){f.publish("forumReply.typing",e)});e.telligent.evolution.sockets.forums.on("voted",function(e){f.publish("forumReply.voted",e)});e.telligent.evolution.sockets.forums.on("presenceChanged",function(e){f.publish("forumThread.presenceChanged",e)});e.telligent.evolution.sockets.forums.on("threadvoted",function(e){f.publish("forumThread.voted",e)})});return{}},jQuery,window);u("events.gestures",["events.pointers"],function(f,e,k){function h(a){return(new Date).getTime()-
(a||(new Date).getTime())}function n(a,b,c,d){a=180*Math.atan2(b-d,c-a)/Math.PI;0>a&&(a+=360);return a}function g(a){if(315<a||45>=a)return"right";if(45<a&&135>=a)return"up";if(135<a&&225>=a)return"left";if(225<a&&315>=a)return"down"}function c(a,b,c){if(a.selector){var d=e(b.originalEvent.target);if(d.is(a.selector)||0<d.closest(a.selector).length)return c.call(this,b)}else return c.call(this,b)}function d(a,b,c,d){c.target=a.target;d?b.trigger(c):b&&b.triggerHandler(c);return a.cancelBubble==p?
!0:a.cancelBubble}function a(a,l){var p;a.on(t.start+b,function(b){return c(l,b,function(){p&&k.clearTimeout(p.tapHoldDurationout);p={startTime:(new Date).getTime(),startPageX:b&&b.pointers&&1<=b.pointers.length?b.pointers[0].pageX:0,startPageY:b&&b.pointers&&1<=b.pointers.length?b.pointers[0].pageY:0,held:!1,tapHoldDurationout:null,lastTap:p?p.lastTap:0};p.tapHoldDurationout=k.setTimeout(function(){p.held=!0;d(b,a,{type:m.taphold,pointers:b.pointers,originalEvent:b,duration:h(p.startTime||(new Date).getTime())})},
q.tapHoldDuration)})});a.on(t.move+b,function(b){return c(l,b,function(){if(p){var c=Math.abs(Math.sqrt(Math.pow((b&&b.pointers&&1<=b.pointers.length?b.pointers[0].pageX:0)-p.startPageX,2)+Math.pow((b&&b.pointers&&1<=b.pointers.length?b.pointers[0].pageY:0)-p.startPageY,2)));p.tapHoldDurationout&&c>=q.tapHoldMaxDistance&&k.clearTimeout(p.tapHoldDurationout);if(p.panning||b&&b.pointers&&1===b.pointers.length&&c>q.panMinDistance){var c=n(p.startPageX,p.startPageY,b&&b.pointers&&1<=b.pointers.length?
b.pointers[0].pageX:0,b&&b.pointers&&1<=b.pointers.length?b.pointers[0].pageY:0),l=g(c),c={type:m.panStart,pointers:b?b.pointers:[],originalEvent:b,angle:c,direction:l,pageX:b&&b.pointers&&1<=b.pointers.length?b.pointers[0].pageX:0,pageY:b&&b.pointers&&1<=b.pointers.length?b.pointers[0].pageY:0};p.panning||(p.panning=!0,d(b,a,c,!0));c.type=m.pan;d(b,a,c,!0)}}})});a.on(t.end+b,function(b){return c(l,b,function(){if(p){k.clearTimeout(p.tapHoldDurationout);var c=h(p.startTime||(new Date).getTime()),
l=Math.abs(Math.sqrt(Math.pow((b&&b.pointers&&1<=b.pointers.length?b.pointers[0].pageX:0)-p.startPageX,2)+Math.pow((b&&b.pointers&&1<=b.pointers.length?b.pointers[0].pageY:0)-p.startPageY,2)));if(!p.held&&c<=q.tapMaxDuration&&l<=q.tapMaxDistance)c={type:m.tap,pointers:b?b.pointers:[],originalEvent:b,duration:c},d(b,a,c),l=(new Date).getTime(),p.lastTap&&l-p.lastTap<=q.doubleTapMaxDuration?(c.type=m.doubleTap,d(b,a,c),p.lastTap=0):p.lastTap=l;else if(p.panning&&d(b,a,{type:m.panEnd,pointers:b?b.pointers:
[],originalEvent:b,pageX:b&&b.pointers&&1<=b.pointers.length?b.pointers[0].pageX:0,pageY:b&&b.pointers&&1<=b.pointers.length?b.pointers[0].pageY:0},!0),b&&b.pointers&&1===b.pointers.length&&l/c>=q.swipeMinVelocity){var t=n(p.startPageX,p.startPageY,b&&b.pointers&&1<=b.pointers.length?b.pointers[0].pageX:0,b&&b.pointers&&1<=b.pointers.length?b.pointers[0].pageY:0),l=g(t),c={type:m.swipe,pointers:b?b.pointers:[],originalEvent:b,duration:c,angle:t,direction:l,pageX:b&&b.pointers&&1<=b.pointers.length?
b.pointers[0].pageX:0,pageY:b&&b.pointers&&1<=b.pointers.length?b.pointers[0].pageY:0};d(b,a,c,!0);c.type+=l;d(b,a,c,!0)}else p={}}})})}var b="._gesture_events_namespace",p,m={tap:"tap",taphold:"taphold",doubleTap:"doubletap",swipe:"swipe",swipeUp:"swipeup",swipeDown:"swipedown",swipeRight:"swiperight",swipeLeft:"swipeleft",panStart:"panstart",pan:"pan",panEnd:"panend"},q={tapHoldDuration:400,tapHoldMaxDistance:1,tapMaxDuration:350,tapMaxDistance:10,swipeMinVelocity:0.5,panMinDistance:10,doubleTapMaxDuration:250},
t={start:"pointerstart",move:"pointermove",end:"pointerend"};if(e.telligent&&e.telligent.evolution&&e.telligent.evolution._SUPPRESS_GESTURES)return{eventNamespace:b.substring(1)};window.onorientationchange===p&&(e.event.special.orientationchange={setup:function(){var a=e(window),b,c=function(){a.trigger("orientationchange")};window.addEventListener("resize",function(a){k.clearTimeout(b);b=k.setTimeout(c,100)},!1)}});var l={"-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none",
"-moz-user-select":"none","-ms-user-select":"none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)"};e.each(m,function(c,d){e.event.special[d]={add:function(b){var c=e(this);d===m.taphold&&c.css(l);c.data("._gesture_events_bound")||(c.data("._gesture_events_bound",!0),a(c,b))},remove:function(a){a=e(this);a.off(b);a.removeData("._gesture_events_bound")}}});e.gestures={defaults:q};return{eventNamespace:b.substring(1)}},jQuery,window);u("events.hashchange",function(f,e){var k="onhashchange"in
e&&(void 0===document.documentMode||7<document.documentMode),h=e.location.href,n=f(e),g;k||(f.event.special.hashchange={setup:function(){g||(g=setInterval(function(){e.location.href!==h&&(h=e.location.href,n.trigger("hashchange"))},f.hashChangeSettings.interval))}});f.hashChangeSettings={interval:10};return{}},jQuery,window);u("events.ideaVotes",["module.messaging"],function(f,e,k){f.subscribe("socket.connected",function(){e.telligent.evolution.sockets.ideaVotes.on("created",function(e){f.publish("ideaVote.created",
e)});e.telligent.evolution.sockets.ideaVotes.on("deleted",function(e){f.publish("ideaVote.deleted",e)})});return{}},jQuery,window);u("events.textinput",function(f,e,k){var h=!f.browser.msie&&"oninput"in document.createElement("input")&&"oninput"in document.createElement("textarea");f.event.special.textinput={setup:function(){var e=f(this);if(h)e.bind("input",function(c){e.trigger("textinput",{which:c.which})});else{var g;e.bind({keydown:function(c){g=e.val()},keyup:function(c){var d=e.val();d!==g&&
e.trigger("textinput",{which:c.which});g=d}})}}};return{}},jQuery,window);u("events.likes",["module.messaging"],function(f,e,k){f.subscribe("socket.connected",function(){e.telligent.evolution.sockets.likes.on("created",function(e){f.publish("like.created",e)});e.telligent.evolution.sockets.likes.on("deleted",function(e){f.publish("like.deleted",e)})});return{}},jQuery,window);u("events.mutate",function(f,e){f.event.special.mutate={add:function(e){if(MutationObserver){var h=f(this);h.data("_mutation_observed")||
(h.data("_mutation_observed",!0),(new MutationObserver(function(e){h.trigger("mutate",e)})).observe(this,{childList:!0,characterData:!1,attributes:!1}))}}};return{}},jQuery,window);u("events.notifications",["module.messaging"],function(f,e,k){function h(d){if(!(g&&d&&d.typeId&&c))return!1;for(var a=0;a<c.length;a++)if(!c[a](d))return!0;var b=g[d.typeId];if(!b)return!1;for(a=0;a<b.length;a++)if(!b[a](d))return!0;return!1}var n=0,g={},c=[];e.telligent.evolution.messaging.subscribe("socket.connected",
function(){e.telligent.evolution.sockets.notifications.on("received",function(c){h(c)&&(c.suppress=!0);e.telligent.evolution.messaging.publish("notification.raised",c)});e.telligent.evolution.sockets.notifications.on("read",function(c){h(c)&&(c.suppress=!0);e.telligent.evolution.messaging.publish("notification.read",c)})});e.telligent=e.telligent||{};e.telligent.evolution=e.telligent.evolution||{};e.telligent.evolution.notifications=e.extend(e.telligent.evolution.notifications||{},{addFilter:function(d,
a){if(d)return e.isFunction(d)&&(a=d,d=null),a=a||function(){return!1},n++,a.filterId=n,d?(g[d]=g[d]||[],g[d].push(a)):c.push(a),n},removeFilter:function(d,a){if(d){var b=g[d];b&&(a?(b=e.grep(b,function(b){return b.filterId!=a}),g[d]=b,c=e.grep(c,function(b){return b.filterId!=a})):delete g[d])}},clearFilters:function(){g={};c=[];n=0}});return{}},jQuery,window);u("events.pointers",["lib.util"],function(f,e,k,h){function n(a,b){this.pageX=a;this.pageY=b}function g(a){return[new n(a.pageX,a.pageY)]}
function c(a){if(!a||!a.length)return[];for(var b=[],c=0;c<a.length;c++)b[b.length]=new n(a[c].pageX,a[c].pageY);return b}function d(a){return[new n(a.originalEvent.pageX,a.originalEvent.pageY)]}function a(a,b,c,d){a&&a.length&&a.triggerHandler({type:b,pointers:c,originalEvent:d,target:d.target})}function b(a,b,c){if(a.selector){var d=e(b.originalEvent.target);if(d.is(a.selector)||0<d.closest(a.selector).length)return c.call(this,b)}else c.call(this,b)}function p(){var a={pointermove:"tepointermove",
pointerstart:"tepointerstart",pointerend:"tepointerend"};e.fn.on=e.fn.bind=m(e.fn.on,a,!0);e.fn.trigger=m(e.fn.trigger,a,!1);e.fn.off=e.fn.unbind=m(e.fn.off,a,!1)}function m(a,b,c){return function(){var d=Array.prototype.slice.call(arguments,0);if(c&&1===d.length&&e.isPlainObject(d[0])){var l=d[0];e.each(b,function(a,b){l[a]!=h&&(l[b]=l[a],delete l[a])});return a.call(this,l)}if("string"!=typeof d[0])return a.apply(this,d);eventParts=d[0].split(".",2);if(2==eventParts.length&&"_pointer_events_namespace"==
eventParts[1])return a.apply(this,d);b[eventParts[0]]&&(eventParts[0]=b[eventParts[0]],d[0]=eventParts.join("."));return a.apply(this,d)}}var q={start:"pointerstart",testart:"tepointerstart",move:"pointermove",temove:"tepointermove",end:"pointerend",teend:"tepointerend"},t={pointerMoveThrottle:10};if(e.telligent&&e.telligent.evolution&&e.telligent.evolution._SUPPRESS_POINTERS)return{eventNamespace:"_pointer_events_namespace"};var l=window.PointerEvent?{down:"pointerdown",move:"pointermove",up:"pointerup",
cancel:"pointercancel"}:{down:"MSPointerDown",move:"MSPointerMove",up:"MSPointerUp",cancel:"MSPointerCancel"};k=[{test:function(){return"onmspointerdown"in window},add:function(c,m){var p=!1;c.on(l.down+"._pointer_events_namespace",function(l){b(m,l,function(){a(c,q.testart,d(l),l);p=!0})});c.on(l.move+"._pointer_events_namespace",f.throttle(function(l){b(m,l,function(){p&&a(c,q.temove,d(l),l)})},t.pointerMoveThrottle));c.on(l.up+"._pointer_events_namespace",function(l){b(m,l,function(){p=!1;a(c,
q.teend,d(l),l)})});c.on(l.cancel+"._pointer_events_namespace",function(l){b(m,l,function(){p=!1;a(c,q.teend,d(l),l)})})},remove:function(a){a.off("._pointer_events_namespace")}},{test:function(){return"ontouchstart"in window},add:function(d,l){var m=!1;d.on("touchstart._pointer_events_namespace",function(p){b(l,p,function(){a(d,q.testart,c(p.originalEvent.touches),p);m=!0})});d.on("touchmove._pointer_events_namespace",f.throttle(function(p){b(l,p,function(){m&&a(d,q.temove,c(p.originalEvent.touches),
p)})},t.pointerMoveThrottle));d.on("touchend._pointer_events_namespace",function(p){b(l,p,function(){m=!1;a(d,q.teend,c(p.originalEvent.changedTouches),p)})});d.on("touchcancel._pointer_events_namespace",function(p){b(l,p,function(){m=!1;a(d,q.teend,c(p.originalEvent.changedTouches),p)})})},remove:function(a){a.off("._pointer_events_namespace")}},{test:function(){return"onmousedown"in document},add:function(c,d){var l=!1;c.on("mousedown._pointer_events_namespace",function(m){1===m.which&&b(d,m,function(){a(c,
q.testart,g(m),m);l=!0})});c.on("mousemove._pointer_events_namespace",f.throttle(function(m){b(d,m,function(){l&&a(c,q.temove,g(m),m)})},t.pointerMoveThrottle));c.on("mouseup._pointer_events_namespace",function(m){1===m.which&&b(d,m,function(){l=!1;a(c,q.teend,g(m),m)})});c.on("mouseleave._pointer_events_namespace",function(m){b(d,m,function(){l&&a(c,q.teend,g(m),m);l=!1})})},remove:function(a){a.off("._pointer_events_namespace")}}];for(var w,r=0;r<k.length;r++)!w&&k[r].test()&&(w=k[r]);if(w){for(var v in q)e.event.special[q[v]]=
{add:function(a){var b=e(this);b.data("._pointer_events_bound")||(b.data("._pointer_events_bound",!0),w.add(b,a))},remove:function(a){a=e(this);w.remove(a);a.removeData("._pointer_events_bound")}};e.pointer={defaults:t};p();return{eventNamespace:"_pointer_events_namespace"}}},jQuery,window);u("events.presence",["module.messaging"],function(f,e,k){f.subscribe("socket.connected",function(){e.telligent.evolution.sockets.presence.on("userPresenceChanged",function(e){f.publish("user.presenceChanged",e)})});
return{}},jQuery,window);u("events.quote",function(f,e){function k(){if(!d){f(document).on("selectionchange._evolution_quote",function(){c()});if(!("onselectionchange"in document))f(document).on("mousemove._evolution_quote",function(){c()});f(document).on("customizepage._evolution_quote",function(){h()});p=f('<a href="#" class="evolution-quote-handle"></a>').html(f.event.special.quote.defaults.quoteText).hide().on("click",function(b){null!=a&&(f(a.element).trigger(f.Event("quote",{quotedHtml:a.html})),
q=!1,p.hide(),e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():document.selection&&document.selection.empty());return!1}).on("mouseout",function(a){q=!1}).on("mouseover mousemove",function(a){q||(a.buttons&&0!=a.buttons?p.hide():q=!0)}).appendTo(f("body"));d=!0}}function h(){!d||0<b.length||(f(document).off("._evolution_quote"),p.remove(),p=null,d=!1)}function n(a){for(var c=0;c<b.length;c++)if(b[c].parentElement==
a||f.contains(b[c].parentElement,a)){if(!b[c].selector)return!0;c=f(b[c].selector,f(b[c].parentElement));return 0<c.filter(a).length||0<c.find(a).length}return!1}function g(){if(window.getSelection){var a=window.getSelection();if(a&&0<a.rangeCount&&0<a.toString().length){var b=a.anchorNode;if(null!=b&&null!=a.focusNode)for(;!f.contains(b,a.focusNode);)b=b.parentNode;var a=a.getRangeAt(0),c=null,d=null,m=null,p=null,g=null;if(null!=a){var q=a.getClientRects();if(q&&0<q.length)for(var e=0;e<q.length;e++){g=
q[e];if(null==d||g.top<d)d=g.top;if(null==c||g.left<c)c=g.left;if(null==m||g.left+g.width>m)m=g.left+g.width;if(null==p||g.top+g.height>p)p=g.top+g.height}g=document.createElement("div");g.appendChild(a.cloneContents());g=g.innerHTML}return{html:g,element:b,left:c,top:d,width:null!=c&&null!=m?m-c:null,height:null!=d&&null!=p?p-d:null}}}else if(document.selection&&(b=document.selection.createRange())&&b.text)return g=b.getBoundingClientRect(),{html:b.htmlText,element:b.parentElement(),left:g.left,
top:g.top,width:g.right-g.left,height:g.bottom-g.top};return null}function c(){var b=g();b&&null!=b.html&&0<b.html.length&&b.element&&n(b.element)?(e.clearTimeout(m),a=b,p.show().css({position:"absolute",left:b.left+f(e).scrollLeft()+"px",top:b.top+b.height+f(e).scrollTop()+"px"})):(e.clearTimeout(m),m=e.setTimeout(function(){a=null;d&&p&&(q=!1,p.hide())},250))}var d=!1,a=null,b=[],p,m=null,q=!1;f.event.special.quote={setup:function(){},add:function(a){b.push({parentElement:this,selector:a.selector});
k()},remove:function(a){var c=this,d=!1;b=f.grep(b,function(b){if(d||b.parentElement!=c||b.selector!=a.selector)return!0;if(!d)return d=!0,!1});h()},teardown:function(){},defaults:{quoteText:"Quote"}};return{}},jQuery,window);u("events.rendered",function(f,e,k){var h={},n=function(g){g&&h[g]!=k&&(h[g]--,0===h[g]&&f(g).trigger(f.Event("rendered")))};f.event.special.rendered={setup:function(){h[this]=0},add:function(g){},remove:function(g){},teardown:function(){delete h[this]},noBubble:!0};return{incrementLoading:function(g){g.get&&
(g=g.get(0));g&&h[g]!=k&&h[g]++},decrementLoading:function(g){g.get?n(g.get(0)):n(g)}}},jQuery,window);u("events.resized",function(f,e,k){var h=0;f.event.special.resized={setup:function(e){e=f("<div></div>").css({position:"absolute",width:"100px",height:"100px",overflow:"scroll",left:"-200px"});f("body").append(e);try{var g=e.get(0);h=g.offsetWidth-g.clientWidth}catch(c){h=0}e.remove()},add:function(){function n(){l=a.width();r=a[0].scrollWidth;w=a.height();v=a[0].scrollHeight;if(Math.abs(l-p)>h||
Math.abs(w-m)>h||Math.abs(r-q)>h||Math.abs(v-t)>h){var b={oldWidth:p,oldHeight:m,oldScrollWidth:q,oldScrollHeight:t,newWidth:l,newHeight:w,newScrollWidth:r,newScrollHeight:v};p=l;m=w;q=r;t=v;c.trigger("resized",b)}}function g(){e.clearTimeout(b);b=e.setTimeout(n,f.event.special.resized.defaults.throttle)}var c=f(this);if(!c.data("_resized_init")){c.data("_resized_init",!0);var d=this===document||this===e,a=d?f(window):c,b,p=0,m=0,q=0,t=0,l,w,r,v,p=a.width(),m=a.height(),q=a.get(0).scrollWidth,t=a.get(0).scrollHeight;
if(d)a.on("resize",g);else a.data("_resized_init",{intervalHandle:e.setInterval(n,1E3)})}},teardown:function(){var n=this===document||this===e,g=n?f(window):f(this);n||((n=g.data("initDataKey"))&&n.intervalHandle&&e.clearInterval(n.intervalHandle),g.data("initDataKey",!1))}};f.event.special.resized.defaults={throttle:25};return{}},jQuery,window);u("events.scroll",function(f,e){(function(){var e={};f.event.special.scrollend={setup:function(h){e=f.extend({padding:150,delay:250,initialLoadAttempts:10,
initialLoadDelay:1E3},h)},add:function(){var h=f(this);if(!h.data("_scrollend_init")){h.data("_scrollend_init",!0);var n=this===document,g=n?f(window):h,c=!1,d=-1,a=0,b=!1,p=function(){return n?f("body").prop("scrollHeight")||g.height()+1:g.prop("scrollHeight")||g.height()+1};g.on("scroll",function(){c=!0});setInterval(function(){if(c){var a;a=n?f(h).height()-f(h).scrollTop()-f(g).height()<=e.padding:h.scrollTop()+h.innerHeight()+e.padding>=h[0].scrollHeight;a?h.trigger("scrollend"):c=!1}},e.delay);
setInterval(function(){if(b){var c=g.height();c>d&&(d=c,p()<=d&&(a=0,b=!1))}else d=g.height(),p()<=d+10&&a<e.initialLoadAttempts?(a++,h.trigger("scrollend")):b=!0},e.initialLoadDelay)}}}})();(function(){var e={};f.event.special.scrolltop={setup:function(h){e=f.extend({padding:150,delay:250},h)},add:function(){var h=f(this);if(!h.data("_scrolltop_init")){h.data("_scrolltop_init",!0);var n=!1;(this===document?f(window):h).on("scroll",function(){n=!0});setInterval(function(){n&&(h.scrollTop()<=e.padding&&
h.trigger("scrolltop"),n=!1)},e.delay)}}}})();return{}},jQuery,window);u("events.systemnotifications",["module.messaging"],function(f,e,k){e.telligent.evolution.messaging.subscribe("socket.connected",function(){e.telligent.evolution.sockets.systemnotifications.on("received",function(f){e.telligent.evolution.messaging.publish("systemnotification.raised",f)});e.telligent.evolution.sockets.systemnotifications.on("resolved",function(f){e.telligent.evolution.messaging.publish("systemnotification.resolved",
f)})});return{}},jQuery,window);u("events.wake",["lib.backgroundTimer"],function(f,e,k,h){e.event.special.wake={setup:function(n){var g=(new Date).getTime();f.setInterval(function(){var c=(new Date).getTime();4E3<c-g&&e(k).trigger("wake");g=c},2E3)}};return{}},jQuery,window);u("lib","lib.actionSheet lib.dynamicLinks lib.messageLinks lib.scrollFix lib.sheet lib.sheetProvider lib.util lib.touchEventAdapter lib.globalConfiguration lib.storageProxy lib.lruCache lib.scrollable lib.backgroundTimer lib.reflow lib.storageShim lib.imagePreview".split(" "),
function(){return{}});u("lib.actionSheet",function(f,e,k){function h(g,c){var d=f(document.createElement("li"));d.append(c);g.append(d)}function n(g,c){var d=f(document.createElement("ul"));d.addClass("action-sheet");for(var a=0;a<c.length;a++)h(d,c[a]);d.on("click","a",function(a){g.sheet.hide()});g.sheet.show(d);g.content=d}return function(g){g=g||{};g.sheet=g.sheet;return{show:function(c){c=c||{};c.links=c.links||[];n(g,c.links||[])},hide:function(){g.sheet.hide()},content:function(){return g.content}}}},
jQuery,window);u("lib.backgroundTimer",function(f,e){var k=null;if(f.Worker&&f.Blob)try{var h=f.URL.createObjectURL(new Blob(["\t\t\t\tvar ids = {};\t\t\t\tonmessage = function(e) {\t\t\t\t\tvar name = e.data.name,\t\t\t\t\t\tid = e.data.id,\t\t\t\t\t\tduration = e.data.duration;\t\t\t\t\tif (name === 'st') {\t\t\t\t\t\tids[id] = setTimeout(function(){\t\t\t\t\t\t\tpostMessage(id);\t\t\t\t\t\t\tif(ids[id]) {\t\t\t\t\t\t\t\tdelete ids[id];\t\t\t\t\t\t\t}\t\t\t\t\t\t}, duration);\t\t\t\t\t} else if (name === 'ct') {\t\t\t\t\t\tif(ids[id]) {\t\t\t\t\t\t\tclearTimeout(ids[id]);\t\t\t\t\t\t\tdelete ids[id];\t\t\t\t\t\t}\t\t\t\t\t} else if (name === 'si') {\t\t\t\t\t\tids[id] = setInterval(function(){\t\t\t\t\t\t\tpostMessage(id);\t\t\t\t\t\t}, duration);\t\t\t\t\t} else if (name === 'ci') {\t\t\t\t\t\tif(ids[id]) {\t\t\t\t\t\t\tclearInterval(ids[id]);\t\t\t\t\t\t\tdelete ids[id];\t\t\t\t\t\t}\t\t\t\t\t}\t\t\t\t}\t\t\t"])),
n=new Worker(h),g=0,c={},k={setTimeout:function(a,b){g++;c[g]=a;n.postMessage({name:"st",id:g,duration:b});return g},clearTimeout:function(a){delete c[a];n.postMessage({name:"ct",id:a})},setInterval:function(a,b){g++;c[g]=a;n.postMessage({name:"si",id:g,duration:b});return g},clearInterval:function(a){delete c[a];n.postMessage({name:"ci",id:a})}};n.onmessage=function(a){if(a.data&&c[a.data])c[a.data]()}}catch(d){}k||(k={setTimeout:function(a,b){return f.setTimeout(a,b)},clearTimeout:function(a){return f.clearTimeout(a)},
setInterval:function(a,b){return f.setInterval(a,b)},clearInterval:function(a){return f.clearInterval(a)}});return k},window);u("lib.crossWindowBus",["lib.backgroundTimer"],function(f,e,k,h){function n(a,b,c){return{source:b.source,local:b.source===a.id,broadcast:c}}function g(a,b,c,d){var g={name:c,data:d,source:a.id,target:b,salt:Math.floor(1E5*Math.random())};localStorage.setItem(a.key,JSON.stringify(g));a.includeLocal&&(a.receive&&b===a.id)&&f.setTimeout(function(){a.receive(c,d,n(a,g,!1))},0)}
function c(a,b,c){var d={name:b,data:c,source:a.id,salt:Math.floor(1E5*Math.random())};localStorage.setItem(a.key,JSON.stringify(d));a.includeLocal&&a.receive&&f.setTimeout(function(){a.receive(b,c,n(a,d,!0))},0)}var d={key:"__cwb",receive:null,includeLocal:!1};return function(a){var b=e.extend({},d,a||{},{id:Math.floor(1E5*Math.random())});e(k).on("storage",function(a){if(a.originalEvent&&a.originalEvent.key===b.key&&b.receive&&a.originalEvent.newValue&&0<a.originalEvent.newValue.length)try{var c=
JSON.parse(a.originalEvent.newValue);c&&c.source!=b.id&&(c.target!==h&&c.target===b.id?b.receive(c.name,c.data,n(b,c,!1)):c.target===h&&b.receive(c.name,c.data,n(b,c,!0)))}catch(d){}});return{id:function(){return b.id},broadcast:function(a,d){c(b,a,d)},send:function(a,c,d){g(b,a,c,d)}}}},jQuery,window);u("lib.dynamicLinks",["lib.scrollFix","lib.actionSheet"],function(f,e,k,h,n){function g(a){var b=k.extend({},l);"vertical"!=a.direction&&(b.display="flex");return b}function c(a){var b=a.css("white-space"),
c;"nowrap"===b?c=a.outerWidth(!0):(a.css("white-space","nowrap"),c=a.outerWidth(!0),a.css("white-space",b));return c}function d(a){return a.scrollWidth>a.clientWidth}function a(a){var b,c,l;b=g(a);if("vertical"==a.direction){if(a.listWrapper||(a.listWrapper=k(document.createElement("div")).addClass("container").appendTo(a.parent)),!a.list){a.list=k(document.createElement("ul")).appendTo(a.listWrapper).css(b);for(b=0;b<a.links.length;b++)(c=a.links[b])&&c.element&&(l=k(document.createElement("li")).append(c.element),
c.listItem=l,a.list.append(l),c.isOverflowed=!1);a.moreLink!=n&&(l=k(document.createElement("li")).append(a.moreLink.element),a.moreLink.listItem=l,a.list.append(l))}}else{a.parent.css({overflow:"hidden"});a.listWrapper||(a.listWrapper=k(document.createElement("div")).css(t).addClass("container").appendTo(a.parent));if(!a.list){a.list=k(document.createElement("ul")).appendTo(a.listWrapper).css(b);for(b=0;b<a.links.length;b++)(c=a.links[b])&&c.element&&(l=k('<li class="'+c.className+'"></li>').append(c.element),
c.listItem=l,a.list.append(l),c.isOverflowed=!1);a.moreLink!=n&&(l=k(document.createElement("li")).append(a.moreLink.element),a.moreLink.listItem=l,a.list.append(l))}a.list.hide();a.parentWidth=a.listWrapper.width();a.list.show();if(d(a.listWrapper.get(0)))a.listWrapper.on("pan swipe pointerend",function(a){"left"!=a.direction&&"right"!=a.direction||a.stopPropagation()});f.preventBounce(a.listWrapper)}}function b(a){var b,d,l,m,g;a.additionalLinks=[];a.accumulatedWidth=0;a.preScrollTo=0;if("vertical"==
a.direction){for(d=0;d<a.links.length;d++)l=a.links[d],d>a.maxLinks-1?(a.additionalLinks.push(l),l.listItem.hide(),l.isOverflowed=!0):(l.isOverflowed&&(l.listItem.append(l.element).show(),l.isOverflowed=!1),l.listItem.addClass(l.className).appendTo(a.list));a.moreLink&&a.list.append(a.moreLink.listItem.append(a.moreLink.element).show())}else{for(d=a.moreLinkWidth=0;d<a.links.length;d++){l=a.links[d];if(!l.element)return;l.isOverflowed&&(l.listItem.append(l.element).show(),l.isOverflowed=!1);l.listItem.appendTo(a.list)}a.moreLink&&
(a.list.append(a.moreLink.listItem.append(a.moreLink.element).show()),a.moreLinkWidth=c(a.moreLink.element));for(g=d=0;d<a.links.length;d++)l=a.links[d],b=l.listItem,m=c(l.element),l.selected&&(a.preScrollTo=a.accumulatedWidth),a.accumulatedWidth+m>a.parentWidth&&g+1<=a.minLinks?a.accumulatedWidth+=m:0<a.additionalLinks.length||(a.accumulatedWidth+m+a.moreLinkWidth>a.parentWidth||g+1>a.maxLinks)&&g+1>a.minLinks?(l.element.detach(),l.isOverflowed=!0,b.hide(),a.additionalLinks.push(l)):a.accumulatedWidth+=
m,g++}}function p(a){if("vertical"==a.direction){if(0<a.additionalLinks.length&&a.moreLink&&a.onShowMore)a.moreLink.element.off(q).on("click"+q,function(b){a.onShowMore(a.additionalLinks,a.cancelLink);return!1});else a.moreLink&&(a.moreLink.element.detach(),a.moreLink.listItem.hide());a.list.css({visibility:"visible"})}else{0<a.additionalLinks.length&&a.moreLink&&a.onShowMore?(a.moreLink.listItem.addClass(a.moreLink.className),a.accumulatedWidth+=a.moreLinkWidth,a.moreLink.element.off(q).on("click"+
q,function(b){a.onShowMore(a.additionalLinks,a.cancelLink);return!1})):a.moreLink&&(a.moreLink.element.detach(),a.moreLink.listItem.hide());a.list.css({width:a.accumulatedWidth>a.parentWidth?a.accumulatedWidth:a.parentWidth});k(a.listWrapper).get(0).scrollLeft=a.preScrollTo-a.preScrollOffset;var b=a.list.height();0!=b&&(a.parent.css({height:b}),a.listWrapper.css({height:b+20}));a.listWrapper.css({visibility:"visible"})}}function m(c){k.telligent.evolution.ui.suppress(function(){a(c)});b(c);k.telligent.evolution.ui.suppress(function(){p(c)})}
var q="._dynamicLinks",t={overflow:"hidden","overflow-x":"auto"},l={visible:"hidden","list-style":"none",padding:"0px",margin:"0px",overflow:"hidden"},w=function(a){var b=k.extend({},w.defaults,a||{});return{render:function(){m(b)},addLink:function(a,c){a.element=k(a.element);c!=n?b.links.splice(c,0,a):b.links[b.links.length]=a;b.list&&(a&&a.element)&&(listItem=k('<li class="'+a.className+'"></li>').append(a.element),a.listItem=listItem,b.list.append(listItem),a.isOverflowed=!1);m(b);return a},removeLink:function(a){"string"===
typeof a||a instanceof String?b.links=k.grep(b.links,function(b){return k(b.element).is(a)?(b.listItem?b.listItem.remove():b.element&&b.element.remove(),!1):!0}):(a=k(a).get(0),b.links=k.grep(b.links,function(b){if(b.element.get(0)!==a)return!0;b.listItem?b.listItem.remove():b.element&&b.element.remove();return!1}));m(b)},links:function(a){return a?b.additionalLinks:b.links},cancelLink:function(){return b.cancelLink},moreLink:function(){return b.moreLink},resize:function(){m(b)},isVisible:function(a){a=
k(a).get(0);for(var c=0;c<(b.additionalLinks||[]).length;c++)if(b.additionalLinks[c].element.get(0)===a)return!1;return!0},update:function(a,c){var d=null,l=0;if("string"===typeof a||a instanceof String)for(var g=0;g<b.links.length;g++){if(b.links[g].element.is(a)){l=g;d=b.links[g];break}}else for(a=k(a).get(0),g=0;g<b.links.length;g++)if(b.links[g].element.get(0)===a){l=g;d=b.links[g];break}d&&(null!==c.className&&(d.className=c.className),null!==c.selected&&(d.selected=c.selected),null!==c.index&&
b.links.splice(c.index,0,b.links.splice(l,1)[0]),d&&d.element&&(d.element.detach(),d.listItem.remove(),listItem=k('<li class="'+d.className+'"></li>').append(d.element),d.listItem=listItem,b.list.append(listItem),d.isOverflowed=!1),m(b))},reconfigure:function(a){var c=!1;a.maxLinks!==n&&(b.maxLinks=a.maxLinks,c=!0);a.minLinks!==n&&(b.minLinks=a.minLinks,c=!0);a.direction!==n&&(b.direction=a.direction,c=!0);c&&m(b)}}};w.defaults={preScrollOffset:10,minLinks:0,maxLinks:50,direction:"vertical",parent:null,
links:[],moreLink:null,cancelLink:null,onShowMore:function(a,b){}};return w},jQuery,window);u("lib.globalConfiguration",function(){return{baseUrl:"",authorizationCookieName:"AuthorizationCookie",defaultErrorMessage:"An error occured while communicating with the server.",defaultMultiErrorMessagePrefix:"The following errors occured while communicating with the server:\t ",isRemote:!1,remoteUrlEncodePattern:"",accessingUserId:0,accessingUserIsSystemAccount:!0,dateMinuteInFutureFormat:"in a few seconds",
dateMinutesInFutureFormat:"in {0} minutes",dateHourInFutureFormat:"in over an hour",dateHoursInFutureFormat:"in {0} hours",dateDayInFutureFormat:"in {0} day",dateDaysInFutureFormat:"in {0} days",dateMonthInFutureFormat:"in {0} month",dateMonthsInFutureFormat:"in {0} months",dateYearInFutureFormat:"in over {0} year",dateYearsInFutureFormat:"in over {0} years",dateNowAgoFormat:"now",dateMinuteAgoFormat:"a few seconds ago",dateMinutesAgoFormat:"{0} minutes ago",dateHourAgoFormat:"{0} hour ago",dateHoursAgoFormat:"{0} hours ago",
dateDayAgoFormat:"{0} day ago",dateDaysAgoFormat:"{0} days ago",dateMonthAgoFormat:"{0} month ago",dateMonthsAgoFormat:"{0} months ago",dateYearAgoFormat:"over {0} year ago",dateYearsAgoFormat:"over {0} years ago",reflowBreakpoint:670,previewZoomIn:"Zoom In",previewZoomOut:"Zoom Out",previewClose:"Close"}});u("lib.imagePreview",["lib.globalConfiguration"],function(f,e,k,h){function n(a,b){if(0!==a.indexOf(e.telligent.evolution.site.getBaseUrl())&&0!==a.indexOf(e.telligent.evolution.site.getBaseUrl(!0)))return null;
var c;c=b?D.exec(a):L.exec(a);return null!=c?c[1]:null}function g(){if(q.height()<m||q.width()<p)return c(s),!0;v.css({"max-width":"100%","max-height":"100%"});return!1}function c(a){a?(s=!0,v.css({"max-width":"none","max-height":"none",cursor:"move",position:"absolute",left:"0px",top:"0px","z-index":"1"}).addClass("zoomed"),t.hide(),l.show()):(s=!1,v.css({"max-width":"100%","max-height":"100%",cursor:"auto",position:""}).removeClass("zoomed"),t.show(),l.hide())}function d(){e(document).off(".imageviewer");
q.css("opacity","0");var a=q;window.setTimeout(function(){a.remove()},100);e("body").css("overflow","")}function a(a){var b,c=a.parents("a").first();if(0<c.length&&c.data("imagepreviewurl")){if(b=n(c.data("imagepreviewurl")||"",!1),!b)return!1}else if(b=n(a.attr("src")||"",!0),!b||a.hasClass("ui-ignoreimagepreview")||0<c.length&&0>(c.attr("href")||"").indexOf(b))return!1;return b}function b(b){e(".viewer img, .content-fragment-content .content .content img, .user-defined-markup img, .post-attachment-viewer img",
b).each(function(){var b=e(this);b.data("_cursor_applied")||(b.data("_cursor_applied",!0),a(b)&&b.css({cursor:"zoom-in"}))})}var p,m,q,t,l,w,r,v,s=!1,y=!1,x,z,A,E,D=/\/resized-image(?:\.ashx)?\/__size\/[0-9]+x[0-9]+\/(.+)/i,L=/\/cfs\-file(?:\.ashx)?\/(.+)/i,B=f.previewZoomIn,G=f.previewZoomOut,J=f.previewClose;return{register:function(){B=f.previewZoomIn;G=f.previewZoomOut;J=f.previewClose;b(e("body"));var n;e("body").on("mutate",function(a){clearTimeout(n);n=setTimeout(function(){b(e("body"))},500)});
e("body").on("click",".viewer img, .content-fragment-content .content .content img, .user-defined-markup img, .post-attachment-viewer img",function(b){b=e(b.target);if(b=a(b)){m=p=0;s=!1;q=e('<div class="image-viewer"></div>').css("opacity","0").on("click",function(){d();return!1});t=e('<a href="#" class="zoom-in"></a>').html(B).hide().on("click",function(){c(!0);return!1});l=e('<a href="#" class="zoom-out"></a>').html(G).hide().on("click",function(){c(!1);return!1});w=e('<a href="#" class="close"></a>').html(J).on("click",
function(){d();return!1});var f=e('<div class="image-viewer-inner"></div>');r=e('<span class="ui-loading"></span>');v=e('<img src="'+e.telligent.evolution.site.getBaseUrl()+"cfs-file/"+b+'" />').hide().css({"-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",opacity:"0","max-width":"none","max-height":"none"}).on("load",function(){r.hide().remove();v.show();p=v.outerWidth(!0);m=v.outerHeight(!0);
g();v.css("opacity","1")}).on("click",function(a){a.stopPropagation();a.preventDefault()}).on("doubletap",function(a){g()&&(s=!s,c(s));return!1}).on("mousemove pan",function(a){y&&(q.scrollTop(A+(x-a.pageY)),q.scrollLeft(E+(z-a.pageX)))}).on("mousedown panstart",function(a){s&&(y=!0,A=q.scrollTop(),E=q.scrollLeft(),x=a.pageY,z=a.pageX,a.preventDefault())}).on("mouseup panend",function(){y=!1});e("body").css("overflow","hidden");e(document).off(".imageviewer").on("touchstart.imageviewer",".image-viewer",
function(a){a=this.scrollTop;var b=this.scrollHeight,c=a+this.offsetHeight;0===a?this.scrollTop=1:c===b&&(this.scrollTop=a-1)}).on("touchmove.imageviewer",function(a){for(var b=a.target,c=!1;null!==b;){if(b.classList&&b.classList.contains("image-viewer")){c=!0;break}b=b.parentNode}c||a.preventDefault()});f.append(r).append(v);q.append(t).append(l).append(w).append(f);e("body").append(q);q.css("opacity","1");return!1}})}}},jQuery,window);u("lib.lruCache",function(f,e,k){var h={size:10,load:function(){},
persist:function(e){}};return function(e){function g(){var a=d.load();a||(a={},d.persist(a));return a}var c,d=f.extend({},h,e||{load:function(){return c},persist:function(a){c=a}});return{size:function(){return d.size},get:function(a){var b=g();return b[a]!==k?(b[a].lastAccess=(new Date).getTime(),d.persist(b),b[a].value):null},set:function(a,b){var c=g();if(c[a]!==k)c[a].lastAccess=(new Date).getTime(),c[a].value=b;else{var m;if(Object.keys)m=Object.keys(c);else{m=[];for(var e in c)c.hasOwnProperty(e)&&
m.push(e)}if(m.length>=d.size){m=null;for(var t in c)null==m?m=t:c[t].lastAccess<c[m].lastAccess&&(m=t);null!==m&&delete c[m]}c[a]={lastAccess:(new Date).getTime(),value:b}}d.persist(c)},del:function(a){var b=g();delete b[a];d.persist(b)}}}},jQuery,window);u("lib.messageLinks",function(f,e,k){return function(e){e=e||{};var n=f(e.parent);return{handle:function(g){n.on(g||"click","a[data-messagename], [data-href]",function(c){null!=f(this).data("messagename")&&0<f(this).data("messagename").length?(c.preventDefault(),
c.stopPropagation(),c.stopImmediatePropagation(),f.telligent.evolution.messaging.publish(f(this).data("messagename"),{target:this}),0<f(this).closest(".links-popup-panel").length&&f.fn.uilinks.hide()):"a"!==c.target.tagName.toLowerCase()&&0<f(this).data("href").length&&(c.preventDefault(),c.stopPropagation(),c.stopImmediatePropagation(),location.href=f(this).data("href"))})}}}},jQuery,window);u("lib.reflow",["module.messaging"],function(f,e,k,h){function n(a){a.containers=e(".evolution-reflow-container:not(.single-column)");
a.singleColumnContainers=e(".evolution-reflow-container.single-column")}function g(a){var c=a.singleColumnContainers.first().is(":visible"),m=e(k).width();c&&m>a.minWidth?d(a,"originalRegion",function(a,b){return a.originalOrder-b.originalOrder},function(){a.containers.show();a.singleColumnContainers.hide()}):!c&&m<=a.minWidth&&d(a,"singleColumnRegion",function(a,b){return a.responsiveOrder==b.responsiveOrder?a.regionOrder==b.regionOrder?a.originalOrder-b.originalOrder:a.regionOrder-b.regionOrder:
a.responsiveOrder-b.responsiveOrder},function(){a.singleColumnContainers.show();a.containers.hide()})}function c(a){if(!a.fragments){a.fragments=[];for(var c=a.singleColumnContainers.first().is(":visible")?a.singleColumnContainers:a.containers,d=0;d<c.length;d++)e(".content-fragment",c[d]).each(function(){var c=(e(this).data("reflow")||"").split(",");5===c.length&&a.fragments.push({fragment:e(this),originalRegion:e("#"+c[0]+" .layout-region-inner").first(),singleColumnRegion:e("#"+c[1]),responsiveOrder:parseInt(c[2],
10),regionOrder:parseInt(c[3],10),originalOrder:parseInt(c[4],10)})})}}function d(a,d,m,g){c(a);if(!a.reflowing){f.publish("reflow.reflowstart");a.reflowing=!0;a.fragments.sort(m);for(m=0;m<a.fragments.length;m++)a.fragments[m].fragment.appendTo(a.fragments[m][d]);g();a.reflowing=!1;f.publish("reflow.reflowend")}}function a(){document.cookie=".te.w="+e(k).width()}return{monitor:function(b){var c=e.extend({minWidth:e.telligent&&e.telligent.evolution&&e.telligent.evolution.theme?e.telligent.evolution.theme.getReflowBreakpoint()||
670:670},b||{});n(c);a();g(c);e(k).on("resized",function(){a();g(c)})}}},jQuery,window);u("lib.scrollable",["module.messaging"],function(f,e,k,h){function n(a){a.indicator||(a.indicator=a.buildIndicator(),g(a))}function g(a){n(a);a.indicator.css({visibility:"hidden"}).appendTo(a.element())}function c(a,b){n(a);a.indicator.css({visibility:"visible"}).appendTo(a.element())}function d(a){n(a);a.indicator.css({visibility:"hidden"})}function a(a,c){a&&(a.element().off(".scrollable"),d(a),a.subscription&&
f.unsubscribe(a.subscription),b(a))}function b(a){a.loader&&(a.loader.reject(),a.loader=null)}function p(a,b,c){c||(a.disable=!0);a.currentlyLoading=!1;g(a);a&&(2<a.preFillAttempts&&c&&!q(a)?(a.preFillAttempts--,m(a,b)):(n(a),a.indicator.appendTo(a.element())),d(a))}function m(a,d){a.currentlyLoading||(a.currentlyLoading=!0,a.pageIndex++,c(a,d),b(a),a.loader=a.loadCallback(a.pageIndex),a.loader.done(function(b){p(a,d,!0)}).fail(function(){p(a,d,!1)}))}function q(a){for(var b=a.element().children(),
c=0,d=0;d<b.length;d++){var m=e(b[d]).css("float");"right"!==m&&"left"!==m&&e(b[d]).is(":visible")&&"hidden"!=e(b[d]).css("visibility")&&(c+=e(b[d]).outerHeight())}c-=a.indicator?a.indicator.outerHeight():0;return c>a.container.height()}function t(d){var g={pageIndex:d.initialPageIndex,subscription:null,currentlyLoading:!1,loadCallback:d.load,region:d.region,preFillAttempts:d.preFillAttempts,element:d.element,container:d.container,scrollEndMessage:d.scrollEndMessage,buildIndicator:d.buildIndicator,
initialized:!1};a(g,d.region);var p=function(){0>=g.pageIndex||!q(g)?m(g,!0):n(g)};(function(){g.initialized||(g.initialized=!0,g.subscription=f.subscribe(g.scrollEndMessage,e.telligent.evolution.administration.panelNameSpace(),function(){g.disable||m(g)}),p(),g.element().on("swipeup.scrollable",function(){g.disable||c(g)}))})();var t=null;return{reset:function(){k.clearTimeout(t);t=k.setTimeout(function(){b(g);g.currentlyLoading=!1;g.pageIndex=-1;g.disable=!1;g.preFillAttempts=d.preFillAttempts;
g.initialized&&p()},250)}}}return{register:function(a,b){b=b||{};b.region=a;return t(b)}}},jQuery,window);u("lib.scrollFix",function(f,e,k){function h(e){var g,c=e.get(0);e.on("pointerstart",function(d){g=c.scrollTop;0>=g&&(c.scrollTop=1);g+c.offsetHeight>=c.scrollHeight&&(c.scrollTop=c.scrollHeight-c.offsetHeight-1);originalScrollLeft=c.scrollLeft;0>=originalScrollLeft&&(c.scrollLeft=1);originalScrollLeft+c.offsetWidth>=c.scrollWidth&&(c.scrollLeft=c.scrollWidth-c.offsetWidth-1)})}return{preventBounce:function(e){e=
e||f("body").children().first();h(e)},fix:function(e){e.on("touchmove.scrollfix mousemove.scrollfix mspointermove.scrollfix",function(g){g.originalEvent.preventDefault()})},unfix:function(e){e.off(".scrollfix")}}},jQuery,window);u("lib.sheet",["lib.scrollFix","module.messaging"],function(f,e,k,h,n){function g(a){a.inited||(a.inited=!0,a.backDrop=k(document.createElement("div")).css({backgroundColor:a.backgroundColor,opacity:0.01,zIndex:100,position:"fixed",top:0,left:0,display:"none","-webkit-transform":"translate3d(0,0,0)",
"-webkit-backface-visibility":"hidden",transform:"translate3d(0,0,0)"}).appendTo(a.parent),a.sheet=k(document.createElement("div")).css({zIndex:101,position:"fixed",left:0,top:0,display:"none","-webkit-transform":"translate3d(0,0,0)","-webkit-backface-visibility":"hidden",transform:"translate3d(0,0,0)"}).appendTo(a.parent).addClass(a.cssClass),a.sheet.on("click","a",function(){var a=k(this);(a=a.attr("href")||a.closest("[href]").attr("href"))&&(1<a.length&&k.telligent&&k.telligent.evolution&&k.telligent.evolution.mobile)&&
k.telligent.evolution.mobile.load(a)}),p(a))}function c(a){a.windowWidth=0<window.innerWidth?window.innerWidth:screen.width;a.windowHeight=0<window.innerHeight?window.innerHeight:screen.height;a.visible?(a.backDrop.css({width:a.windowWidth,height:a.windowHeight}),a.sheet.css({width:a.windowWidth,maxHeight:a.maxHeightPerent*a.windowHeight})):(a.backDrop&&a.backDrop.css({width:a.windowWidth,height:a.windowHeight}),a.sheet&&a.sheet.css({width:a.windowWidth,maxHeight:a.maxHeightPerent*a.windowHeight}))}
function d(a,b,c){c=c||a.animationDuration;a.backDrop.evolutionTransform({opacity:a.backDrop.css("opacity")}).evolutionTransform({opacity:0.01+b*a.backgroundOpacity},{duration:c,easing:a.animationEasing});a.sheet.evolutionTransform({y:a.windowHeight-b*a.sheet.outerHeight(),x:0},{duration:c,easing:a.animationEasing});1<=b?a.onOpened&&(h.clearTimeout(a.openedTimeout),a.openedTimeout=h.setTimeout(function(){a.onOpened.apply(this);h.clearTimeout(a.openedTimeout)},c)):0>=b&&a.onClosed&&(h.clearTimeout(a.closedTimeout),
a.closedTimeout=h.setTimeout(function(){a.onClosed.apply(this);h.clearTimeout(a.closedTimeout)},c))}function a(a,b){a.visible||(k("body").css({height:"100%",overflow:"scroll"}),a.visible=!0,a.onOpening&&a.onOpening.apply(this),g(a),c(a),a.sheet.empty().append(b),a.sheet.evolutionTransform({y:a.windowHeight,x:0}),a.backDrop.get(0).style.display="block",a.sheet.get(0).style.display="block",d(a,1))}function b(a,b){a.visible&&(k("body").css({height:"100%",overflow:"visible"}),a.visible=!1,b=b||a.animationDuration,
a.onClosing&&a.onClosing.apply(this),d(a,0),h.setTimeout(function(){a.visible||(a.visible=!1,a.backDrop.get(0).style.display="none",a.sheet.get(0).style.display="none")},b))}function p(a){a.backDrop.on("tap",function(){b(a)})}return function(d){d=d||{};d.maxHeightPerent=d.maxHeightPerent||0.85;d.parent=k(d.parent);d.cssClass=d.cssClass||"sheet";d.backgroundColor=d.backgroundColor||"#333";d.backgroundOpacity=d.backgroundOpacity||0.5;d.animationDuration=d.animationDuration||250;d.animationEasing=d.animationEasing||
"cubic-bezier(0.160, 0.060, 0.450, 0.940)";d.visible=!1;k.telligent.evolution.messaging.subscribe("mobile.orientationchange",function(){h.setTimeout(function(){c(d)},300)});return{show:function(b){a(d,b)},hide:function(){b(d)}}}},jQuery,window);u("lib.sheetProvider",function(f,e,k){return{}},jQuery,window);u("lib.storageProxy",["lib.storageShim"],function(f,e,k){function h(e){this._contextualStore=e.isSystemAccount?k.sessionStorage:k.localStorage;this._user=e}f.shim();h.prototype.set=function(e,g){this._contextualStore&&
this._contextualStore.setItem("tc:"+((this._user.isSystemAccount?"":this._user.id+":")+e),JSON.stringify(g))};h.prototype.get=function(e){if(this._contextualStore)return JSON.parse(this._contextualStore.getItem("tc:"+((this._user.isSystemAccount?"":this._user.id+":")+e)))};h.prototype.del=function(e){this._contextualStore&&this._contextualStore.removeItem("tc:"+((this._user.isSystemAccount?"":this._user.id+":")+e))};h.prototype.empty=function(){this._contextualStore&&this._contextualStore.clear()};
return h},jQuery,window);u("lib.storageShim",function(f,e,k){function h(){Storage.prototype.setItem=function(c,d){n[c]=d};Storage.prototype.getItem=function(c){c=n[c];return c===k?null:c};Storage.prototype.removeItem=function(c){delete n[c]};Storage.prototype.clear=function(){n={}}}var n={},g=!1;return{shim:function(){if(!g){g=!0;var c;try{localStorage.setItem("_te","_te"),localStorage.removeItem("_te"),c=!0}catch(d){c=!1}c||h()}}}},jQuery,window);u("lib.touchEventAdapter",["lib.util","events.gestures",
"events.pointers"],function(f,e,k,h,n,g){function c(a){var b=null;"function"==typeof MouseEvent?b=new MouseEvent("click",{view:n,bubbles:!0,cancelable:!0}):(b=document.createEvent("MouseEvent"),b.initMouseEvent("click",!0,!0,n,0,0,0,0,0,!1,!1,!1,!1,0,null));b&&(b.synthesized=!0,a.dispatchEvent(b))}function d(){var a=new Date,b=new Date,d=new Date,l;h(document).on("tap",function(d){if(m)return d.preventDefault(),d.stopPropagation(),!1;if("INPUT"==d.target.nodeName||"TEXTAREA"==d.target.nodeName||"SELECT"==
d.target.nodeName){if("INPUT"==d.target.nodeName&&d.target.type!==g&&"file"==d.target.type.toLowerCase())c(d.target);else if("INPUT"==d.target.nodeName&&d.target.type!==g&&"checkbox"==d.target.type.toLowerCase()||"radio"==d.target.type.toLowerCase()){var p=h(d.target);p.is(":checked")?setTimeout(function(){p.prop("checked",!1).trigger("change")},25):setTimeout(function(){p.prop("checked",!0).trigger("change")},25)}else{if("SELECT"==d.target.nodeName)return!0;b=new Date;l=h(d.target);if(l.is(":focus"))return!0;
l.focus()}d.stopPropagation();d.stopImmediatePropagation();d.preventDefault();return!1}a=new Date;c(d.target);d.stopPropagation();d.stopImmediatePropagation();d.preventDefault()});document.addEventListener("click",function(b){if(m)return b.preventDefault(),b.stopPropagation(),!1;var c=new Date,l=c-a,c=c-d;return(b.clientX||b.clientY||b.pageX||b.pageY||b.x||b.y)&&!b.synthesized&&350>l&&350<=c?(b.preventDefault(),b.stopPropagation(),!1):!0},!0);h("body").on("focus focusin","textarea,input",function(a){return 350>
new Date-b?(a.preventDefault(),a.stopPropagation(),!1):!0});h(n).on("beforeunload",function(a){d=new Date})}function a(){var a={mouseenter:"taphold",mouseover:"taphold",mouseleave:"pointerend",mouseup:"pointerend"};h.fn.on=h.fn.bind=b(h.fn.on,a,!0);h.fn.trigger=b(h.fn.trigger,a,!1);h.fn.off=h.fn.unbind=b(h.fn.off,a,!1)}function b(a,b,c){return function(){var d=Array.prototype.slice.call(arguments,0);if(c&&1===d.length&&h.isPlainObject(d[0])){var l=d[0];h.each(b,function(a,b){l[a]!=g&&(l[b]=l[a],delete l[a])});
return a.call(this,l)}if("string"!=typeof d[0])return a.apply(this,d);eventParts=d[0].split(".",2);if(2==eventParts.length&&(eventParts[1]==e.eventNamespace||eventParts[1]==k.eventNamespace))return a.apply(this,d);b[eventParts[0]]&&(eventParts[0]=b[eventParts[0]],d[0]=eventParts.join("."));return a.apply(this,d)}}function p(){var a={after:function(){m=!0;setTimeout(function(){m=!1},q)}};n.alert=f.wrap(n.alert,a);n.confirm=f.wrap(n.confirm,a)}var m=!1,q=250,t="ontouchstart"in n||0<navigator.maxTouchPoints||
0<navigator.msMaxTouchPoints,l="_evolutionForceTouchRemap"in n,w=n!=n.parent,r=/chrom(e|ium)/.test(navigator.userAgent.toLowerCase()),v=/android/.test(navigator.userAgent.toLowerCase()),s=/windows nt/.test(navigator.userAgent.toLowerCase()),y="MouseEvent"in n&&(!("ontouchstart"in n)||s),x=parseInt((/Chrome\/([0-9]+)/.exec(navigator.userAgent)||["0","0"])[1],10),z=document.querySelector&&document.querySelector('meta[name=viewport][content*="width=device-width"]')!==g,A=document.querySelector&&document.querySelector('meta[name=viewport][content*="user-scalable=no"]')!==
g;return{adapt:function(){var b=h.telligent&&h.telligent.evolution&&h.telligent.evolution._SUPPRESS_TOUCH_MOUSE_EVENTS,c=h.telligent&&h.telligent.evolution&&h.telligent.evolution._SUPPRESS_TOUCH_CLICK_EVENTS;if(t||l)y||b||a(),c||(w||r&&v&&32<=x&&z||r&&v&&32>x&&z&&A)||(p(),d()),h(function(){h("body").addClass("touch")})}}},jQuery,window);u("lib.util",function(f,e){function k(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}var h=function(){var e=/[.*+?^${}()|[\]\\]/g;return function(g){return g.replace(e,
"\\$&")}}();return{throttle:function(e,g){var c,d;return function(){var a=this,b=(new Date).getTime(),p=arguments;c&&c+(g||50)>b?(f.clearTimeout(d),d=f.setTimeout(function(){c=b;e.apply(a,p)},g||50)):(c=b,e.apply(a,p))}},debounce:function(e,g){var c;return function(){var d=this,a=arguments;clearTimeout(c);c=setTimeout(function(){e.apply(d,a)},g||10)}},wrap:function(e,g){return function(){var c=arguments;try{g.filterArguments&&(c=g.filterArguments.apply(this,c))}catch(d){}try{g.before&&g.before.apply(this,
c)}catch(a){}var b=e.apply(this,c);try{g.after&&g.after.apply(this,c)}catch(p){}try{g.filterResponse&&(b=g.filterResponse.apply(this,b))}catch(m){}return b}},guid:function(){return k()+k()+"-"+k()+"-"+k()+"-"+k()+"-"+k()+k()+k()},isArray:function(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)},indexOf:function(e,g,c){if(Array.prototype.indexOf)return e.indexOf(g,c);if(null==e)throw new TypeError('"this" is null or not defined');e=Object(e);var d=e.length>>>
0;if(0===d)return-1;c=+c||0;Infinity===Math.abs(c)&&(c=0);if(c>=d)return-1;for(c=Math.max(0<=c?c:d-Math.abs(c),0);c<d;){if(c in e&&e[c]===g)return c;c++}return-1},isPartiallyVisible:function(e,g,c){c=c||0;if(e==document||e instanceof jQuery&&(e.get(0)==document||e.is("body"))){var d=g instanceof jQuery?g.get(0).getBoundingClientRect():g.getBoundingClientRect();return 0<d.top-c&&d.top+c<=(f.innerHeight||document.documentElement.clientHeight)||0<d.bottom-c&&d.bottom+c<=(f.innerHeight||document.documentElement.clientHeight)}e=
$(e);d=g.offset().top;g=d+g.height();var a=e.offset().top;e=a+e.height();return d+c>=a&&d-c<=e||g-c<=e&&g+c>=a},isFullyVisible:function(e,g,c){c=c||0;if(e==document||e instanceof jQuery&&(e.get(0)==document||e.is("body"))){var d=g instanceof jQuery?g.get(0).getBoundingClientRect():g.getBoundingClientRect();return 0<d.top-c&&d.top+c<=(f.innerHeight||document.documentElement.clientHeight)&&0<d.bottom-c&&d.bottom+c<=(f.innerHeight||document.documentElement.clientHeight)}e=$(e);d=g.offset().top;g=d+g.height();
var a=e.offset().top;e=a+e.height();return d+c>=a&&g-c<=e},scrollParent:function(e,g){e=$(e);var c=e.css("position"),d="absolute"===c,a=g?/(auto|scroll|hidden)/:/(auto|scroll)/,b=e.parents().filter(function(){var b=$(this);return d&&"static"===b.css("position")?!1:a.test(b.css("overflow")+b.css("overflow-y")+b.css("overflow-x"))}).eq(0);return"fixed"!==c&&b.length?b:$(e[0].ownerDocument||document)},isInDom:function(e){return e?e instanceof jQuery?document.contains?document.contains(e[0]):document.body.contains(e[0]):
document.contains?document.contains(e):document.body.contains(e):!1},compileReplacer:function(e){var g=[];$.each(e,function(a,b){g.push(h(a))});var c="("+g.join("|")+")",d=RegExp(c),a=RegExp(c,"g"),b=function(a){return e[a]};return function(c){return c&&d.test(c)?c.replace(a,b):c}},escapeRegEx:h}},window);u("modules","module.emailDigest module.administrationToolbar module.configuration module.editableGroup module.html module.language module.maxlength module.media module.messaging module.navigationConfirmation module.notifications module.preview module.regex module.sockets module.template module.ui module.url module.tourtips module.rest module.administration module.administrationContextManager module.themePreview module.presence module.systemNotifications module.javaScript module.scriptRendering".split(" "),
function(){return{}});u("module.administration",["module.messaging","module.url","lib.util","lib.scrollable"],function(f,e,k,h,n,g,c){function d(a){p(a,!0);y(a,!0);a.currentPanelOffset=0;a.rootPanelNode=a.panelNode;a.rootPanelId=a.panelId;var b=e.hashData();delete b[C];a.rootUrl="#"+e.serializeQuery(b);b={panelId:a.panelId,name:a.panelName,content:n.Deferred(function(b){b.resolve(a.panelNode)}).promise(),cssClass:"",header:"",root:!0,offset:0,url:a.rootUrl,renderedNode:a.panelNode};a.stack.push(b);
a.rootPanelNode.data("namespace",t(a,a.currentPanelOffset));M(a,a.panelNode);if(a.onTitle&&a.panelName)a.onTitle(a.panelName)}function a(a,b){if(a.stack&&1<a.stack.length){var c=a.stack[a.currentPanelOffset].renderedNode;a.onRendering&&(a.onRendering(c),n.fn.uilinks.hide());c.evolutionTransform({left:1*c.outerWidth(!0)},{duration:a.transitionDuration,easing:a.transitionEasing,complete:function(){c.remove()}});q(a,I.panelHidden,c,{direction:"none"});q(a,I.panelUnloaded,c);for(var d=a.currentPanelOffset-
1;0<=d;d--){var g=a.stack[d].renderedNode;q(a,I.panelUnloaded,g);g.remove()}}else 1==a.stack.length&&(d=a.stack[0].renderedNode,q(a,I.panelHidden,d,{direction:"none"}),q(a,I.panelUnloaded,d),d.remove());n.fn.evolutionTip.hide();D(a);l(a);y(a);if(a.onDispose)a.onDispose()}function b(a){var b=e.hashData();if(b&&b[C]!==c){b=parseInt(b[C],10);if(b>a.stack.length-1)return!1;b=a.stack[b];b.url=g.location.href;r(a,b);return!0}return 0<=g.location.href.indexOf(a.rootUrl)?(r(a,a.stack[0]),!0):!1}function p(a,
b){a.stack=[];a.currentPanelOffset=0;a.rootPanelNode=null;a.rootPanelId=null;a.rootUrl=null}function m(a,b,c){b=b?[]:[F];if(c)for(c=a.currentPanelOffset;0<=c;c--)b.push(t(a,c));else b.push(t(a,a.currentPanelOffset));return b}function q(a,b,c,d){a.sleeping||(d=d||{},c&&(a=c.data("namespace")||"",f.publish(b,n.extend({},d,{panelId:a}))))}function t(a,b){var c=F;a.rootPanelId&&(c=c+":"+a.rootPanelId,b&&(c=c+":"+b));return c}function l(a){a.suppressedNameSpaces=m(a,!0,!0);for(var b=0;b<a.suppressedNameSpaces.length;b++)f.unsubscribe(a.suppressedNameSpaces[b])}
function w(a){a&&f.unsubscribe(a)}function r(a,b){for(var c=a.stack[a.currentPanelOffset].renderedNode,d=a.stack.length;d>=(b.offset||0)+2;d--)a.stack.pop();var l={direction:b.offset>a.currentPanelOffset?"forward":"backward",panel:b};if(b.renderedNode)l.renderedNode=b.renderedNode,l.scrollTop=b.scrollTop,v(a,l,c);else{if(a.onOpening)a.onOpening();var g=a.stack[a.currentPanelOffset];a.onRendering&&(c=g.renderedNode,a.onRendering(c),n.fn.uilinks.hide());d=e.hashData();g.root?delete d[C]:d[C]=g.offset;
var m="#"+e.serializeQuery(d);b.content.done(function(d){if(a.onOpened)a.onOpened();l.templatableContent={name:b.name,content:d,panelId:b.panelId,cssClass:b.cssClass||"",backUrl:m,backLabel:g.name};v(a,l,c)}).fail(function(){if(a.onOpened)a.onOpened();if(a.onRendered)a.onRendered();window.location=m})}}function v(a,b,c){var d,l;a.currentPanelOffset=b.panel.offset;var g=D(a,b.panel.size);b.renderedNode?(d=b.renderedNode,l=!1):(n.telligent.evolution.ui.suppress(function(){var c=n.extend({contentClass:"",
panelId:"",rootPanelId:a.rootPanelId,namespace:t(a,b.panel.offset),description:"",name:""},b.templatableContent);d=n(a.template(c));b.templatableContent.content&&"string"!==typeof b.templatableContent.content&&d.find(a.panelContentSelector).first().append(b.templatableContent.content)}),l=!0,b.panel.renderedNode=d,a.onRendering&&(a.onRendering(d),n.fn.uilinks.hide()));if(a.onTitle&&b.panel&&b.panel.name)a.onTitle(b.panel.name);M(a,d);if(b.direction&&"forward"==b.direction){if(c!==d){n.fn.evolutionTip.hide();
a.loadingPanel=!0;q(a,I.panelHidden,c,{direction:"forward"});a.onRendering&&(a.onRendering(c),n.fn.uilinks.hide());c.evolutionTransform({left:-1*c.outerWidth(!0)},{duration:a.transitionDuration,easing:a.transitionEasing});a.container.one("rendered",function(){l&&q(a,I.panelLoaded,d)});d.css({position:"absolute",top:0,width:g||a.container.width(),height:a.container.height()}).appendTo(a.container);q(a,I.panelShown,d);d.evolutionTransform({left:1*a.container.width()},{duration:0}).evolutionTransform({left:0},
{duration:a.transitionDuration,easing:a.transitionEasing,complete:function(){s(a)}});if(a.onRendered)a.onRendered(d);n.fn.evolutionTip.hide()}}else if(c!==d){n.fn.evolutionTip.hide();a.loadingPanel=!0;q(a,I.panelHidden,c,{direction:"backward"});q(a,I.panelUnloaded,c);a.onRendering&&(a.onRendering(c),n.fn.uilinks.hide());c.evolutionTransform({left:1*(g||c.outerWidth(!0))},{duration:a.transitionDuration,easing:a.transitionEasing});d.css({position:"absolute",top:0,width:g||a.container.width(),height:a.container.height()});
l&&q(a,I.panelLoaded,d);q(a,I.panelShown,d);if(a.onRendered)a.onRendered(d);d.evolutionTransform({left:-1*a.container.width()},{duration:0}).evolutionTransform({left:0},{duration:a.transitionDuration,easing:a.transitionEasing,complete:function(){s(a)}});n.fn.evolutionTip.hide()}b.scrollTop&&(d.find(a.panelContentSelector).get(0).scrollTop=b.scrollTop);y(a)}function s(a){a.loadingPanel=!1;if(a.onAnimated)a.onAnimated();if(a.delayedOpen){var b=a.delayedOpen;delete a.delayedOpen;setTimeout(function(){b()},
10)}}function y(a,b){var d=a.transitionDuration;clearTimeout(a.panelCleanupTimeout);a.panelCleanupTimeout=setTimeout(function(){var d=null;a.ignoreOnDispose&&(d=a.ignoreOnDispose());(b?a.container.children('[data-rootpanelid!="'+a.rootPanelId+'"][data-panelid="'+a.rootPanelId+'"]'):a.container.children('[data-rootpanelid="'+a.rootPanelId+'"]')).each(function(){var b=n(this);if(!(b.data("rootpanelid")===c||b&&d&&1==b.length&&1==d.length&&b.get(0)===d.get(0))){var l=b.data("panelid");if(l&&0<l.length){var g=
n.grep(a.stack,function(a){return a.panelId&&a.panelId==l});g&&0!=g.length||(w(b.data("namespace")),b.remove())}}})},d)}function x(a){var b=a.stack[a.currentPanelOffset];b.scrollTop=b.renderedNode.find(a.panelContentSelector).get(0).scrollTop}function z(a,b){var c=function(){var c=n.extend({panelId:k.guid(),offset:a.stack.length,name:"",content:"",cssClass:"",header:""},b);x(a);if(!c.content.done){var d=c.content;c.content=n.Deferred(function(a){a.resolve(d)}).promise()}if(!c.header.done){var l=c.header;
c.header=n.Deferred(function(a){a.resolve(l)}).promise()}a.stack.push(c);var g=t(a,a.stack.length-1),m=[F,g];c.loaded&&f.subscribe(I.panelLoaded,m,function(b){a.sleeping||b.panelId==g&&c.loaded()});c.unloaded&&f.subscribe(I.panelUnloaded,m,function(b){a.sleeping||b.panelId==g&&c.unloaded()});c.shown&&f.subscribe(I.panelShown,m,function(b){a.sleeping||b.panelId==g&&c.shown()});c.hidden&&f.subscribe(I.panelHidden,m,function(b){a.sleeping||b.panelId==g&&c.hidden(b)});c.size&&f.subscribe(I.panelLoaded,
m,function(b){a.sleeping||b.panelId==g&&E(a,size)});if(c.header)var p=f.subscribe(I.panelLoaded,m,function(b){a.sleeping||b.panelId!=g||(setTimeout(function(){f.unsubscribe(p)},a.transitionDuration/2),c.header.done(function(b){if(b){var c=a.stack[a.currentPanelOffset].renderedNode;c&&(c.find(a.panelHeaderContentSelector).empty().append(b),B(a,c))}}).fail(function(){if(a.onOpened)a.onOpened();if(a.onRendered)a.onRendered();A(a)}))});m={};m[C]=a.stack.length-1;e.hashData(m)};a.loadingPanel?a.delayedOpen=
c:c()}function A(a,b){if(b&&b.all&&a.onCloseAll)a.onCloseAll();else if(0<a.currentPanelOffset){var c=a.stack[a.currentPanelOffset-1];c&&c.url&&(window.location=c.url)}else if(a.onCloseAll)a.onCloseAll()}function E(a,b,c){if(a){var d=a.stack[a.currentPanelOffset];if(d)return d.size=b,D(a,d.size,c)}}function D(a,b,c){if(a.onResize){b=a.onResize(b||"normal");a=a.stack[a.currentPanelOffset];if(!a)return b;a=a.renderedNode;if(!a)return b;a.width(b);return b}return null}function L(a,b,d){var l={"shell.closed":I.shellClosed,
"panel.unloaded":I.panelUnloaded,"panel.loaded":I.panelLoaded,"panel.shown":I.panelShown,"panel.hidden":I.panelHidden};if(l[b]!==c&&d!==c){var g=t(a,a.currentPanelOffset);f.subscribe(l[b],m(a),function(b){a.sleeping||(b.panelId?b.panelId===g&&d.call(u(a).get(0),b):d.call(u(a).get(0),b))})}}function B(a,b){var c=b.find(a.panelHeaderSelector).outerHeight(!0);b.find(a.panelContentSelector).css({top:c})}function G(a,b){if(a){var c=a.stack[a.currentPanelOffset].renderedNode;if(c&&b&&b.load){var d=b.load;
b.load=function(b){a.stack[a.currentPanelOffset].scrollablePageIndex=b;return d(b)};var l=c.find(a.panelContentSelector);if(b.immediate)n(l).on("scrollend",function(b){a.sleeping||(f.publish("contextual.panel.scrollend"),b.stopPropagation())});else a.scrollSubscription=f.subscribe(I.panelShown,m(a,!0,!1),function(b){if(!a.sleeping)n(l).on("scrollend",function(b){a.sleeping||(f.publish("contextual.panel.scrollend"),b.stopPropagation())})});b.initialPageIndex=a.stack[a.currentPanelOffset].scrollablePageIndex||
b.initialPageIndex||0;b.preFillAttempts=b.preFillAttempts||10;b.container=n(g);b.element=function(){return l};b.scrollEndMessage="contextual.panel.scrollend";b.buildIndicator=a.buildScrollingIndicator;return h.register("panel",b)}}}function J(a,b){b.on("click",".content-list.expandable .content-item",function(){var b=n(this);b.hasClass("expanded")||(b.closest(".content-list.expandable").find(".content-item.expanded").each(function(){var b=n(this);b.removeClass("expanded");b.find(".expandable").each(function(){var b=
n(this),c=b.css("display");b.css({display:"none",height:"auto"});var d=b.height();b.css({display:c,height:d}).evolutionTransform({height:0},{duration:a.transitionDuration/2.5,easing:a.transitionEasing})})}),b.addClass("expanded"),b.find(".expandable").each(function(){var b=n(this),c=b.css("display");b.css({display:"none",height:"auto"});var d=b.height();b.css({display:c,height:0}).evolutionTransform({height:d},{duration:a.transitionDuration/2.5,easing:a.transitionEasing,complete:function(){b.css({height:"auto"})}})}))})}
function M(a,b){b=n(b);b.data("_handlers_activated")||(b.data("_handlers_activated",!0),J(a,b))}function u(a){var b=a.stack[a.currentPanelOffset].renderedNode,c=b.data("_wrapper");c&&0!=c.length||(c=b.find(a.panelContentSelector),b.data("_wrapper",c));return c}var C="__cpo",F="ADMINISTRATION_SHELL",I={shellClosed:"context.shell.closed",panelLoaded:"administration.panel.loaded",panelUnloaded:"administration.panel.unloaded",panelShown:"administration.panel.shown",panelHidden:"administration.panel.hidden"},
K={container:null,panelNode:null,panelId:null,panelName:null,onRefresh:function(){},onOpening:function(){},onOpened:function(){},onRendering:function(){},onRendered:function(){},onCloseAll:function(){},onShow:function(){},onHide:function(){},onResize:function(a){},onAnimated:function(){},transitionEasing:"cubic-bezier(0.645, 0.045, 0.355, 1)",transitionDuration:300,template:"",panelContentSelector:".contextual-panel-content",panelHeaderSelector:".contextual-panel-heading",panelHeaderContentSelector:".custom-panel-heading-content",
excludeWhenResizingSelector:".contextual-administration-panel-loading"},O={__init:function(l){var p=n.extend({},K,l||{});currentContext=p;d(p);return{postInit:function(){q(p,I.panelLoaded,p.rootPanelNode);q(p,I.panelShown,p.rootPanelNode)},dispose:function(b){a(p,b)},processHashChange:function(){return b(p)},canProcessHashChange:function(){var a;a=0<=g.location.href.indexOf(p.rootUrl)?(a=e.hashData())&&a[C]!==c?parseInt(a[C],10)>p.stack.length-1?!1:!0:!0:!1;return a},sleep:function(){x(p);var a=p.stack[p.currentPanelOffset].renderedNode;
a&&q(p,I.panelHidden,a,{direction:"none"});p.suppressedNameSpaces=m(p,!0,!0);f.suppress(p.suppressedNameSpaces);p.sleeping=!0},wake:function(){p.suppressedNameSpaces&&f.unsuppress(p.suppressedNameSpaces);p.sleeping=!1;p.suppressedNameSpaces=[];var a=p.stack[p.currentPanelOffset].renderedNode;a&&q(p,I.panelShown,a)},sleeping:function(){return p.sleeping},currentPanelNode:function(){if(!p||!p.stack||0==p.stack.length)return null;var a=p.stack[p.currentPanelOffset];return a?a.renderedNode:null},currentPanelDetails:function(){if(!p||
!p.stack||0==p.stack.length)return null;var a=p.stack[p.currentPanelOffset];return a?a:null},context:function(a){a&&(currentContext=a);return currentContext}}},open:function(a){if(null!==currentContext)return z(currentContext,a)},close:function(a){if(null!==currentContext)return A(currentContext,a)},refresh:function(){if(null!==currentContext&&currentContext.onRefresh)currentContext.onRefresh()},scrollable:function(a){if(null!==currentContext)return G(currentContext,a)},panelId:function(){if(null!==
currentContext)return t(currentContext,currentContext.currentPanelOffset)},panelWrapper:function(){return null===currentContext?n([]):u(currentContext)},panelNameSpace:function(){if(null!==currentContext)return m(currentContext)},header:function(a,b){if(null!==currentContext){var c=currentContext,d=b||{},l=c.stack[c.currentPanelOffset].renderedNode;d&&!1===d.inherit&&l.find(c.panelHeaderTitleSelector).hide();a?l&&(l.find(c.panelHeaderContentSelector).empty().append(a),B(c,l)):B(c,l);return l.find(c.panelHeaderContentSelector)}},
sidebar:function(a){if(null!==currentContext)return n.Deferred(function(b){currentContext.onSideBar&&(a&&a.content)&&(currentContext.onSideBar(a.content).done(function(){b.resolve()}),f.subscribe(I.panelUnloaded,m(currentContext),function(a){if(!currentContext.sleeping)currentContext.onSideBar("")}))}).promise()},on:function(a,b){if(null!==currentContext)return L(currentContext,a,b)},show:function(){if(null!==currentContext&&currentContext.onShow)currentContext.onShow()},hide:function(){if(null!==
currentContext&&currentContext.onHide)currentContext.onHide()},size:function(a){null!==currentContext&&E(currentContext,a,!0)},loading:function(a){if(null!==currentContext)if(a){if(currentContext.onOpening)currentContext.onOpening()}else if(currentContext.onOpened)currentContext.onOpened()}};n.telligent=n.telligent||{};n.telligent.evolution=n.telligent.evolution||{};return n.telligent.evolution.administration=O},jQuery,window);u("module.administrationContextManager",["module.administration","module.messaging",
"module.url","lib.util","lib.scrollable"],function(f,e,k,h,n,g,c,d){function a(a){return a.contexts[a.contexts.length-1]}var b={onTitle:function(){},onRefresh:function(){},onOpening:function(){},onOpened:function(){},onRendering:function(){},onRendered:function(){},onCloseAll:function(){},onResize:function(a){},onShow:function(){},onHide:function(){},onAnimated:function(){},onDispose:function(){},onSideBar:function(a){},buildScrollingIndicator:function(){},transitionEasing:"cubic-bezier(0.645, 0.045, 0.355, 1)",
transitionDuration:300,template:"",panelContentSelector:".contextual-panel-content",panelHeaderSelector:".contextual-panel-heading",panelHeaderTitleSelector:".administration-panel-heading-meta",panelHeaderContentSelector:".custom-panel-heading-content",excludeWhenResizingSelector:".contextual-administration-panel-loading"},p={container:null,panelNode:null,panelId:null,panelName:null};e=function(d){var e=g.extend({},b,d||{},{contexts:[]});return{addContext:function(b){var d=a(e);null!=d&&d.sleep();
b=g.extend({},p,b||{});var m=b.onCloseAll||e.onCloseAll||function(){};b.onCloseAll=function(){if(1<e.contexts.length){var a=e.contexts[e.contexts.length-2].currentPanelDetails();a&&a.url?c.location.href=a.url:m()}else m()};d=f.__init(g.extend({},e,b));d.panelNode=b.panelNode;d.panelRequest=b.panelRequest;d.innerContext=d.context();e.contexts.push(d)},canProcessHash:function(a){for(var b=e.contexts.length-1;0<=b;b--)if(e.contexts[b].canProcessHashChange(a))return!0;return!1},processHash:function(a){for(var b=
e.contexts.length-1;0<=b;b--){if(e.contexts[b].canProcessHashChange(a))return e.contexts[b].sleeping()&&(e.onNavigateBackToPreviousContext(e.contexts[b].currentPanelNode(),{onRendering:e.onRendering,onRendered:e.onRendered}),e.contexts[b].context(e.contexts[b].innerContext),e.contexts[b].wake()),e.contexts[b].processHashChange(a),!0;e.contexts[b].sleeping()&&e.contexts[b].wake();e.contexts[b].dispose({refreshing:!0});e.contexts[b].sleep();e.contexts.pop()}return!1},postInit:function(){var b=a(e);
null!=b&&b.postInit()},dispose:function(b){if(b&&b.all)for(var c=e.contexts.length-1;0<=c;c--)e.contexts[c].dispose(b),e.contexts.pop();else c=a(e),null!=c&&(c.dispose(b),e.contexts.pop())},count:function(){return e.contexts.length},currentPanelNode:function(){var b=a(e);return b?b.currentPanelNode():null},currentPanelRequest:function(){var b=a(e);return b?b.panelRequest:null},currentPanelDetails:function(){var b=a(e);return b?b.currentPanelDetails():null},previousPanelDetails:function(){if(1>=e.contexts.length)return null;
var a=e.contexts[e.contexts.length-2];return a?a.currentPanelDetails():null}}};return f.__contextManager=e},jQuery,window);u("module.emailDigest",function(f,e,k){f.telligent||(f.telligent={});f.telligent.evolution||(f.telligent.evolution={});var h=function(e,g){0>g||(0<g&&""!=e.subscriptionId&&(""==e.context||"undefined"===e.contextId)?_showMessage(e,e.errorMessage):f.telligent.evolution.post({url:e.emailDigestUrl,data:{subscriptionId:e.subscriptionId,frequency:g,context:e.context,contextId:e.contextId},
success:function(c){c=eval("("+c+")");var d=null;"create"==c.action?(e.subscriptionId=c.subscriptionId,e.frequency=g,1==g?d=e.dailyMessage:7==g&&(d=e.weeklyMessage)):"update"==c.action?(e.frequency=g,1==g?d=e.dailyMessage:7==g&&(d=e.weeklyMessage)):"delete"==c.action&&(e.subscriptionId="",e.frequency=0,"group"==e.context&&(d=e.unsubscribeGroupMessage));c.warnings&&0<c.warnings.length?_showMessage(e,c.warnings[0],"warning"):d&&_showMessage(e,d,"success");c={subscriptionId:e.subscriptionId,frequency:e.frequency,
context:e.context,contextId:e.contextId,action:c.action};f(document).trigger("emailDigestSubscriptionChange",[c])},error:function(c,d,a){_showMessage(e,e.errorMessage,"error")}}))};_showMessage=function(e,g,c){f.telligent.evolution.notifications.show(g,{type:c,duration:5E3})};f.telligent.evolution.emailDigest={register:function(e){f("#"+e.selectPopupId).glowPopUpPanel({cssClass:"Panel",position:"updown",zIndex:100,hideOnDocumentClick:!0});f("#"+e.rollupWrapperId).click(function(){var g=f(this),c=
"",d="",a="";1==e.frequency?c="email-digest-selected":7==e.frequency?d="email-digest-selected":a="email-digest-selected";var b=g.outerWidth(),p=g.outerHeight(),g=g.offset(),c="<div class='email-digest-selectWrapper' style=\"min-width: "+(b-2)+'px;"><div frequency="1" class="email-digest-selectable '+e.selectableTag+" "+c+'"><span style="display: block; white-space: nowrap;">'+e.popupDaily+'</span></div><div frequency="7" class="email-digest-selectable '+e.selectableTag+" "+d+'"><span style="display: block; white-space: nowrap;">'+
e.popupWeekly+'</span></div><div frequency="0" class="email-digest-selectable '+e.selectableTag+" "+a+'"><span style="display: block; white-space: nowrap;">'+e.popupUnsubscribe+"</span></div></div>";f("#"+e.selectPopupId).glowPopUpPanel("hide").glowPopUpPanel("html",c).glowPopUpPanel("show",g.left+4,g.top+5,b,p-10,!1)});f("."+e.selectableTag).live("click",function(){var g=f(this);g.hasClass("email-digest-selected")||(g=g.attr("frequency"),h(e,g))});f(document).bind("emailDigestSubscriptionChange",
function(g,c){if(c.context==e.context&&c.contextId==e.contextId){var d="";"create"==c.action||"update"==c.action?("1"==c.frequency?d=e.rollupDaily:"7"==c.frequency&&(d=e.rollupWeekly),e.subscriptionId=c.subscriptionId):(d=e.rollupUnsubscribed,e.subscriptionId="");e.frequency=c.frequency;f("#"+e.rollupTextId).html(d)}})}};return{}},jQuery,window);u("module.administrationToolbar",function(f,e,k){f.telligent||(f.telligent={});f.telligent.evolution||(f.telligent.evolution={});f.telligent.evolution.administrationToolbar=
{get:function(){var e;e=f(".admin-bar");0<e.length||(e=f("form"),1<e.length&&(e=f("body")),e.prepend(f('<div class="admin-bar-header"></div><div class="admin-bar site"></div><div class="admin-bar-footer"></div>')),e=f(".admin-bar"));return e}};return{}},jQuery,window);u("module.configuration",["lib.globalConfiguration"],function(f,e,k,h){var n=e.fn.filter;e.fn.filter=function(){arguments&&(0<arguments.length&&"string"==typeof arguments[0])&&(arguments[0]=arguments[0].replace(/:\[/g,"["));return n.apply(this,
arguments)};document.cookie=".te.dpr="+(Math.round(window.devicePixelRatio||1)||1);h={formatDate:function(e){try{return e.toISOString()}catch(c){}return""},parseDate:function(){var e=function(c,d){var a;a=c.getTimezoneOffset();var b;isNaN(d)?a=new Date(c.getTime()-6E4*a):(b=d/100,b=-(60*(b-b%1)+d%100),a=new Date(c.getTime()+6E4*(b-a)));return a};return function(c){var d,a=new Date;if(null===c||""===c)return a;if(null!=(d=/\/Date\((\d+)(?:([\-\+]\d+))?\)\//.exec(c)))return c=new Date(parseInt(d[1],
10)),e(c,parseInt(d[2],10));if(null!=(d=/(\d{4,4})\-(\d{2,2})\-(\d{2,2})(?:T(\d{2,2}):(\d{2,2}):(?:(\d{2,2})(?:\.(\d+))?))([zZ]|([+\-])(((\d\d):(\d\d))|(\d\d\d\d)))?/.exec(c))){c=[a.getFullYear(),a.getMonth()+1,a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()];for(a=1;a<d.length&&8>a;a++)""!=d[a]&&void 0!=d[a]&&(c[a-1]=parseInt(d[a],10));c=new Date(c[0],c[1]-1,c[2],c[3],c[4],c[5],1E3*parseFloat("."+c[6]));if(d[8]){if("z"==d[8]||"Z"==d[8])return e(c,0);if(d[9]&&d[12]&&d[13])return d=
(100*parseInt(d[12],10)+parseInt(d[13],10))*("+"==d[9]?1:-1),e(c,d);if(d[9]&&d[10])return d=(100*parseInt(d[10].substring(0,2),10)+parseInt(d[10].substring(2),10))*("+"==d[9]?1:-1),e(c,d)}else return c}throw"Invalid date format";}}(),formatAgoDate:function(e){try{var c=(new Date).getTime(),d=Math.abs(c-e.getTime())/1E3,a=d/60,b=a/60,p=b/24,m=p/30.42,q=p/365;return c<e.getTime()?2>Math.round(a)?f.dateMinuteInFutureFormat.replace("{0}",Math.round(a)):60>Math.round(a)?f.dateMinutesInFutureFormat.replace("{0}",
Math.round(a)):2>Math.round(b)?f.dateHourInFutureFormat.replace("{0}",Math.round(b)):24>Math.round(b)?f.dateHoursInFutureFormat.replace("{0}",Math.round(b)):2>Math.round(p)?f.dateDayInFutureFormat.replace("{0}",Math.round(p)):30.42>p?f.dateDaysInFutureFormat.replace("{0}",Math.round(p)):2>Math.round(m)?f.dateMonthInFutureFormat.replace("{0}",Math.round(m)):12>m?f.dateMonthsInFutureFormat.replace("{0}",Math.round(m)):2>Math.round(q)?f.dateYearInFutureFormat.replace("{0}",Math.round(q)):f.dateYearsInFutureFormat.replace("{0}",
Math.round(q)):10>d?f.dateNowAgoFormat:2>Math.round(a)?f.dateMinuteAgoFormat.replace("{0}",Math.round(a)):60>Math.round(a)?f.dateMinutesAgoFormat.replace("{0}",Math.round(a)):2>Math.round(b)?f.dateHourAgoFormat.replace("{0}",Math.round(b)):24>Math.round(b)?f.dateHoursAgoFormat.replace("{0}",Math.round(b)):2>Math.round(p)?f.dateDayAgoFormat.replace("{0}",Math.round(p)):30.42>p?f.dateDaysAgoFormat.replace("{0}",Math.round(p)):2>Math.round(m)?f.dateMonthAgoFormat.replace("{0}",Math.round(m)):12>m?f.dateMonthsAgoFormat.replace("{0}",
Math.round(m)):2>Math.round(q)?f.dateYearAgoFormat.replace("{0}",Math.round(q)):f.dateYearsAgoFormat.replace("{0}",Math.round(q))}catch(t){}return""},site:{configure:function(g){e.extend(f,g);e.telligent.evolution.user={accessing:{id:f.accessingUserId,isSystemAccount:f.accessingUserIsSystemAccount,isTemporary:f.accessingUserTemporary}};e.extend(e.event.special.quote.defaults,{quoteText:f.quoteText});e.fn.glowDateTimeSelector&&(e.extend(e.fn.glowDateTimeSelector.defaults,{monthNames:f.monthNames,dayNames:f.dayNames,
calendarButtonImageUrl:e.telligent.evolution.site.getBaseUrl()+"utility/images/glow/DateTimeSelectorCalendar.gif"}),e.extend(e.fn.glowDateTimeSelector.dateDefaults,{monthNames:f.monthNames,dayNames:f.dayNames,calendarButtonImageUrl:e.telligent.evolution.site.getBaseUrl()+"utility/images/glow/DateTimeSelectorCalendar.gif"},f.datePattern||{}),e.extend(e.fn.glowDateTimeSelector.timeDefaults,{monthNames:f.monthNames,dayNames:f.dayNames,calendarButtonImageUrl:e.telligent.evolution.site.getBaseUrl()+"utility/images/glow/DateTimeSelectorCalendar.gif"},
f.timePattern||{}),e.extend(e.fn.glowDateTimeSelector.dateTimeDefaults,{monthNames:f.monthNames,dayNames:f.dayNames,calendarButtonImageUrl:e.telligent.evolution.site.getBaseUrl()+"utility/images/glow/DateTimeSelectorCalendar.gif"},f.dateTimePattern||{}),e.extend(e.fn.glowDateTimeSelector.monthDefaults,{monthNames:f.monthNames,dayNames:f.dayNames,calendarButtonImageUrl:e.telligent.evolution.site.getBaseUrl()+"utility/images/glow/DateTimeSelectorCalendar.gif"}));e.glowModal&&(e.extend(e.glowModal.defaults,
{loadingHtmlUrl:"about:blank",windowCssClasses:["modal"],windowTitleCssClasses:["modal-title","modal-title-2","modal-title-3","modal-title-4"],windowCloseCssClasses:["modal-close"],windowContentCssClasses:["modal-content","modal-content-2"],windowMaskCssClasses:["modal-mask"],windowFooterCssClasses:["modal-footer","modal-footer-2","modal-footer-3"],windowResizeCssClasses:["modal-resize"],zIndex:2E4}),k.Telligent_Modal={GetWindowOpener:function(c,d){return e.glowModal.opener(c,d)},IsShown:function(c){return e.glowModal.visible(c)},
Resize:function(c,d,a,b){e.glowModal.resize(c,d,a,b)},MoveTo:function(c,d,a){e.glowModal.moveTo(c,d,a)},Open:function(c,d,a,b,g,m,f,t,l){e.glowModal(c,{width:d,height:a,onClose:b,x:g,y:m,ignoreCloseAndAnimation:f,isManuallyresized:t,openerWindow:l})},Close:function(c,d){e.glowModal.close(c,d)},Refresh:function(c){e.glowModal.refresh(c)}});e.fn.glowDropDownList&&e.extend(e.fn.glowDropDownList.defaults,{buttonImageUrl:e.telligent.evolution.site.getBaseUrl()+"utility/images/glow/DropDownListButton.gif"});
e.fn.glowColorSelector&&e.extend(e.fn.glowColorSelector.defaults,{blendImageUrl:e.telligent.evolution.site.getBaseUrl()+"utility/images/glow/ColorSelectorSv.png",hueBlendImageUrl:e.telligent.evolution.site.getBaseUrl()+"utility/images/glow/ColorSelectorHue.png"});e.fn.glowMultiUpload&&e.extend(e.fn.glowMultiUpload.defaults,{swfUrl:e.telligent.evolution.site.getBaseUrl()+"utility/images/glow/Moxie.swf",silverlightUrl:f.silverlightFileUploadEnabled?e.telligent.evolution.site.getBaseUrl()+"utility/images/glow/Moxie.xap":
"",runtimes:f.silverlightFileUploadEnabled?"html5,silverlight,flash":"html5,flash"});e.fn.glowUpload&&e.extend(e.fn.glowUpload.defaults,{swfUrl:e.telligent.evolution.site.getBaseUrl()+"utility/images/glow/Moxie.swf",silverlightUrl:f.silverlightFileUploadEnabled?e.telligent.evolution.site.getBaseUrl()+"utility/images/glow/Moxie.xap":"",runtimes:f.silverlightFileUploadEnabled?"html5,silverlight,flash":"html5,flash"})},getBaseUrl:function(e){if(!0===e){e=k.location.href+"";var c=e.indexOf("/",9);if(0<
c)return e.substr(0,c)+f.baseUrl}return f.baseUrl}},theme:{getReflowBreakpoint:function(){return f.reflowBreakpoint}}};e.telligent=e.telligent||{};e.telligent.evolution=e.telligent.evolution||{};e.extend(e.telligent.evolution,h);return{}},jQuery,window);u("module.editableGroup",function(f,e,k){f.telligent||(f.telligent={});f.telligent.evolution||(f.telligent.evolution={});var h={},n=function(a,b,c){if(a.isSaving)if(b+1<a.widgets.length){var d=a.widgets[b+1];d.save?(d=d.save(function(){n(a,b+1,c)},
function(){g(a,b+1,c)}),!1===d?g(a,b+1,c):!0===d&&n(a,b+1,c)):n(a,b+1,c)}else c.success&&(a.isSaving=!1,c.success())},g=function(a,b,c){a.isSaving&&(a.isSaving=!1,c.error&&c.error())},c=function(a,b,c){if(a.isValidating){a.widgets[b].valid=!0;var d=0;f.each(a.widgets,function(a,b){!0!==b.valid&&d++});0==d&&(a.isValidating=!1,c.success&&c.success())}},d=function(a,b,c){a.isValidating&&(a.widgets[b].valid=!1,a.isValidating=!1,c.error&&c.error())};f.telligent.evolution.editableGroup={register:function(a,
b){var c=h[a];c||(c={widgets:[],isSaving:!1,isValidating:!1},h[a]=c);c.widgets[c.widgets.length]=f.extend({},b||{},{valid:!1,saved:!1})},save:function(a,b){f.telligent.evolution.editableGroup.validate(a,{success:function(){var c=h[a];c&&0<c.widgets.length?(c.isSaving=!0,n(c,-1,b)):b&&b.success&&b.success()},error:function(){b.error&&b.error()}})},validate:function(a,b){var e=h[a];e&&0<e.widgets.length?(f.each(e.widgets,function(a,b){b.valid=k}),e.isValidating=!0,f.each(e.widgets,function(a,g){if(g.validate){var t=
g.validate(function(){c(e,a,b)},function(){d(e,a,b)});!1===t?d(e,a,b):!0===t&&c(e,a,b)}else c(e,a,b)})):b&&b.success&&b.success()}};return{}},jQuery,window);u("module.html",["lib.util"],function(f,e,k,h){var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"};k={encode:function(e){var c=f.compileReplacer(n);return function(d){return c.call(this,d)}}(),decode:function(g){var c=/<[^>]*>/g;return function(d){if(!d)return d;d=(d+"").replace(c," ");return e("<div/>").html(d).text()}}()};
e.telligent||(e.telligent={});e.telligent.evolution||(e.telligent.evolution={});return e.telligent.evolution.html=k},jQuery,window);u("module.javaScript",["lib.util"],function(f,e,k,h){var n={"\\":"\\\\","\n":"\\n","\r":"\\r","'":"\\'",'"':'\\"',"/":"\\/"};k={encode:function(e){var c=f.compileReplacer(n);return function(d){return c.call(this,d)}}()};e.telligent||(e.telligent={});e.telligent.evolution||(e.telligent.evolution={});return e.telligent.evolution.javaScript=k},jQuery,window);u("module.language",
function(f,e,k){var h={},n={};agoLastRefresh=(new Date).getTime();buildCacheKey=function(c,d){return c.toString()+"-"+d};loadFormattedDate=function(c,d,a){var b=h;"agodate"==d&&(6E4<(new Date).getTime()-agoLastRefresh&&(n={},agoLastRefresh=(new Date).getTime()),b=n);var e=b[buildCacheKey(c,d)];"undefined"===typeof e?f.telligent.evolution.get({url:g.defaults.dateEndpoint,data:{date:f.telligent.evolution.formatDate(c),format:d},success:function(e){e&&(a&&"undefined"!==typeof e&&null!==e&&e.formattedDate)&&
(b[buildCacheKey(c,d)]=e.formattedDate,a(e.formattedDate))}}):a(e)};var g={formatDate:function(c,d){loadFormattedDate(c,"date",d)},formatDateAndTime:function(c,d){loadFormattedDate(c,"datetime",d)},formatAgoDate:function(c,d){loadFormattedDate(c,"agodate",d)},defaults:{dateEndpoint:""}};f.telligent||(f.telligent={});f.telligent.evolution||(f.telligent.evolution={});f.telligent.evolution.language=g;return{}},jQuery,window);u("module.maxlength",function(f,e,k){return{shim:function(){f("textarea[maxlength]").live("keyup change",
function(){var e=f(this),k=e.attr("maxlength"),g=e.val();g.length>k&&e.val(g.substr(0,k))})}}},jQuery,window);u("module.media",function(f,e,k){var h=function(e,c,d){var a=f.extend({},n.defaults,d||{});e={url:e,view:c};a.width&&(e.width=a.width);a.height&&(e.height=a.height);f.telligent.evolution.get({url:a.endpoint,data:e,success:function(b){b&&a.success&&a.success(b)},error:function(b,c,d){a.error&&a.error(b,c,d)}})},n={previewHtml:function(e,c){h(e,"preview",c)},viewHtml:function(e,c){h(e,"view",
c)},defaults:{endpoint:""}};f.telligent||(f.telligent={});f.telligent.evolution||(f.telligent.evolution={});f.telligent.evolution.media=n;return{}},jQuery,window);u("module.messaging",["lib.util","lib.crossWindowBus"],function(f,e,k,h,n){function g(a,b){var c=p[a];if(c)for(var c=c.slice(),d=0;d<c.length;d++)if(c[d]&&c[d].handler&&(c[d].suppressed===n||!c[d].suppressed))try{c[d].handler.call(this,b)}catch(e){}}function c(a){"undefined"!==typeof m[String(a)]&&(m[String(a)].suppressed=!0)}function d(a){"undefined"!==
typeof m[String(a)]&&(m[String(a)].suppressed=!1)}function a(a,b){if("undefined"!==typeof m[String(a)]){var c=m[String(a)],d=p[c.message];subscriptionByNameIndex=f.indexOf(d,c);0<=subscriptionByNameIndex&&d.splice(subscriptionByNameIndex,1);0===d.length&&delete p[c.message];for(d=0;d<c.namespaces.length;d++)if(b!==c.namespaces[d]){var e=q[c.namespaces[d]],g=f.indexOf(e,a);0<=g&&e.splice(g,1);0===e.length&&delete q[c.namespaces[d]]}delete m[String(a)]}}var b=0,p={},m={},q={},t=new e({key:"__m",includeLocal:!1,
receive:g});e={publish:function(a,b,c){if(!a)throw"messageName is required when publishing a message";null!==a&&0!==a.length&&(b=b||{},c&&!0===c.crossWindow&&t.broadcast(a,b),g(a,b))},subscribe:function(a,c,d){if(!a)throw"messageName is required when subscribing to a message";if(null===a||0===a.length)return 0;"undefined"===typeof p[a]&&(p[a]=[]);var e=c;d==n&&(d=c,e="content");f.isArray(e)||(e=[e]);c={message:a,handler:d,namespaces:e,id:++b};p[a][p[a].length]=c;m[String(c.id)]=c;for(a=0;a<e.length;a++)q[e[a]]||
(q[e[a]]=[]),q[e[a]][q[e[a]].length]=c.id;return c.id},unsubscribe:function(b){if(!b)throw"subscriptionId is required when unsubscribing a message";if(isNaN(b)){if(b&&q[b]){for(var c=0;c<q[b].length;c++)a(q[b][c],b);q[b].length=0;delete q[b]}}else a(b)},suppress:function(a){if(!a)throw"subscriptionId is required when suppressing a message";if(isNaN(a)){if(a)for(messageNamespaces=a,f.isArray(messageNamespaces)||(messageNamespaces=[messageNamespaces]),a=0;a<messageNamespaces.length;a++)if(q[messageNamespaces[a]])for(var b=
0;b<q[messageNamespaces[a]].length;b++)c(q[messageNamespaces[a]][b],messageNamespaces[a])}else c(a)},unsuppress:function(a){if(!a)throw"subscriptionId is required when unsuppressing a message";if(isNaN(a)){if(a)for(messageNamespaces=a,f.isArray(messageNamespaces)||(messageNamespaces=[messageNamespaces]),a=0;a<messageNamespaces.length;a++)if(q[messageNamespaces[a]])for(var b=0;b<q[messageNamespaces[a]].length;b++)d(q[messageNamespaces[a]][b],messageNamespaces[a])}else d(a)}};k.telligent||(k.telligent=
{});k.telligent.evolution||(k.telligent.evolution={});return k.telligent.evolution.messaging=e},jQuery,window);u("module.navigationConfirmation",function(f,e,k){f.telligent||(f.telligent={});f.telligent.evolution||(f.telligent.evolution={});var h={message:"",enabled:!1,ignoreClick:!1},n=function(){if(!h.ignoreClick)return h.message};f.telligent.evolution.navigationConfirmation={configure:function(e){h=f.extend(h,e)},enable:function(){h.enabled||(window.onbeforeunload=n,h.enabled=!0,f(document).bind("customizepage",
function(){h.ignoreClick=!0}))},register:function(e){f(e).click(function(){h.ignoreClick=!0})},ignoreClick:function(){h.ignoreClick=!0}};return{}},jQuery,window);u("module.notifications","lib.util lib.storageProxy module.messaging module.sockets.sharedObjectProxyState lib.globalConfiguration module.rest".split(" "),function(f,e,k,h,n,g,c,d,a){function b(){if(S){var a="",e="undefined"!=typeof InstallTrigger||!!window.opera||0<=navigator.userAgent.indexOf("Opera");if(K&&!T)if(O=c('head link[rel~="icon"][href]').first(),
0<O.length){T=O.attr("href");U=O.attr("type");try{N=document.createElement("canvas"),R=document.createElement("img"),R.onload=function(){N.height=0<R.height?R.height:32;N.width=0<R.width?R.width:32;H=N.getContext("2d")},c(R).attr({crossOrigin:"anonymous",src:T})}catch(l){K=!1}}else K=!1;if(K)if(H)try{H.clearRect(0,0,N.width,N.height);H.drawImage(R,0,0,N.width,N.height);if(F){if(0<M||0<G)a=Math.max(M,G),99<a&&(a="99+")}else 0<G?(a=G,99<a&&(a="99+")):0<M&&(a="+");if(0===a||""===a)if(e){var g=c('<link type="'+
U+'" rel="icon"></link>');c("head").append(g);g.attr("href",T);O.remove();O=g}else O.attr({href:T,type:U});else{var a=a+"",p=!1,m=0.4*N.width,t=0.4*N.height,f=0.6*N.width,q=0.6*N.height;2===a.length?(m-=0.4*f,f*=1.4,p=!0):3<=a.length&&(m-=0.65*f,f*=1.65,p=!0);H.beginPath();H.font="bold "+Math.floor(q*(2<a.length?0.85:1))+"px sans-serif";H.textAlign="center";p?(H.moveTo(m+f/2,t),H.lineTo(m+f-q/2,t),H.quadraticCurveTo(m+f,t,m+f,t+q/2),H.lineTo(m+f,t+q-q/2),H.quadraticCurveTo(m+f,t+q,m+f-q/2,t+q),H.lineTo(m+
q/2,t+q),H.quadraticCurveTo(m,t+q,m,t+q-q/2),H.lineTo(m,t+q/2),H.quadraticCurveTo(m,t,m+q/2,t)):H.arc(m+f/2,t+q/2,q/2,0,2*Math.PI);H.fillStyle="rgba(221,0,0,1)";H.fill();H.closePath();H.beginPath();H.stroke();H.fillStyle="rgba(255,255,255,1)";H.fillText(a,Math.floor(m+f/2),Math.floor(t+q-0.15*q));H.closePath();e?(g=c('<link type="image/png" rel="icon"></link>'),c("head").append(g),g.attr("href",N.toDataURL("image/png")),O.remove(),O=g):O.attr({href:N.toDataURL("image/png"),type:"image/png"})}}catch(r){K=
!1}else d.clearTimeout(V),V=d.setTimeout(function(){b()},250)}}function p(){if(S){var a=document.title.replace(C,"")+"",b=0;if(F){if(0<M||0<G)b=Math.max(M,G),99<b&&(b="99+"),a="("+b+") "+a}else 0<G?(b=G,99<b&&(b="99+"),a="("+b+") "+a):0<M&&(a="(+) "+a);document.title=a}}function m(a,d,e){var l=0;a+="";if("+"==a.substr(0,1)){l=parseInt(a.substr(1),10);if(isNaN(l))return;d?J[e]=(J[e]||0)+l:u[e]=(u[e]||0)+l}else if("-"==a.substr(0,1)){l=parseInt(a.substr(1),10);if(isNaN(l))return;d?J[e]=(J[e]||0)-l:
u[e]=(u[e]||0)-l}else{l=parseInt(a,10);if(isNaN(l))return;d?J[e]=l:u[e]=l}G=0;c.each(J,function(a,b){0>b&&(J[a]=b=0);G+=b});M=0;c.each(u,function(a,b){0>b&&(u[a]=b=0);M+=b});k.publish("notification.unreadchange",{local:G,global:M});p();b()}function q(){d.clearTimeout(I);var a=!h.hasMultipleWindows();F!=a&&(F=a,p(),b());I=d.setTimeout(function(){q()},1E3)}function t(){c.telligent.evolution.user&&(c.telligent.evolution.user.accessing&&!c.telligent.evolution.user.accessing.isSystemAccount&&!c.telligent.evolution.user.accessing.isTemporary)&&
(d.clearTimeout(Z),Z=d.setTimeout(function(){g.get({url:n.baseUrl+"api.ashx/v2/notifications.json",cache:!1,data:{IsRead:!1,PageSize:1,PageIndex:0}}).then(function(a){m(a.TotalCount,!1,"notifications")})},1E3))}function l(a){var b=c.extend({},W.defaults,a||{},{removalSuppressed:!1,notifications:[]});b.verticalAlignment="bottom";0<=b.placement.indexOf("top")&&(b.verticalAlignment="top");b.horizontalAlignment="left";0<=b.placement.indexOf("right")&&(b.horizontalAlignment="right");b.storage=new e({id:c.telligent.evolution.user.accessing.id,
isSystemAccount:c.telligent.evolution.user.accessing.isSystemAccount});b.template=c.telligent.evolution.template.compile(b.template);d.top==d&&((a=b.storage.get(B))&&9E4>(new Date).getTime()-a.updated&&c.each(a.notifications,function(a,c){var d=v(b,c.message,c);E(b,s(b,d))}),b.storage.del(B));return b}function w(a){var b=c.extend({},{updated:(new Date).getTime(),notifications:[]},Q.storage.get(B)||{});c.each(a.notifications,function(a,c){var d=c.duration,e=r(c);c.shownTime&&(d-=b.updated-c.shownTime);
1<d&&!(e&&c.shownTime&&!(2>b.updated-c.shownTime)||c&&Y&&!0===Y[c.id])&&b.notifications.unshift({duration:e?Math.min(d,W.show.defaults.duration):d,width:c.width,type:c.type,cssClass:c.cssClass,id:c.id,message:c.message})});0==b.notifications.length?a.storage.del(B):a.storage.set(B,b)}function r(a){return a&&(a.type&&"error"==a.type||a.cssClass&&"error"==a.cssClass)}function v(a,b,d){d&&(!d.duration&&r(d))&&(d.duration=a.errorDuration);a=c.extend({},W.show.defaults,d||{});a.message=b;a.cssClass=a.type||
"";a.id||(a.id=f.guid());return a}function s(a,b){var d=c.grep(a.notifications,function(a){return a.id===b.id});if(null!==d&&1===d.length)return d=d[0],x(a,d,!0).then(function(){d.view.remove();d.message=b.message;d.cssClass=b.cssClass;d.duration=b.duration;D(a,d);d.suppressPositionAnimation=!0;y(a);z(a,d,!0);L(a,d)}),d;a.notifications.length===a.limit&&A(a,a.notifications[a.notifications.length-1]);a.notifications.unshift(b);D(a,b);y(a);z(a,b);L(a,b);return b}function y(a){var b=a.margin,d=0<c.grep(a.notifications,
function(a){!0===a.suppressPositionAnimation}).length;c.each(a.notifications,function(c,e){if(d){var l={opacity:0};l[a.verticalAlignment]=b+"px";e.view.css(l);e.suppressPositionAnimation=!1}else l={},l[a.verticalAlignment]=b,e.view.evolutionTransform(l,{duration:a.animationDuration});0<e.measuredHeight&&(b+=e.measuredHeight+a.margin)})}function x(a,b,d){b.onHide&&b.onHide.apply(b);return c.Deferred(function(c){!0!==d?b.view.evolutionTransform({opacity:0},{duration:a.animationDuration,complete:function(){b.view.css({display:"none"});
c.resolve()}}):c.resolve()}).promise()}function z(a,b,d){c("body").addClass("with-notifications");b.onShow&&b.onShow.apply(b);return c.Deferred(function(c){!0!==d?(b.view.is(":visible")||b.view.css({display:"block",opacity:0}),b.view.evolutionTransform({opacity:a.opacity},{duration:a.animationDuration,complete:function(){c.resolve()}})):(b.view.css({display:"block",opacity:a.opacity}),c.resolve())}).promise()}function A(a,b){b.removing=!0;x(a,b).then(function(){b.view.remove();b.measuredHeight=0;
a.notifications=c.grep(a.notifications,function(a){return a!==b});y(a);a.notifications&&0!==a.notifications.length||c("body").removeClass("with-notifications")})}function E(a,b){d.clearTimeout(b.removeTimeout);d.clearInterval(b.hideSupressedWaitInterval);b.hideSupressedWaitInterval=d.setTimeout(function(){a.removalSuppressed?b.hideSupressedWaitInterval=d.setInterval(function(){a.removalSuppressed||(d.clearInterval(b.hideSupressedWaitInterval),A(a,b))},1E3):A(a,b)},b.duration);b.shownTime=(new Date).getTime()}
function D(a,b){var d={position:"fixed",zIndex:1E4,width:b.width};d[a.horizontalAlignment]=a.margin+a.horizontalOffset+"px";d[a.verticalAlignment]=a.margin+a.verticalOffset+"px";b.active=!!b.onClick;b.view=c(a.template(b)).css(d).hide().appendTo(a.parent);b.measuredHeight=b.view.outerHeight()}function L(a,b){b.view.find("a.close").on("click",function(c){c.preventDefault();c.stopPropagation();b.onClose?(c=b.onClose.apply(b))?c.then(function(){A(a,b)}):A(a,b):A(a,b)});b.view.on("click",function(){b.onClick&&
b.onClick.apply(b)});b.view.on("mouseenter",function(){a.entered=!0;a.removalSuppressed=!0;b.removing&&(b.view.stop(),b.removing=!1,z(a,b),y(a),E(a,b));b.onOver&&b.onOver.apply(b)});b.view.on("mouseleave",function(){a.entered=!1;d.setTimeout(function(){a.entered||(a.removalSuppressed=!1)},500);b.onOut&&b.onOut.apply(b)})}var B="notifications",G=0,J={},M=0,u={},C=/^(\([0-9\+]+\)\s+)+/,F=!0,I=null,K=!0,O=null,T=null,U=null,R=null,N=null,H=null,V=null,S=!d.parent||d.parent==d,Y={__disconnect_notification:!0,
__systemnotification:!0};c(document).ready(function(){S=S&&!c("body").hasClass("administration")});var Z=null,Q,W={show:function(a,b){Q||(Q=l());var c=v(Q,a,b);E(Q,s(Q,c));return c.id},hide:function(a){if(Q&&a)if(c.isFunction(a))c.each(Q.notifications,function(a,b){A(Q,b)}),a();else{var b=c.grep(Q.notifications,function(b){return b.id===a});b&&0!=b.length&&A(Q,b[0])}},unread:function(a,b){if(void 0===a)return{local:G,global:M};b=b||{};m(a,!0===b.isLocal,b.namespace||"unknown")}};c(document).ready(function(){d.setTimeout(function(){Q||
(Q=l())},500)});c(window).on("unload",function(){Q&&w(Q)});k.subscribe("notification.read",function(a){var b=parseInt(a.unreadCount,10);isNaN(b)||m(a.unreadCount,!1,"notifications")});k.subscribe("notification.raised",function(a){m("+1",!1,"notifications");t()});t();q();W.show.defaults={duration:5E3,width:200,type:"",id:null,onClick:null,onClose:null,onShow:null,onHide:null,onOver:null,onOut:null};W.defaults={template:'<div class="push-notification <%: cssClass %> <% if(active) { %>active<% } %>">  <a href="#" class="close">x</a>   <%= message %> </div> ',
parent:"body",margin:5,errorDuration:5E3,verticalOffset:0,horizontalOffset:0,animationDuration:250,placement:"bottomleft",opacity:0.95,limit:10};c.telligent=c.telligent||{};c.telligent.evolution=c.telligent.evolution||{};c.telligent.evolution.notifications=c.extend(c.telligent.evolution.notifications||{},W);return c.telligent.evolution.notifications},jQuery,window);u("lib.crossWindowPresentContentRegistrar",["lib.storageProxy"],function(f,e,k,h){function n(c){var a={};c=c.split(":");2<=c.length&&
(a.ContentId=c[0],a.ContentTypeId=c[1],2<c.length&&(a.TypeId=c[2]));return a}function g(c){k.setInterval(function(){var a=c.storage.get(c.key)||[],b={},g=(new Date).getTime();e.each(a,function(a,e){g-e<c.expiration&&(b[a]=e)});c.storage.set(c.key,b)},c.garbageCollectInterval)}var c={key:"__cwpcr",expiration:4E3,garbageCollectInterval:3E4,user:{}};return function(d){var a=e.extend({},c,d||{});a.storage=new f(a.user);g(a);return{setVisibleContents:function(b){if(b){for(var c=a.storage.get(a.key)||[],
d=(new Date).getTime(),e=0;e<b.length;e++)c[b[e].ContentId+":"+b[e].ContentTypeId+":"+(b[e].TypeId||"")]=d;a.storage.set(a.key,c)}},getUniqueVisibleContent:function(){var b=a.storage.get(a.key)||[],c=[],d=(new Date).getTime();e.each(b,function(b,e){d-e<a.expiration&&c.push(n(b))});return c}}}},jQuery,window);u("lib.crossWindowPresentContentRegistrarSingleton",["lib.crossWindowPresentContentRegistrar"],function(f,e,k,h){var n=null;return{get:function(g){return n?n:n=new f(e.extend({user:e.telligent.evolution.user.accessing,
expiration:4E3},g||{}))}}},jQuery,window);u("module.presence",["lib.crossWindowPresentContentRegistrarSingleton","lib.crossWindowBus","lib.util"],function(f,e,k,h,n,g){function c(c){c=[];for(var d=b.length;d--;)if(0<b[d].node.closest("body").length){var e;(e=b[d].isRoot)||(e=b[d].node.get(0).getBoundingClientRect(),e=(0<e.height||0<e.width)&&0<=e.bottom&&0<=e.right&&e.top<=(n.innerHeight||document.documentElement.clientHeight)&&e.left<=(n.innerWidth||document.documentElement.clientWidth));if(e)for(e=
0;e<b[d].contents.length;e++)c.push({ContentId:b[d].contents[e].ContentId,ContentTypeId:b[d].contents[e].ContentTypeId,TypeId:b[d].contents[e].TypeId})}else b.splice(d,1);0<c.length&&a&&a.setVisibleContents(c)}function d(){a=f.get();n.setInterval(function(){c(!1)},2E3);m=k.debounce(function(){c(!0)},250);q=k.debounce(function(){try{h.telligent.evolution.sockets.present()}catch(a){}},500);h(n).on("scroll resized",function(){m();q()})}var a=null,b=[],p=!0,m,q,p=!0;h(function(){d();setTimeout(function(){p=
!1},4E3)});e={register:function(a){a.node=h(a.node);a.isRoot=a.node.is("body");b.push(a);p||(m(),q())}};h.telligent=h.telligent||{};h.telligent.evolution=h.telligent.evolution||{};h.telligent.evolution.presence=h.telligent.evolution.presence||e;return e},jQuery,window);u("module.preview",function(f,e,k){var h=function(e,c){var d=f.extend({},n.defaults,c||{});f.telligent.evolution.get({url:d.endpoint,data:{url:e,maxImageWidth:"undefined"!==typeof c.maxImageWidth?c.maxImageWidth:d.maxImageWidth,maxImageHeight:"undefined"!==
typeof c.maxImageHeight?c.maxImageHeight:d.maxImageHeight},success:function(a){a&&d.success&&"undefined"!==typeof a&&null!==a?d.success(a):d.error&&d.error(a)},error:function(a,b,c){d.error&&d.error(a,b,c)}})},n={load:function(e,c){h(e,c)},render:function(e,c){if(null!==e&&"undefined"!==typeof e&&"undefined"!==typeof e.url&&0!==e.url.length&&"undefined"!==typeof e.title&&0!==e.title.length){var d=f.extend({},n.defaults,c);return f.telligent.evolution.template.compile(d.template)(e)}},defaults:{endpoint:"",
maxImageWidth:90,maxImageHeight:90,template:'<div class="abbreviated-post-header shared-link"></div><div class="abbreviated-post shared-link <% if(imageUrl !== null && imageUrl.length > 0){ %> with-image <% } %>">   <h4 class="post-name"><a href="<%: url %>" <% if(url.indexOf(jQuery.telligent.evolution.site.getBaseUrl(true)) < 0) { %>class="external-link" target="_blank"<% } %> rel="nofollow"><%= title %></a></h4>   <% if(siteName !== null && siteName.length > 0){ %>       <div class="post-application">           <span class="label"></span>           <span class="value"><a href="<%: url %>" <% if(url.indexOf(jQuery.telligent.evolution.site.getBaseUrl(true)) < 0) { %>class="external-link" target="_blank"<% } %> rel="nofollow"><%= siteName %></a></span>       </div>   <% } %>   <% if(imageUrl !== null && imageUrl.length > 0){ %>       <div class="post-thumbnail">           <a href="<%: url %>" <% if(url.indexOf(jQuery.telligent.evolution.site.getBaseUrl(true)) < 0) { %>class="external-link" target="_blank"<% } %> rel="nofollow"><%= resizedImageHtml %></a>       </div>   <% } %>   <% if(excerpt !== null && excerpt.length > 0){ %>       <div class="post-summary">           <%= excerpt %>      </div>   <% } %></div><div class="abbreviated-post-footer shared-link"></div>'}};
f.telligent||(f.telligent={});f.telligent.evolution||(f.telligent.evolution={});f.telligent.evolution.preview=n;return{}},jQuery,window);u("module.regex",function(f,e,k){f.telligent||(f.telligent={});f.telligent.evolution||(f.telligent.evolution={});f.telligent.evolution.regex={encode:function(e){return e?e.replace(/[\-\[\]\{\}\(\)\*\+\?\.\,\\\^\$\|\#\s]/g,"\\$&"):e}};return{}},jQuery,window);u("module.rest",["lib.globalConfiguration"],function(f,e,k,h){function n(a){var b;a:{b=f.authorizationCookieName+
"=";for(var c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(b)){b=e.substring(b.length,e.length);break a}}b=null}null!=b&&(a.setRequestHeader("Authorization-Code",b),a.setRequestHeader("Rest-Authorization-Code",b))}function g(a){a&&"~/"==a.substr(0,2)&&(a=f.baseUrl+a.substr(2));f.isRemote&&(f.remoteUrlEncodePattern&&a&&-1<a.lastIndexOf("/~/"))&&(a=a.substr(0,a.lastIndexOf("/~/")+3)+a.substr(a.lastIndexOf("/~/")+3).replace(RegExp(f.remoteUrlEncodePattern,
"gi"),function(a,b,c){return"_"+a.substr(1)}));return a}function c(a,b,c){var d=a,l=b;d&&(b&&"string"!==typeof b&&!1!==c.processData)&&(l={},e.each(b,function(a,b){var c=RegExp("{"+a+"}","gim");d.match(c)?d=d.replace(c,k.encodeURIComponent(b)):l[a]=b}));return{url:d,data:l}}function d(a,b,c){var d=b,l=null;try{var g=e.isPlainObject(a)?a:e.parseJSON(a);if(g&&g.Errors&&e.isArray(g.Errors)&&0<g.Errors.length){var m=[];e.each(g.Errors,function(a,b){b&&0<b.length&&m.push(b.replace(w,""))});1===m.length||
1<m.length&&e.telligent.evolution.notifications===h?d=m[0]:1<m.length&&(l=m[0],d=c,d+="<ul>",e.each(m,function(a,b){d+="<li>"+b+"</li>"}),d+="</ul>")}if(null===d||""===e.trim(d))d=b}catch(p){}return l||d}function a(a,b){var l=c(a.url,a.data,a);a.url=g(l.url);a.data=l.data;var m=a.beforeSend,p=a.error,t=e.extend({},{defaultErrorMessage:f.defaultErrorMessage,defaultMultiErrorMessagePrefix:f.defaultMultiErrorMessagePrefix},a);e.extend(a,{type:"GET"===b?b:"POST",beforeSend:function(a){m!==h&&m(a);n(a);
"PUT"!==b&&"DELETE"!==b||a.setRequestHeader("Rest-Method",b)},error:function(a,b,c){if(0!==a.readyState&&0!==a.status)if(b=d(a.responseText,t.defaultErrorMessage,t.defaultMultiErrorMessagePrefix),p!==h)q(p,this,[a,b,c]);else try{e.telligent.evolution.notifications.show(b,{type:"error"})}catch(l){alert(b)}}});return e.ajax(a)}function b(){var a=++v;r[a]={dfd:e.Deferred(),reqs:[]};setTimeout(function(){delete r[a]},s);return a}function p(a,b){var d=r[a];if(d===h)return e.Deferred(function(b){b.reject('Batch "'+
a+'" not found')}).promise();if(0===d.reqs.length)return d.dfd.resolve(),d.dfd.promise();var l=e.extend({},x,b),p={Sequential:l.sequential};e.each(d.reqs,function(a,b){var d=b.options.url.replace(/\.xml/i,".json"),d=c(d,b.options.data,b.options);"GET"==b.verb?d.url=e.telligent.evolution.url.modify({url:d.url,query:d.data||{}}).split("#")[0]:p["_REQUEST_"+a+"_DATA"]=e.param(d.data||{});p["_REQUEST_"+a+"_URL"]=g(d.url);p["_REQUEST_"+a+"_METHOD"]=b.verb});e.ajax({url:e.telligent.evolution.site.getBaseUrl()+
"api.ashx/v2/batch.json",type:"POST",data:p,beforeSend:function(a){l.beforeSend&&l.beforeSend(a);n(a)}}).done(function(b,c){m(d,b.BatchResponses,this,c);d.dfd.resolveWith(this,[b]);delete r[a]}).fail(function(b,c,l){0!==b.readyState&&0!==b.status&&(b.responseJSON&&b.responseJSON.BatchResponses?m(d,b.responseJSON.BatchResponses,b,c):e.each(d.reqs,function(a,d){d.options.error&&q(d.options.error,d.options,[b,c,l]);d.dfd.rejectWith(d.options,[b,c,l])}),d.dfd.rejectWith(this,[b,c,l]),delete r[a])});return d.dfd.promise()}
function m(a,b,c,l){e.each(b,function(b,g){var m=a.reqs[b];if(200===g.StatusCode)m.options.success&&q(m.options.success,m.options,[g.BatchResponse,l,c]),m.dfd.resolveWith(m.options,[g.BatchResponse,l,c]);else{var p=d(g.BatchResponse,m.options.defaultErrorMessage,m.options.defaultMultiErrorMessagePrefix);if(m.options.error)q(m.options.error,c,[g,p,l]);else try{e.telligent.evolution.notifications.show(p,{type:"error"})}catch(t){alert(p)}m.dfd.rejectWith(c,[g,p,l])}m.options.complete&&q(m.options.complete,
m.options,[c,l])})}function q(a,b,c){if(a)if(e.isArray(a))for(var d=0;d<a.length;d++)a[d].apply&&a[d].apply(b,c);else a.apply&&a.apply(b,c)}function t(c,d){null!==y&&(c.batch=y);c&&(c.url&&0<=c.url.indexOf("/api.ashx/")&&"GET"==d)&&(c=e.extend({},{cache:!1},c));if(c&&c.batch){var l=c,g;g=l.batch;r[g]===h&&(g=b());g=r[g];l={options:e.extend({},{defaultErrorMessage:f.defaultErrorMessage,defaultMultiErrorMessagePrefix:f.defaultMultiErrorMessagePrefix},l),verb:d,dfd:e.Deferred()};g.reqs.push(l);return l.dfd.promise()}return a(c,
d)}function l(a,c){if(a){if(null!==y)throw"Batched REST requests cannot be nested.";var d=b();y=d;try{a.apply(this)}finally{y=null}return p(d,c)}}var w=/(?:<|>)/g,r={},v=0,s=6E4,y=null,x={sequential:!1,beforeSend:null};l.create=b;l.process=p;var z={get:function(a){return t(a,"GET")},post:function(a){return t(a,"POST")},put:function(a){return t(a,"PUT")},del:function(a){return t(a,"DELETE")},writeAuthorizationHeader:n,ensureRemoteUrlEncoding:g,batch:l};e.telligent=e.telligent||{};e.telligent.evolution=
e.telligent.evolution||{};e.extend(e.telligent.evolution,z);k.TelligentUtility||(k.TelligentUtility={WriteAuthorizationHeader:function(a){e.telligent.evolution.writeAuthorizationHeader(a)}});return z},jQuery,window);u("module.scriptRendering",["lib.util","events.rendered"],function(f,e,k,h,n){function g(b){return(b.attr("src")||a.test(b.attr("type")||""))&&!k.contains(h.document.documentElement,b.get(0))}function c(a,b,c){try{var d=k(b);c.scripts=[];d.filter("script").each(function(){var a=k(this);
g(a)&&(c.scripts.push(a),a.remove())});d.find("script").each(function(){var a=k(this);g(a)&&(c.scripts.push(a),a.remove())});return 0<c.scripts.length?d=d.filter(function(){var a=k(this);return!(a.is("script")&&g(a))}):b}catch(e){return b}}function d(a,c){try{if(c.scripts&&0!==c.scripts.length){var d=[],l=[],g=[];k.each(c.scripts,function(a,c){c.attr("src")?p[c.attr("src")]?l[a]="":d.push(k.telligent.evolution.get({url:c.attr("src"),type:"GET",dataType:"text",success:function(b){l[a]=b+"";g.push(c.attr("src"))},
error:function(a,b,c){}})):l[a]=c.get(0).textContent.replace(b,"")});k.when.apply(k,d).done(function(){try{k.globalEval(l.join("\n;;;\n")),k.each(g,function(a,b){p[b]=!0}),e.decrementLoading(a)}catch(b){e.decrementLoading(a)}}).fail(function(b){e.decrementLoading(a)})}else e.decrementLoading(a)}catch(f){e.decrementLoading(a)}}var a=/^$|\/(?:java|ecma)script/i,b=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,p={};k(document).ready(function(){k("script[src]").each(function(){p[k(this).attr("src")]=!0})});
k.each(["html","append","prepend"],function(a,b){var g=k.fn[b];k.fn[b]=function(){var a={scripts:[]},b=arguments;e.incrementLoading(this);b[0]=c(this,b[0],a);b=g.apply(this,b);d(this,a);return b}});return{}},jQuery,window);u("module.sockets.connection",function(f,e,k){var h=function(e){h.connectionState=f.signalR.connectionState;var g=f.connection(e.endpoint);return{start:function(c){return g.start(c)},stop:function(){return g.stop()},send:function(c){return g.send(c)},received:function(c){return g.received(c)},
error:function(c){return g.error(c)},stateChanged:function(c){return g.stateChanged(c)},disconnected:function(c){return g.disconnected(c)},reconnected:function(c){return g.reconnected(c)}}};return h},jQuery,window);u("module.sockets.crossTabRequest",["lib.crossWindowBus","lib.backgroundTimer"],function(f,e,k,h,n){var g={},c={timeout:50};return function(d){k.extend({},g,d||{});var a={},b={},p=new f({key:"__ctr",includeLocal:!1,receive:function(c,d,e){"req"==c?(c=null,a[d.name]&&(c=a[d.name](d.data)),
p.send(e.source,"resp",{name:d.name,response:c})):"resp"==c&&(b[d.name]=b[d.name]||[],b[d.name].push({source:e.source,response:d.response}))}});return{handle:function(b,c){a[b]=c},request:function(a,d,g){return k.Deferred(function(l){var f=k.extend({},c,g||{});b=b||{};delete b[a];p.broadcast("req",{name:a,data:d});e.setTimeout(function(){b[a]?l.resolve({responses:b[a]}):l.resolve({responses:[]})},f.timeout)}).promise()}}}},jQuery,window);u("module.sockets.managedConnection",["module.sockets.connection",
"lib.crossWindowPresentContentRegistrarSingleton","lib.backgroundTimer","module.messaging"],function(f,e,k,h,n,g,c){function d(a){a.reconnectAttempts++;var b=1E3*(Math.pow(2,a.reconnectAttempts)-1);b>a.maxReconnectDelay&&(b=a.maxReconnectDelay,a.reconnectAttempts--);return Math.floor(Math.random()*(b-1)+1)}function a(a,b){var c=d(a);k.clearTimeout(a.reconnectTimeout);a.reconnectTimeout=k.setTimeout(function(){a.authenticated&&(k.clearTimeout(a.reconnectTimeout),p(a))},c)}function b(a,b,c){if(a.authenticated){var d=
a.crossWindowPresentContentRegistrar.getUniqueVisibleContent(),e;e=[];for(var g=0;g<(d||[]).length;g++)e.push(d[g].ContentId+"|"+d[g].ContentTypeId+"|"+d[g].TypeId),e.sort();e="_present:"+e.join(",");a.connectionState!=f.connectionState.connected||c&&(null==d||0==d.length||a.lastSentPresenceMessage&&e===a.lastSentPresenceMessage)||(b.send(e),a.lastSentPresenceMessage=e)}}function p(a){a.connection.start({callback:function(){a.authenticated=!0}})}function m(c,d){var e=c.connectionState;c.connectionState=
d;switch(c.connectionState){case f.connectionState.connected:k.clearTimeout(c.raiseDisconnectTimeout);if(!c.raisedInitialConnect){if(c.raisedInitialConnect=!0,c.onConnected)c.onConnected()}else if(c.raisedInitialConnect&&c.onReconnected)c.onReconnected();c.reconnectAttempts=0;k.clearInterval(c.presenceInterval);c.presenceInterval=k.setInterval(function(){b(c,c.connection)},c.sendPresenceIntervalTime);n(g).off(t).on("beforeunload"+t,function(){c.unloaded=!0;c.connection.stop()}).on("online"+t,function(){p(c)}).on("wake"+
t,function(){p(c)});break;case f.connectionState.connecting:case f.connectionState.reconnecting:case f.connectionState.disconnected:e==f.connectionState.connected&&!c.unloaded&&c.onDisconnected&&(k.clearTimeout(c.raiseDisconnectTimeout),c.raiseDisconnectTimeout=k.setTimeout(function(){if(c.authenticated)c.onDisconnected(!0)},2E3)),c.connectionState!=f.connectionState.disconnected||c.unloaded||a(c,c.connection)}}var q={endpoint:"",sendPresenceIntervalTime:2E4,reconnectAttempts:0,disconnectGracePeriod:2E3,
maxReconnectDelay:3E5,connectionState:0,raisedInitialConnect:!1,reconnectTimeout:0,presenceInterval:null,onReceived:null,onConnected:null,onDisconnected:null,onReconnected:null},t="._sockets_managedConnection";return function(a){var c=n.extend({},q,a||{});n.ajaxPrefilter(function(a,b,d){0===a.url.indexOf(c.endpoint)&&n.telligent.evolution.writeAuthorizationHeader(d)});c.connection=new f({endpoint:c.endpoint});c.connection.stateChanged(function(a){m(c,a.newState)});c.connection.received(function(a){if(c.onReceived)c.onReceived(a)});
c.connection.error(function(a){c.connection.stop()});h.subscribe("user.logout",function(){c.authenticated=!1;c.onDisconnected&&k.setTimeout(function(){c.onDisconnected(!1)},3E3)});return{start:function(a){a.onConnected&&(c.onConnected=a.onConnected);a.onReceived&&(c.onReceived=a.onReceived);a.onDisconnected&&(c.onDisconnected=a.onDisconnected);a.onReconnected&&(c.onReconnected=a.onReconnected);c.crossWindowPresentContentRegistrar||(c.crossWindowPresentContentRegistrar=e.get());p(c)},stop:function(){c.connectionState!=
f.connectionState.disconnected&&c.connection.stop()},send:function(a){c.connectionState!=f.connectionState.connected&&c.authenticated||c.connection.send(a)},sendPresence:function(){b(c,c.connection,!0)}}}},jQuery,window);u("module.sockets.sharedObjectProxy",["lib.crossWindowBus","module.sockets.sharedObjectProxyState","module.sockets.crossTabRequest","lib.backgroundTimer"],function(f,e,k,h,n,g,c){function d(c){h.setInterval(function(){switch(c.mode){case t.initial:case t.worker:c.beatsWithoutCoordinator++;
c.beatsWithoutCoordinator>c.maxBeatsWithoutCoordinator&&(b(c),c.coordinatorId=null,a(c));break;case t.coordinator:c.crossWindowBus.broadcast(l.coordinating,{});break;case t.volunteer:c.beatsAsVolunteer++,c.beatsAsVolunteer>c.maxBeatsAsVolunteer&&p(c)}},g.__shared_object_proxy_interval?g.__shared_object_proxy_interval:c.heartbeat)}function a(a){null!==a.objectInstance&&(a.destroy(a.objectInstance),a.objectInstance=null)}function b(b){b.mode=t.volunteer;b.beatsAsVolunteer=0;b.coordinatorId=null;a(b);
b.crossWindowBus.broadcast(l.volunteer,{})}function p(a){a.mode=t.coordinator;a.beatsAsVolunteer=0;a.coordinatorId=a.id;a.objectInstance=a.construct();a.crossWindowBus.broadcast(l.coordinating,{});if(a.delayedMessageQueue)for(var b=0;b<a.delayedMessageQueue.length;b++)q(a,a.delayedMessageQueue[b].message,a.delayedMessageQueue[b].data)}function m(b){b.mode=t.worker;b.coordinatorId=null;a(b);b.beatsAsVolunteer=0}function q(a,b,c){a.mode===t.coordinator&&null!==a.objectInstance?a.receive(a.objectInstance,
b,c):null!==a.coordinatorId?a.crossWindowBus.send(a.coordinatorId,l.call,{name:b,data:c}):(a.delayedMessageQueue.push({message:b,data:c}),a.delayedMessageQueue.length>a.delayedMessageQueueMaxLength&&a.delayedMessageQueue.shift())}var t={initial:0,coordinator:1,volunteer:2,worker:3},l={coordinating:"sop:coordinating",working:"sop:working",volunteer:"sop:volunteer",ok:"sop:ok",call:"sop:call",resign:"sop:resign",newarrival:"sop:newarrival"},w={heartbeat:1E3,preexisting:function(a){},construct:function(){},
destroy:function(a){},receive:function(a,b,c){}},r={mode:t.initial,id:0,beatsWithoutCoordinator:0,beatsAsVolunteer:0,coordinatorId:0,objectInstance:null,delayedMessageQueue:[],delayedMessageQueueMaxLength:25,maxBeatsAsVolunteer:2,maxBeatsWithoutCoordinator:2};return function(c){var s=n.extend({},w,c||{},r);s.crossTabRequest=new k;s.crossWindowBus=new f({key:"__sop",includeLocal:!1,receive:function(c,d,g){g=g.source;switch(c){case l.coordinating:s.beatsWithoutCoordinator=0;s.mode===t.worker||s.mode===
t.initial?(s.coordinatorId=g,s.mode===t.initial&&m(s)):(s.mode===t.coordinator&&s.crossWindowBus.broadcast(l.resign,{}),m(s));e.hasMultipleWindows(!0);d&&d.preExisting&&s.preexisting();s.crossWindowBus.send(g,l.working,{});break;case l.working:e.hasMultipleWindows(!0);break;case l.volunteer:s.mode!==t.coordinator&&s.mode!==t.volunteer||s.crossWindowBus.send(g,l.ok,{});break;case l.ok:s.mode===t.volunteer&&m(s);break;case l.call:s.mode===t.coordinator&&null!==s.objectInstance&&s.receive(s.objectInstance,
d.name,d.data);break;case l.resign:if(s.mode===t.worker||s.mode===t.initial)b(s),s.coordinatorId=null,a(s);break;case l.newarrival:s.mode===t.coordinator&&s.crossWindowBus.send(g,l.coordinating,{preExisting:!0})}}});s.id=s.crossWindowBus.id();d(s);n(g).on("unload",function(){s.mode!==t.worker&&s.crossWindowBus.broadcast(l.resign,{})});s.crossWindowBus.broadcast(l.newarrival,{});s.crossTabRequest.handle("CurrentMode",function(){return s.mode});s.crossTabRequest.request("CurrentMode",{},{timeout:100}).done(function(a){for(var b=
!1,c=0;c<a.responses.length;c++)a.responses[c]===t.coordinator&&(b=!0);!b&&(0<a.responses.length&&s.mode===t.initial)&&p(s)});h.setTimeout(function(){s.mode===t.initial&&p(s)},2*s.heartbeat);return{call:function(a,b){q(s,a,b)}}}},jQuery,window);u("module.sockets.sharedObjectProxyState",["lib.backgroundTimer"],function(f,e,k,h){var n=!1,g=null;e={hasMultipleWindows:function(c){c!==h&&(f.clearTimeout(g),n=c,g=f.setTimeout(function(){n=!1},2500));return n}};return k._sharedObjectProxyState=e},jQuery,
window);u("module.sockets","module.sockets.managedConnection module.sockets.sharedObjectProxy lib.crossWindowBus module.notifications lib.backgroundTimer module.presence".split(" "),function(f,e,k,h,n,g,c,d,a){var b={reconnectingResource:"Reconnecting",disconnectResource:"Disconnected",reconnectResource:"Reconnected"},p={},m,q,t=!1,l=function(){t?c.telligent.evolution.messaging.publish("socket.reconnected",null,{crossWindow:!0}):(t=!0,m.call("sendPresence"),c.telligent.evolution.messaging.publish("socket.connected"))},
w=function(a){var b=c("body");g.register({node:b.get(0),contents:a})},r=function(a,b,d){if(a=p[a+"|"+b]){var e=d&&0<d.length?c.parseJSON(d):null;c.each(a,function(a,b){try{b(e)}catch(c){}})}},v=function(){d.parent&&d.parent!=d||(h.show(b.reconnectResource,{id:"__disconnect_notification",duration:5E3}),n.setTimeout(function(){h.hide("__disconnect_notification")},5E3))};api=function(a){c.each(a.sockets,function(a,b){api[b.name]={on:function(a,c){var d=b.fullName+"|"+a;p[d]=p[d]||[];p[d].push(c)},off:function(a){delete p[b.fullName+
"|"+a]},send:function(a,d){if(m){var e=c.telligent.evolution.url.serializeQuery(c.extend(d,{_s:b.fullName,_m:a}));m.call("send",e)}}}});api.present=function(){null!==q&&q.broadcast("_shared_socket.sendPresence")};0<a.sockets.length&&(q=new k({key:"__rsm",includeLocal:!0,receive:function(e,g){if("_shared_socket.receive"===e){var p=c.telligent.evolution.url.parseQuery(g);r(p._s,p._m,p._d)}else"_shared_socket.socketsReady"===e?(w(a.presentPageContexts),l()):"_shared_socket.socketsDisconnected"===e?(c.telligent.evolution.messaging.publish("socket.disconnected",
null,{crossWindow:!0}),p=g.reconnecting,d.parent&&d.parent!=d||h.show(p?b.reconnectingResource:b.disconnectResource,{id:"__disconnect_notification",type:p?"error":"",duration:6048E5})):"_shared_socket.socketsReconnected"===e?(m.call("sendPresence"),c.telligent.evolution.messaging.publish("socket.reconnected",null,{crossWindow:!0}),v()):"_shared_socket.sendPresence"===e&&m.call("sendPresence")}}),m=new e({heartbeat:1E3,preexisting:function(b){n.setTimeout(function(){w(a.presentPageContexts);l()},250)},
construct:function(){var b=new f({endpoint:a.endpoint});b.start({onConnected:function(){q.broadcast("_shared_socket.socketsReady")},onReceived:function(a){q.broadcast("_shared_socket.receive",a)},onDisconnected:function(a){q.broadcast("_shared_socket.socketsDisconnected",{reconnecting:a})},onReconnected:function(){q.broadcast("_shared_socket.socketsReconnected")}});return b},destroy:function(a){null!==a&&a.stop()},receive:function(a,b,c){null!==a&&("send"===b?a.send(c):"sendPresence"===b&&a.sendPresence())}}))};
api.defaults=b;c.telligent=c.telligent||{};c.telligent.evolution=c.telligent.evolution||{};c.telligent.evolution.sockets=c.telligent.evolution.sockets||api;return{}},jQuery,window);u("module.systemNotifications","lib.util lib.storageProxy module.messaging module.sockets.sharedObjectProxyState lib.globalConfiguration module.rest".split(" "),function(f,e,k,h,n,g,c,d,a){function b(a,b,d){t||(t=new e({id:c.telligent.evolution.user.accessing.id,isSystemAccount:c.telligent.evolution.user.accessing.isSystemAccount}));
var g=t.get(p),f=!1;g&&(g.id==a&&18E5>(new Date).getTime()-g.time)&&(f=!0);!f&&m&&b&&0<b.length&&0<d?(1<d&&(b+=" "+l.andMoreText.replace(/\{0\}/g,d-1)),b='<div class="system-notification-title">'+l.notificationText+'</div><div class="system-notification-content">'+b+'</div><div class="system-notification-review">'+l.reviewText+"</div>",c.telligent.evolution.notifications.show(b,{type:"system-notification",duration:6048E5,id:q,onClick:c.telligent.evolution.systemNotifications.openPanel,onClose:function(){t.set(p,
{id:a,time:(new Date).getTime()})}})):c.telligent.evolution.notifications.hide(q)}c.telligent||(c.telligent={});c.telligent.evolution||(c.telligent.evolution={});var p="systemnotifications",m=!1,q="__systemnotification",t=null,l={explicitPanelUrl:"",notificationText:"System Notification",reviewText:"Review",andMoreText:" (plus {0} more)"};c.telligent.evolution.systemNotifications={configure:function(a){l=c.extend(l,a)},openPanel:function(){window.location.href=l.explicitPanelUrl}};c(document).ready(function(){(m=
(m=(m=!d.parent||d==d.parent)&&!c("body").hasClass("administration"))&&!(c.telligent.evolution.user.accessing.isSystemAccount||c.telligent.evolution.user.accessing.isTemporary))&&c.telligent.evolution.get({url:c.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/systemnotifications.json",data:{IsResolved:!1,PageSize:1,PageIndex:0},success:function(a){var c=a.TotalCount;0<c&&(a=0<a.SystemNotifications.length?a.SystemNotifications[0]:{},b(a.Id,a.Subject,c))}})});k.subscribe("systemnotification.raised",
function(a){b(a.id,a.message,a.count)});k.subscribe("systemnotification.resolved",function(a){b(a.nextid,a.message,a.count)});return{}},jQuery,window);u("module.template",["lib.lruCache","lib.storageProxy","module.javaScript","module.html","lib.util"],function(f,e,k,h,n,g,c,d){var a={},b={open:"<%",close:"%>"},p=null,m=function(){var a=new e(g.telligent&&g.telligent.evolution&&g.telligent.evolution.user&&g.telligent.evolution.user.accessing?g.telligent.evolution.user.accessing:{isSystemAccount:!0,
id:0});return new f({load:function(){return a.get("_templates")},persist:function(b){a.set("_templates",b)}})},q=function(a,b){var c={};return function(a,b){var d=b.open+b.close,e=c[d];e||(e=RegExp("("+n.escapeRegEx(b.open)+"|"+n.escapeRegEx(b.close)+")","g"),c[d]=e);for(var d=a.split(e),e=!1,g=0;g<d.length;g++)d[g]==b.open?e=!0:d[g]==b.close?e=!1:e||(d[g]=k.encode(d[g]));return d.join("")}}(),t=function(a,c,d){var e=d.get(a);if(!e){e=g.extend({},b,c||{});c=RegExp(n.escapeRegEx(e.open)+"=([\\s\\S]+?)"+
n.escapeRegEx(e.close),"g");var l=RegExp(n.escapeRegEx(e.open)+":([\\s\\S]+?)"+n.escapeRegEx(e.close),"g"),p=RegExp(n.escapeRegEx(e.open)+"(.*?)"+n.escapeRegEx(e.close),"g"),e="var s=[];with(data){with(e){with(d){s.push('"+q(a,e).replace(c,"');s.push(String($1));s.push('").replace(l,"');s.push(escape(String($1)));s.push('").replace(p,"');$1s.push('")+"');}}}return s.join('');";d.set(a,e)}a=new Function("d","e","data",e);a.compiledSource="function(d, e, data) { "+e+" } ";return a},l=function(b){return a[b]};
g.extend(l,{compile:function(b,c,d,e){e||(p||(p=m()),e=p);var g=a[b];if("undefined"===typeof g){var f=null!==document.getElementById(b)?document.getElementById(b).innerHTML:b,q=t(f,d,e);a[b]=g=function(a){return q.call(this,l.helpers||{},c||{},a||{})};g.source={raw:f,compiled:q.compiledSource}}return g},helpers:{foreach:function(a,b){if(a&&0<a.length&&b)for(var c=0;c<a.length;c++)b(a[c],c)},escape:function(a){return h.encode(a)}},register:function(b,c){a[b]=function(a){return c.call(this,l.helpers||
{},a||{})}}});g.telligent=g.telligent||{};g.telligent.evolution=g.telligent.evolution||{};return g.telligent.evolution.template=l},jQuery,window);u("module.themePreview",["module.messaging","module.rest"],function(f,e,k,h,n){function g(a){return k.Deferred(function(b){!0===a!=d.isPreviewing?k.telligent.evolution.post({url:d.callbackUrl,data:{Enabled:!0===a}}).success(function(){m=!0;c(!0===a);b.resolve(!0===a)}).fail(function(){b.reject(d.isPreviewing)}):b.resolve(!0===a)}).promise()}function c(c){if(c!=
d.isPreviewing){if(c)h.document.cookie=d.cookieName+"=True; path=/";else{var e=new Date;e.setTime(e.getTime()+-864E5);h.document.cookie=d.cookieName+"=; expires="+e.toGMTString()}d.isPreviewing=c;a?b=!0:p||h.location.reload(!0)}}var d={callbackUrl:null,isPreviewing:!1,previewUrl:"",stopPreviewingConfirmation:"",cookieName:"enable_theme_staging"},a=!1,b=!1,p=!1,m=!1,q=null;f.subscribe("administration.panel.loaded",function(){a=!0});f.subscribe("context.shell.closed",function(){a=!1;m&&(d.isPreviewing&&
h.confirm(d.stopPreviewingConfirmation))&&g(!1);b&&!p&&(b=!1,h.location.reload(!0))});f.subscribe("themepreview.enabled",function(){c(!0)});f.subscribe("themepreview.disabled",function(){c(!1)});h.parent!=h&&(p=!0);k(document).ready(function(){k.telligent.evolution.sockets.themepreview&&(k.telligent.evolution.sockets.themepreview.on("preview-updated",function(c){h.clearTimeout(q);q=h.setTimeout(function(){f.publish("themepreview.updated",{});d.isPreviewing&&(a?b=!0:p||h.location.reload(!0))},1E3)}),
k.telligent.evolution.sockets.themepreview.on("preview-enabled",function(a){f.publish("themepreview.enabled",{})}),k.telligent.evolution.sockets.themepreview.on("preview-disabled",function(a){f.publish("themepreview.disabled",{})}))});k(document).on("customizepage",function(){p=!0});e={enabled:function(a){return a===n?d.isPreviewing:g(a)},configure:function(a){d=k.extend({},d,a)},hasPendingRefresh:function(){return b}};k.telligent||(k.telligent={});k.telligent.evolution||(k.telligent.evolution={});
return k.telligent.evolution.themePreview=e},jQuery,window);u("module.tourtips",["module.configuration"],function(f,e,k,h){function n(){function a(b){return e.telligent.evolution.user.accessing.id+":"+b}function b(a){return"tourtip_:"+a}var c=e.telligent.evolution.user.accessing.isSystemAccount?k.sessionStorage:k.localStorage;return{get:function(d){if(c)return JSON.parse(c.getItem(b(a(d))))},set:function(d,e){c&&c.setItem(b(a(d)),JSON.stringify(e))},remove:function(d){c&&c.removeItem(b(a(d)))}}}function g(){q&&
(k.clearTimeout(b),b=k.setTimeout(g,m));var l=[],p=[];e.each(a,function(a,b){var c=t.get(b.key);c&&!c.read?l.push(b):c||p.push(b)});a.length=0;if(0<p.length)if(e.telligent.evolution.user.accessing.isSystemAccount)e.each(p,function(a,b){l.push(b)}),c(l);else{var f={},s=[];e.each(p,function(a,b){s.push(b.key);f[b.key]=b});q=!0;d.list(s).then(function(a){q=!1;e.each(a.TourTips,function(a,b){t.set(b.Key,{read:b.Read});if(!b.Read){var c=f[b.Key];c&&l.push(c)}});c(l)})}else c(l)}function c(a){t=t||n();
var b=t.get(l);b&&0<b&&b>(new Date).getTime()||(a=a.sort(function(a,b){return a.index-b.index}),e.telligent.evolution.messaging.publish("ui.tourtips",{tips:a}))}var d={mark:function(a,b){return(b?e.telligent.evolution.post:e.telligent.evolution.del)({url:e.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/tourtips/{key}.json?IncludeFields=Key,Read",data:{key:a}})},list:function(a){return e.telligent.evolution.get({url:e.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/tourtips.json?IncludeFields=Key,Read",
data:{Keys:a.join(",")}})}},a=[],b,p=0,m=1E3,q=!1,t,l="suppressUntil";e.telligent=e.telligent||{};e.telligent.evolution=e.telligent.evolution||{};e.telligent.evolution.tourTips={register:function(c){e.telligent.evolution.user&&(e.telligent.evolution.user.accessing&&!e.telligent.evolution.user.accessing.isSystemAccount&&!e.telligent.evolution.user.accessing.isTemporary)&&(t=t||n(),c&&(c.index==h&&(c.index=p++),a.push(c),k.clearTimeout(b),b=k.setTimeout(g,m)))},mark:function(a,b){t.set(a,{read:b});
return e.telligent.evolution.user.accessing.isSystemAccount?e.Deferred(function(a){a.resolve()}).promise():d.mark(a,b)},suppress:function(a){t=t||n();a&&0<a?t.set(l,(new Date).getTime()+a):t.remove(l)}};return{}},jQuery,window);u("module.ui",["lib.util"],function(f,e,k,h){var n={},g=!1,c={components:{},render:function(d){d=e(d||document);for(var a in c.components){var b=c.components[a],g=e(".ui-"+a,d);d.hasClass(".ui-"+a)&&g.add(d);g&&(0<g.length&&"undefined"!==typeof b.setup&&!n[a])&&(b.setup.call(this),
n[a]=!0);g&&(0<g.length&&"undefined"!==typeof b.add)&&g.each(function(){var d=e(this);d.data("_telligent_evolution_ui_render_add."+a)||(b.add.call(d,d,c.data(d)),d.data("_telligent_evolution_ui_render_add."+a,!0))})}},suppress:function(c){g=!0;try{c()}catch(a){}g=!1},data:function(c){if(!c)return{};c=e(c);var a=c.data("_telligent_evolution_ui_data");if(null===a||"undefined"===typeof a){var a=c.get(0),b={};if(a.dataset)b=a.dataset;else for(var g=0;g<a.attributes.length;g++){var m=a.attributes[g];if(0===
m.name.indexOf("data-")){var f=m.name.substring(5);b[f]=m.value}}b.configuration&&(b=e.extend({},b,{configuration:e.telligent.evolution.url.parseQuery(b.configuration)}));a=b;c.data("_telligent_evolution_ui_data",a)}return a}};e.telligent||(e.telligent={});e.telligent.evolution||(e.telligent.evolution={});e.telligent.evolution.ui=c;e.each(["html","append","prepend"],function(c,a){e.fn[a]=f.wrap(e.fn[a],{after:function(){g||e.telligent.evolution.ui.render(this)}})});e.each(["after","before"],function(c,
a){e.fn[a]=f.wrap(e.fn[a],{after:function(){g||e.telligent.evolution.ui.render(this.parent())}})});e.each(["replaceWith"],function(c,a){e.fn[a]=f.wrap(e.fn[a],{filterArguments:function(a){return e(a)[0]?[e(a)]:[a]},after:function(a){g||e.telligent.evolution.ui.render(a)}})});return c},jQuery,window);u("module.url",function(f,e,k){var h=null,n=function(c,a,b,e,g){if(!c)return c;var f=/(?:\.config|\.ascx|\.asax|\.cs|\.vb)$/i.test(c);return c.replace(a,function(a,l,w){if(" "==a)return b;if("."!=a||f||
w==c.length-1||"."==c.substr(w+1,1)){l=[];l[l.length]=g;for(w=0;w<a.length;w++){var r=a.charCodeAt(w).toString(16)+"",h=r.length;4==h?(l.push(r.substr(2,2).toUpperCase()),l.push(r.substr(0,2).toUpperCase())):3==h?(l.push(r.substr(1,2).toUpperCase()),l.push("0"),l.push(r.substr(0,1).toUpperCase())):2==h&&(l.push(r.toUpperCase()),l.push("00"))}l[l.length]=g;return l.join("")}return e})},g=function(c,a,b,e){return c?c.replace(a,function(a,c,d){if(1==a.length){if(a==b)return" ";if(a==e)return"."}else{a=
a.substr(1,a.length-2);if(0!=a.length%4)return"";c=[];for(d=0;d<a.length;d+=4)c[c.length]=String.fromCharCode(parseInt(a.substr(d+2,2)+a.substr(d,2),16));return c.join("")}}):c},c={parseQuery:function(c){var a=c.split("?"),b={};c=(1<a.length?a[1]:c).split("#")[0].split("&");f.each(c,function(a,c){c=c.split("=");2===c.length&&(b[c[0]]=decodeURIComponent(c[1].replace(/\+/gi," ")))});return b},serializeQuery:function(c){c=c||{};var a=[];f.each(c,function(b,c){a[a.length]=encodeURIComponent(b)+"="+encodeURIComponent(c)});
return a.join("&")},modify:function(d){d=f.extend({url:e.location.href,query:null,hash:e.location.hash,protocol:e.location.protocol},d);var a=[d.url.split("?")[0].split("#")[0]],b;"string"===typeof d.query&&(d.query=c.parseQuery(d.query));(b=c.serializeQuery(f.extend(c.parseQuery(d.url),d.query)))&&0<b.length&&(a[a.length]="?"+b);d.hash&&0<d.hash.length&&(a[a.length]=(0!==d.hash.indexOf("#")?"#":"")+d.hash);return a.join("")},hashData:function(d,a){var b=!1,g="";f.isPlainObject(a)?(b=a.overrideCurrent,
g=a.prefix||""):b=a;if(g){var m={},q;for(q in d)m[g+q]=d[q];d=m}if("undefined"===typeof d){d={};var b=e.location.href.split("#"),t="";2<b.length&&(f.each(b,function(a,b){0<a&&(1<a&&(t+="#"),t+=b)}),b=[b[0],t]);2===b.length&&(d=c.parseQuery(b[1]));return d}b||(d=f.extend(c.hashData(),d));e.location.href=e.location.href.split("#")[0]+"#"+c.serializeQuery(d)},encode:function(c){return encodeURIComponent(c)},decode:function(c){return decodeURIComponent(c)},encodePathComponent:function(c){return n(c,/([^A-Za-z0-9 \.]+|\.| )/g,
"+","-","_")},decodePathComponent:function(c){return g(c,/((?:_(?:[0-9a-f][0-9a-f][0-9a-f][0-9a-f])+_)|\-|\+)/ig,"+","-")},encodeFileComponent:function(c){return n(c,/([^A-Za-z0-9 \.]+|\.| )/g,"-",".","_")},decodeFileComponent:function(c){return g(c,/((?:_(?:[0-9a-f][0-9a-f][0-9a-f][0-9a-f])+_)|_|\-)/ig,"-",".")},navigateTo:function(c){var a=f("base");if(0<a.length){h||(h=f("<a></a>").css({position:"absolute",left:"-1000px"}),f("body").append(h));var b=h.attr({href:c})[0];try{e.document.createEvent?
b.dispatchEvent(function(a){a.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null);return a}(document.createEvent("MouseEvents"))):b.dispatchEvent(new MouseEvent("click",{view:e,bubbles:!0,cancelable:!0}))}catch(g){(a=a.attr("target"))?e.open(c,a):e.document.location=c}}else e.document.location=c}};f.telligent||(f.telligent={});f.telligent.evolution||(f.telligent.evolution={});return f.telligent.evolution.url=c},jQuery,window);u("plugins","plugin.evolutionBookmark plugin.evolutionComposer plugin.evolutionFeature plugin.evolutionHighlight plugin.evolutionInlineTagEditor plugin.evolutionLike plugin.evolutionModerate plugin.evolutionPager plugin.evolutionResize plugin.evolutionStarRating plugin.evolutionTagTextBox plugin.evolutionTheater plugin.evolutionToggleLink plugin.evolutionTransform plugin.evolutionUserFileTextBox plugin.validation plugin.evolutionTextEditor plugin.evolutionScrollSlider plugin.evolutionMasonry plugin.evolutionTip plugin.evolutionTokenTextBox plugin.evolutionVote plugin.evolutionSqueezeText plugin.evolutionCodeEditor plugin.evolutionThreadReplies".split(" "),
function(){return{}});u("plugin.evolutionBookmark",function(f,e,k){var h=function(a){a.toggle=f("<a></a>").attr({href:"#"});a.element.append(a.toggle);a.toggle.evolutionToggleLink({onHtml:"<span></span>"+f.telligent.evolution.html.encode(n(a,a.settings.deleteBookmarkText)),offHtml:"<span></span>"+f.telligent.evolution.html.encode(n(a,a.settings.addBookmarkText)),processingHtml:"<span></span>"+f.telligent.evolution.html.encode(n(a,a.settings.processingText)),changeState:function(b){c(b,a)},onTitle:n(a,
a.settings.deleteBookmarkText),offTitle:n(a,a.settings.addBookmarkText),processingTitle:n(a,a.settings.processingText),onCssClass:a.settings.deleteBookmarkCssClass,offCssClass:a.settings.addBookmarkCssClass,processingCssClass:a.settings.processingCssClass,val:a.settings.initialState})},n=function(a,b){return b.replace(/\{content_type_name\}/gi,a.settings.contentTypeName)},g=function(a,b){f.telligent.evolution.messaging.publish("ui.bookmark",{contentId:a.settings.contentId,contentTypeId:a.settings.contentTypeId,
typeId:a.settings.typeId,bookmarked:b},{crossWindow:!0})},c=function(a,b){if(a)b.settings.onBookmark(b.settings.contentId,b.settings.contentTypeId,b.settings.typeId,function(){g(b,!0)});else b.settings.onUnbookmark(b.settings.contentId,b.settings.contentTypeId,b.settings.typeId,function(){g(b,!1)})},d=function(a){f.telligent.evolution.messaging.subscribe("ui.bookmark",function(b){b.contentId===a.settings.contentId&&b.contentTypeId===a.settings.contentTypeId&&b.typeId===a.settings.typeId&&a.toggle&&
a.toggle.evolutionToggleLink("val",b.bookmarked)})};f.fn.evolutionBookmark=function(a){var b=f.extend({},f.fn.evolutionBookmark.defaults,a||{});return this.each(function(){var a={element:f(this),toggle:null,settings:b};h(a);d(a)})};f.fn.evolutionBookmark.defaults={contentId:"",contentTypeId:"",typeId:"",initialState:!1,contentTypeName:"",onBookmark:function(a,b,c,d){},onUnbookmark:function(a,b,c,d){},deleteBookmarkText:"Unbookmark {content_type_name}",addBookmarkText:"Bookmark this {content_type_name}",
processingText:"...",addBookmarkCssClass:"internal-link favorite-off",deleteBookmarkCssClass:"internal-link favorite-on",processingCssClass:"internal-link processing"};return{}},jQuery,window);u("plugin.evolutionCodeEditor",["lib.util"],function(f,e,k,h){function n(a){if(!a)return a;var b=a.split("/");return 2>=b.length?b:"ace.js"!=b.pop()?a:b.join("/")}function g(a){if(!a)return a;a=a.replace(/\/snippets\//gi,"-snippets/");var b=a.split("/");if(2>=b.length)return a;e.each(v,function(a,c){b[b.length-
1]=b[b.length-1].replace(a,c)});return b.join("/")}function c(a){return e.ajax({url:a,dataType:"script",cache:!0}).done(function(){ace.config.set("basePath",n(a));var b=ace.config.moduleUrl;ace.config.moduleUrl=function(a,c){return g(b.apply(this,arguments))}})}function d(a){a.originalStyling={width:a.wrapper.css("width"),height:a.wrapper.css("height"),position:a.wrapper.css("position"),zIndex:a.wrapper.css("zIndex"),left:a.wrapper.css("left"),top:a.wrapper.css("top"),bottom:a.wrapper.css("bottom"),
right:a.wrapper.css("right")};if(!a.expanded){a.wrapper.addClass("maximized");a.expanded=!0;e("body").css({overflow:"hidden"});a.originalStyling={width:a.wrapper.css("width"),height:a.wrapper.css("height"),position:a.wrapper.css("position"),zIndex:a.wrapper.css("zIndex"),left:a.wrapper.css("left"),top:a.wrapper.css("top"),bottom:a.wrapper.css("bottom"),right:a.wrapper.css("right")};var b={width:"100%",height:"100%",position:"fixed",zIndex:2E4,left:0,top:0,bottom:0,right:0};a.wrapper.css(b);var c=
a.wrapper.get(0);c.requestFullscreen?c.requestFullscreen():c.msRequestFullscreen?c.msRequestFullscreen():c.mozRequestFullScreen?c.mozRequestFullScreen():c.webkitRequestFullscreen&&c.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);a.originalDimensions={maxLines:a.editor.renderer.$maxLines,minLines:a.editor.renderer.$minLines,desiredHeight:a.editor.renderer.$desiredHeight};delete a.editor.renderer.$maxLines;delete a.editor.renderer.$minLines;delete a.editor.renderer.desiredHeight;a.wrapper.find(".ace_editor, .ace_content").css({width:"100%",
height:"100%"});a.editor.resize();a.diffing&&(a.originalDiffContainerStyling={left:a.diffContainer.css("left"),top:a.diffContainer.css("top"),width:a.diffContainer.css("width"),height:a.diffContainer.css("height"),position:a.diffContainer.css("position")},a.diffContainer.css(b),a=a.differ.getEditors(),delete a.left.renderer.$maxLines,delete a.left.renderer.$minLines,delete a.left.renderer.desiredHeight,delete a.right.renderer.$maxLines,delete a.right.renderer.$minLines,delete a.right.renderer.desiredHeight,
a.left.resize(),a.right.resize())}}function d(a){if(!a.expanded){a.wrapper.addClass("maximized");a.expanded=!0;e("body").css({overflow:"hidden"});a.originalStyling={width:a.wrapper.css("width"),height:a.wrapper.css("height"),position:a.wrapper.css("position"),zIndex:a.wrapper.css("zIndex"),left:a.wrapper.css("left"),top:a.wrapper.css("top"),bottom:a.wrapper.css("bottom"),right:a.wrapper.css("right")};var b={width:"100%",height:"100%",position:"fixed",zIndex:2E4,left:0,top:0,bottom:0,right:0};a.wrapper.css(b);
if(a.supportsTrueFullScreen){var c=a.wrapper.get(0);c.requestFullscreen?c.requestFullscreen():c.msRequestFullscreen?c.msRequestFullscreen():c.mozRequestFullScreen?c.mozRequestFullScreen():c.webkitRequestFullscreen&&c.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}a.originalDimensions={maxLines:a.editor.renderer.$maxLines,minLines:a.editor.renderer.$minLines,desiredHeight:a.editor.renderer.$desiredHeight};delete a.editor.renderer.$maxLines;delete a.editor.renderer.$minLines;delete a.editor.renderer.desiredHeight;
a.wrapper.find(".ace_editor, .ace_content").css({width:"100%",height:"100%"});a.editor.resize();a.diffing&&(a.originalDiffContainerStyling={left:a.diffContainer.css("left"),top:a.diffContainer.css("top"),width:a.diffContainer.css("width"),height:a.diffContainer.css("height"),position:a.diffContainer.css("position")},a.diffContainer.css(b),a=a.differ.getEditors(),delete a.left.renderer.$maxLines,delete a.left.renderer.$minLines,delete a.left.renderer.desiredHeight,delete a.right.renderer.$maxLines,
delete a.right.renderer.$minLines,delete a.right.renderer.desiredHeight,a.left.resize(),a.right.resize())}}function a(a){if(a.expanded&&(a.originalStyling&&a.originalDimensions)&&(a.supportsTrueFullScreen&&(document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()),a.wrapper.removeClass("maximized"),a.expanded=!1,e("body").css({overflow:"auto"}),
a.wrapper.css(a.originalStyling),a.editor.renderer.$maxLines=a.originalDimensions.maxLines,a.editor.renderer.$minLines=a.originalDimensions.minlines,a.editor.renderer.desiredHeight=a.originalDimensions.desiredHeight,a.editor.resize(),a.diffing)){a.diffContainer.css(e.extend(a.originalDiffContainerStyling,{position:"absolute",top:0,left:0,zIndex:7}));var b=a.differ.getEditors();b.left.renderer.$maxLines=a.originalDimensions.maxLines;b.left.renderer.$minLines=a.originalDimensions.minlines;b.left.renderer.desiredHeight=
a.originalDimensions.desiredHeight;b.right.renderer.$maxLines=a.originalDimensions.maxLines;b.right.renderer.$minLines=a.originalDimensions.minlines;b.right.renderer.desiredHeight=a.originalDimensions.desiredHeight;b.left.resize();b.right.resize()}}function b(b){b.expanded=!1;b.fullScreenToggle.on("click",function(c){c.preventDefault();b.expanded?a(b):d(b);return!1})}function p(a,b){clearTimeout(a.setLineNumberTimeout);a.setLineNumberTimeout=setTimeout(function(){a.editor.resize(!0);a.editor.gotoLine(b,
0,!0);a.editor.scrollToLine(b,!0,!0,function(){});a.diffing&&!diffSourced&&(a.differ.getEditors().right.resize(!0),a.differ.getEditors().right.gotoLine(b,0,!0),a.differ.getEditors().right.scrollToLine(b,!0,!0,function(){}))},50)}function m(a,b,c){c||(a.suppressChangeEvent=!0,k.clearTimeout(a.suppressChangeTimeout),a.suppressChangeTimeout=k.setTimeout(function(){a.suppressChangeEvent=!1},100));a.editor.setValue(b,-1);a.isTextArea&&a.sourceElement.val(b);a.diffing&&!c&&a.differ.getEditors().right.setValue(b,
-1)}function q(a){a.suppressChangeEvent||(a.sourceElement.trigger("evolutionCodeEditorChange"),a.isTextArea&&a.sourceElement.val(a.editor.getValue()).change())}function t(a,b){ace.config.loadModule("ace/ext/language_tools",function(c){var d={enableSnippets:!0,enableBasicAutocompletion:!0,enableLiveAutocompletion:!0};if(a.differ){var e=a.differ.getEditors();e&&e.right&&e.right.setOptions(d)}a.editor&&a.editor.setOptions(d);b&&(c.setCompleters([c.snippetCompleter,c.textCompleter]),c.addCompleter({identifierRegexps:[/[a-zA-Z_0-9#\.\$\-\u00A2-\uFFFF]/],
getCompletions:function(a,c,d,e,g){b({editor:a,session:c,pos:d,prefix:e}).done(function(a){g(null,a.results)})},getDocTooltip:function(a){a.doc&&!a.docHTML&&(a.docHTML=a.doc)}}))})}function l(a){if(y[a])return y[a];var b=a;a=(a||"").toLowerCase();a=a.replace(/[+-]/ig," ");a=a.replace(/ctrl/ig,"control");a=a.replace(/(opt|alt)/ig,"option");a=a.replace(/shft/ig,"shift");a=a.replace(/(cmd|meta)/ig,"command");a=e.trim(a.split(" ").sort().join(" "));return y[b]=a}var w=!1,r=!1,v={_:"_5F00_","-":"_2D00_"},
s={light:"clouds",dark:"fusion"},y={},x={init:function(d){var g=e.extend({},e.fn.evolutionCodeEditor.defaults,d||{});!1===w&&(w=c(g.editorUrl));g.baseUrl=n(g.editorUrl);return this.each(function(){var c=e(this).data("_code_editor_context"),d=!1;c||(d=!0,c={},e(this).data("_code_editor_context",c));e.extend(c,g);c.sourceElement=e(this).hide();c.supportsTrueFullScreen=(document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled)&&(this.requestFullscreen||this.msRequestFullscreen||
this.mozRequestFullScreen||this.webkitRequestFullscreen);var f;if(f=!c.supportsTrueFullScreen)try{f=k.self!==k.top}catch(v){f=!0}f&&(c.enableFullScreen=!1);e(document).on("mozfullscreenchange webkitfullscreenchange fullscreenchange MSFullscreenChange",function(){document.fullscreenElement||(document.webkitFullscreenElement||document.mozFullScreenElement)||a(c)});w.done(function(){var a=c.theme||"light";s[a]!==h&&(c.theme=s[a]);c.editorOptions={mode:0===(c.mode||"text").indexOf("ace/mode/")?c.mode||
"text":"ace/mode/"+(c.mode||"text"),theme:0===(c.theme||"light").indexOf("ace/theme/")?c.theme||"light":"ace/theme/"+(c.theme||"light"),showGutter:c.gutter===h?!0:c.gutter,showPrintMargin:!1,wrap:c.wordWrap};a=0<(c.sourceElement.attr("style")||"").length;c.isTextArea=c.sourceElement.is("textarea");c.readOnly===h&&(c.readOnly=!c.isTextArea);c.minLines===h||a||(c.editorOptions.minLines=c.minLines);c.maxLines&&!a?(c.editorOptions.maxLines=c.maxLines,c.editorOptions.autoScrollEditorIntoView=!0):(delete c.editorOptions.maxLines,
delete c.editorOptions.autoScrollEditorIntoView);c.readOnly?e.extend(c.editorOptions,{readOnly:!0,highlightGutterLine:!1,highlightActiveLine:!1}):e.extend(c.editorOptions,{readOnly:!1,highlightGutterLine:!0,highlightActiveLine:!0});d&&(a=e.grep((c.sourceElement.attr("class")||"").split(" "),function(a){return 0!==a.indexOf("ui-")}).join(" "),c.wrapper=e("<div></div>").hide().addClass("evolution-code-editor").addClass(a).attr("style",c.sourceElement.attr("style")).insertBefore(c.sourceElement),c.enableFullScreen&&
(c.fullScreenToggle=e('<a href="#" class="fullscreen">Fullscreen</a>'),c.fullScreenToggle.appendTo(c.wrapper),b(c)),c.innerElement=e("<div></div>").appendTo(c.wrapper).css({width:"100%",height:"100%"}).show(),c.isTextArea?c.innerElement.text(c.sourceElement.val()):c.innerElement.text(c.sourceElement.text()),c.editor=ace.edit(c.innerElement.get(0)),c.wrapper.show(),c.editor.on("change",function(a){q(c)}),e.each({right:"gotoright",left:"gotoleft",up:"golineup",down:"golinedown"},function(a,b){var d=
c.editor.commands.commands[b];c.editor.commands.removeCommand(d);var e=d.exec;c[a]&&(d.exec=function(){c[a].apply(this,c.sourceElement)&&e.apply(this,arguments)});c.editor.commands.addCommand(d)}),e.each(g.commandOverrides,function(a,b){c.editor.commands.on("exec",function(c){c.command&&(c.command.bindKey&&(l(c.command.bindKey.mac)==l(a)||l(c.command.bindKey.win)==l(a)))&&(b()||c.preventDefault())})}));a=e.grep(c.wrapper.attr("class").split(" "),function(a){return 0!==a.indexOf("theme-")}).join(" ");
c.wrapper.attr("class",a);c.wrapper.addClass("theme-"+c.theme);c.editor.setOptions(c.editorOptions);d&&(!c.editorOptions.maxLines&&32>c.wrapper.height())&&(c.editorOptions.minLines=c.minLines||1,c.editorOptions.maxLines=c.maxLines||20,c.editor.setOptions(c.editorOptions));if(c.sourceComparison!==h&&null!==c.sourceComparison){c.diffing=!0;if(!1===r){var a=g.editorUrl.replace(/ace.js$/,"acediff.js"),f=g.editorUrl.replace(/ace.js$/,"diffmatchpatch.js");r=e.when.apply(e,[e.ajax({url:a,dataType:"script",
cache:!0}),e.ajax({url:f,dataType:"script",cache:!0})])}r.done(function(){if(c.differ)g=c.differ.getEditors(),g.left.setValue(c.sourceComparison,-1),g.right.setOptions(c.editorOptions),g.left.setOptions(c.editorOptions),g.left.setReadOnly(!0),g.right.setReadOnly(c.readOnly);else{c.wrapper.css({position:"relative"});var a="left"+Math.floor(1E8*Math.random()),b="left"+Math.floor(1E8*Math.random()),d="left"+Math.floor(1E8*Math.random());c.diffContainer=e('<div class="acediff-container"><div><div id="'+
a+'" class="acediff-left-editor"></div></div><div id="'+b+'" class="acediff-gutter"></div><div><div id="'+d+'" class="acediff-right-editor"></div></div></div>');c.diffContainer.css({position:"absolute",top:0,left:0,width:c.wrapper.width(),height:c.wrapper.height(),zIndex:6});c.diffContainer.appendTo(c.wrapper);c.differ=new AceDiff({mode:c.editorOptions.mode,theme:c.editorOptions.theme||"light",left:{id:a,content:c.sourceComparison,editable:!1,copyLinkEnabled:c.readOnly?!1:!0},right:{id:d,content:c.editor.getValue(),
copyLinkEnabled:!1,editable:c.readOnly?!1:!0},classes:{gutterID:b}});var g=c.differ.getEditors();g.right.on("change",function(a){a=g.right.getValue();m(c,a,!0);q(c)})}})}else c.diffing?(c.diffing=!1,a=c.differ.getEditors(),f=a.right.getValue(),a.left.destroy(),a.right.destroy(),c.differ.destroy(),c.diffContainer.remove(),c.suppressChangeEvent=!0,c.editor.setValue(f,-1),c.suppressChangeEvent=!1,delete c.differ,delete c.diffContainer):(c.diffing=!1,c.autoComplete&&t(c,c.autoComplete));c.line&&p(c,c.line);
c.sourceElement.trigger("evolutionCodeEditorReady")})})},focus:function(a){var b=e(this).data("_code_editor_context");return b?(a!==h&&(!0===a?b.editor.focus():b.editor.blur()),b.diffing?b.differ.getEditors().right.isFocused():b.editor.isFocused()):!1},val:function(a){var b=e(this).data("_code_editor_context");return b?a!==h?(m(b,a||""),a):b.editor.getValue():""},scrollTop:function(a){var b=e(this).data("_code_editor_context");return b?a!==h?(b.editor.session.setScrollTop(a),b.diffing&&!diffSourced&&
b.differ.getEditors().right.session.setScrollTop(a),a):b.editor.session.getScrollTop():0},line:function(a){var b=e(this).data("_code_editor_context");return b?a!==h?(p(b,a||""),a||1):(b.editor.getSelectionRange().start.row||0)+1:1},autoComplete:function(a){var b=e(this).data("_code_editor_context");b&&t(b,a)},fullscreen:function(b){var c=e(this).data("_code_editor_context");if(c)return b!==h?(b?d(c):a(c),b):c.expanded},selectedText:function(){var a=e(this).data("_code_editor_context");return a?a.editor.getSelectedText():
""},__resize:function(){var a=e(this).data("_code_editor_context");a&&(a.diffing?(a.differ.getEditors().right.resize(),a.differ.getEditors().left.resize()):a.editor.resize())}};e.fn.evolutionCodeEditor=function(a){if(x[a])return x[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)e.error("Method "+a+" does not exist on jQuery.evolutionCodeEditor");else return x.init.apply(this,arguments)};e.fn.evolutionCodeEditor.defaults={editorUrl:"",mode:h,theme:h,minLines:h,maxLines:h,
readOnly:h,gutter:h,wordWrap:!1,enableFullScreen:!0,sourceComparison:h,autoComplete:h,commandOverrides:{}};return{}},jQuery,window);u("plugin.evolutionComposer",["events.textinput","module.html"],function(f,e,k,h,n){var g=function(a,b){a=k(a);var d=a.data("__COMPOSER_CONTEXT");!d&&b&&(d=c(a,b),a.data("__COMPOSER_CONTEXT",d));return d},c=function(b,c){var e=k.extend({},k.fn.evolutionComposer.defaults,c||{}),e={input:b,settings:e,plugins:k.map(e.plugins,function(a){return"string"==typeof a?k.fn.evolutionComposer.plugins[a]:
a}),ranges:[],activePlugin:!1};e.pluginContext=d(e);e.input.evolutionHighlight();a(e);return e},d=function(a){return{settings:a.settings,input:a.input,data:function(b,c){return"undefined"!==typeof c?a.input.data(b,c):a.input.data(b)},val:function(b){return"undefined"!==typeof b?a.input.val(b):a.input.val()},release:function(){a.activePlugin.onDeactivate&&a.activePlugin.onDeactivate.call(a.input,a.pluginContext);a.activePlugin=!1},caretPosition:function(){return l(a.input)},currentWord:function(b){b=
k.extend({allowedWhiteSpaceBeforeCaret:0,allowedWhiteSpaceAfterCaret:0},b||{});var c=b.caretPosition||l(a.input),d="",e=k(a.input).val(),g="",p=0,m=c,f=0;if(c<e.length&&"\n"!==e[c]&&"\t"!==e[c]){g=e.substring(c);p=q(g);0>p&&(p=g.indexOf("\n"));0>p&&(p=g.indexOf("\t"));0>p&&(p=g.length);for(f=0;f<b.allowedWhiteSpaceAfterCaret;f++)if(0<p){var r=e.substring(c+p+1);nextWhiteSpaceIndex=q(r);nextWhiteSpaceIndex=-1===nextWhiteSpaceIndex?r.length:nextWhiteSpaceIndex;if(0<nextWhiteSpaceIndex)p+=nextWhiteSpaceIndex+
1;else break}0<p&&(m=0,d+=g.substring(0,p))}if(0<c&&"\n"!==e[c-1]&&"\t"!==e[c-1]){g=e.substring(0,c);p=t(g);for(f=0;f<b.allowedWhiteSpaceBeforeCaret;f++)if(0<p)if(c=t(e.substring(0,p)),c!==p)p=c;else break;p===g.length&&(p=g.lastIndexOf("\n"));p===g.length&&(p=g.lastIndexOf("\t"));p===g.length&&(p=g.length-1);p<g.length-1&&(m=p+1,d=g.substring(m)+d)}if(b.additionalWhiteSpaceSymbols)for(f=0;f<d.length;f++)if(-1==k.inArray(d[f],b.additionalWhiteSpaceSymbols)){d=d.substring(f);m+=f;break}return{value:d,
start:m,stop:m+d.length}},replace:function(b,c,d){var e=a.input.val();a.input.val(e.substring(0,b)+d+e.substring(c))},clearHighlights:function(b){var c=[];k.each(a.ranges,function(a,d){b&&d.className===b||c.push(d)});a.ranges=c;a.input.evolutionHighlight({ranges:a.ranges})},addHighlight:function(b){a.ranges.push(b)},renderHighlights:function(){a.input.evolutionHighlight({ranges:a.ranges})}}},a=function(a){a.input.bind({keypress:function(c){b(a,"onkeypress",c)},keydown:function(c){b(a,"onkeydown",
c)},textinput:function(c){p(a,c);b(a,"oninput",c);m(a,!1)}})},b=function(a,b,c){var d=!0;a.activePlugin&&a.activePlugin[b]&&(d=a.activePlugin[b].call(c.target,a.pluginContext,c));d?a[b]&&((d=a[b].call(c.target,c))||c.preventDefault()):c.preventDefault()},p=function(a,b){a.activePlugin||k.each(a.plugins,function(b,c){if(c.shouldActivate&&!0===c.shouldActivate.call(a.input,a.pluginContext))return a.activePlugin=c,c.onActivate&&c.onActivate.call(a.input,a.pluginContext),!1})},m=function(a,b){k.each(a.plugins,
function(c,d){d.onTransform&&d.onTransform.call(a.input,a.pluginContext,b)})},q=function(a){var b=[];k.each([" ","\t","\n"],function(c,d){var e=a.indexOf(d);0<=e&&b.push(e)});b.sort();return 0<b.length?b[0]:-1},t=function(a){var b=[];k.each([" ","\t","\n"],function(c,d){var e=a.lastIndexOf(d);0<=e&&b.push(e)});b.sort();return 0<b.length?b[b.length-1]:-1},l=function(a){a=a.get(0);if(a.selectionStart)return a.selectionStart;if(document.selection){var b=document.selection.createRange();if(null===b)return 0;
a=a.createTextRange();var c=a.duplicate();a.moveToBookmark(b.getBookmark());c.setEndPoint("EndToStart",a);return c.text.length}return 0},w=function(a){"undefined"!==typeof k.fn.evolutionResize&&a.input.evolutionResize().bind("evolutionResize",function(){a.input.evolutionHighlight("resize",a.input.width(),a.input.height())})},r={init:function(a){return this.filter("textarea").each(function(){var b=k(this),c=g(b,a);w(c);c.input.evolutionHighlight("resize",c.input.width(),c.input.height());if(null!==
c){k.each(c.plugins,function(a,d){d.init&&d.init.call(b,c.pluginContext)});c.settings.focus&&setTimeout(function(){b.focus()},10);var d=k.trim(c.input.val());0<d.length&&r.val.call(c.input,d)}})},val:function(a){if("undefined"!==typeof a){var b=g(this);b&&(b.input.val(e.decode(a)),m(b,!0),b.input.trigger("input"))}else{var b=g(this),c="";b&&(c=b.input.val(),k.each(b.plugins,function(a,d){d.val&&(c=d.val.call(b.input,c,b.pluginContext))}));return c}return this},onkeydown:function(a){var b=g(this);
b&&(b.onkeydown=a);return this},oninput:function(a){var b=g(this);b&&(b.oninput=a);return this},resize:function(a,b){var c=g(this);c&&c.input.evolutionHighlight("resize",a,b);return this},release:function(){var a=g(this);a&&a.activePlugin&&(a.activePlugin.onDeactivate&&a.activePlugin.onDeactivate.call(a.input,a.pluginContext),a.activePlugin=!1);return this}};k.fn.evolutionComposer=function(a){if(r[a])return r[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)k.error("Method "+
a+" does not exist on jQuery.evolutionComposer");else return r.init.apply(this,arguments)};k.fn.evolutionComposer.defaults={plugins:[],focus:!1};k.fn.evolutionComposer.plugins={};return{}},jQuery,window);u("plugin.evolutionFeature",function(f,e,k){var h=function(e,c){return c.replace(/\{content_type_name\}/gi,e.settings.contentTypeName)},n=function(e){f.telligent.evolution.messaging.subscribe("ui-feature",function(c){c.featured?e.toggle.empty().append("<span></span>"+f.telligent.evolution.html.encode(h(e,
e.settings.editFeatureText))):e.toggle.empty().append("<span></span>"+f.telligent.evolution.html.encode(h(e,e.settings.addFeatureText)))})};f.fn.evolutionFeature=function(e){var c=f.extend({},f.fn.evolutionFeature.defaults,e||{});return this.each(function(){var d={element:f(this),toggle:null,settings:c};d.toggle=f("<a></a>").attr({href:d.settings.panelUrl});d.element.append(d.toggle);d.settings.initialState?d.toggle.append("<span></span>"+f.telligent.evolution.html.encode(h(d,d.settings.editFeatureText))):
d.toggle.append("<span></span>"+f.telligent.evolution.html.encode(h(d,d.settings.addFeatureText)));n(d)})};f.fn.evolutionFeature.defaults={contentId:"",contentTypeId:"",typeId:"",panelUrl:"",initialState:!1,contentTypeName:"",editFeatureText:"Edit featured",addFeatureText:"Feature"};return{}},jQuery,window);u("plugin.evolutionHighlight",function(f,e,k){var h=function(a,c){var d=a.data("_HIGHLIGHTER_CONTEXT");if("undefined"===typeof d||null===d)d={selection:a.filter("textarea"),settings:f.extend({},
f.fn.evolutionHighlight.defaults,c||{})},n(d),a.data("_HIGHLIGHTER_CONTEXT",d);return d},n=function(a){a.wrapper=f("<div></div>");a.mirror=f("<div></div>");var c={position:"relative",width:a.selection.outerWidth(),height:a.selection.outerHeight()};f.each(["margin-left","margin-right","margin-top","margin-bottom"],function(d,e){c[e]=a.selection.css(e);a.selection.css(e,0)});var d={position:"absolute",top:"0px",left:"0px",zIndex:"0",borderTopColor:"transparent",borderBottomColor:"transparent",borderLeftColor:"transparent",
borderRightColor:"transparent",backgroundColor:a.selection.css("backgroundColor"),color:"transparent",width:a.selection.width(),height:a.selection.height(),overflow:"hidden",whiteSpace:"normal"};f.each(a.settings.styles,function(c,e){d[e]=a.selection.css(e)});var e={position:"absolute",top:"0px",left:"0px",zIndex:"1",backgroundColor:"transparent",width:a.selection.width(),height:a.selection.height()};a.wrapper.css(c).addClass("highlighter");a.mirror.css(d);a.selection.css(e);a.mirror.css("color",
a.mirror.css("background-color"));a.selection.before(a.wrapper);a.wrapper.append(a.selection);a.wrapper.append(a.mirror)},g=/\s\s/gi,c=/\n/gi,d=function(a){var d={};f.each(a.settings.ranges,function(a,b){d[b.start]=d[b.start]||[];d[b.start].push(f.extend({},b,{index:a}));d[b.stop]=d[b.stop]||[];d[b.stop].push(b)});var e=f.telligent.evolution.html.encode(a.selection.val());newValue=[];for(var q=spanDepth=0;q<e.length;q++)"undefined"!==typeof d[q]&&f.each(d[q],function(a,b){b.start===q?(newValue[newValue.length]=
'<span class="'+b.className+'" style="white-space:normal;" data-index="'+b.index+'">',spanDepth++):(newValue[newValue.length]="</span>",spanDepth--)}),newValue[newValue.length]=e.charAt(q);0<spanDepth&&(newValue[newValue.length]="</span>");var e=newValue.join("").replace(c,"<br />").replace(g,"&nbsp; "),t=document.createElement("span");t.innerHTML=e;a.mirror.empty().get(0).appendChild(t);a.selection.off("click").on("click",function(c){f("span",a.mirror).each(function(){var d=f(this),e=d.data("index");
if(e!==k){var g=d.offset();g.top<=c.pageY&&(g.top+d.height()>=c.pageY&&g.left<=c.pageX&&g.left+d.width()>=c.pageX)&&a.selection.trigger("evolutionRangeClick",a.settings.ranges[e])}})})},a={init:function(a){var c=h(this,a);c.settings=f.extend({},f.fn.evolutionHighlight.defaults,a||{});d(c);return this},clear:function(){var a=h(this,null);if(null!==a)return a.mirror.html(""),this},resize:function(a,c){var d=h(this,null);if(null!==d){var e={width:a,height:c};d.mirror.css(e);d.selection.css(e);d.wrapper.css({width:d.selection.outerWidth(),
height:d.selection.outerHeight()});return this}},css:function(a){var c=h(this,null);if(null!==c)return c.wrapper.css(a),this}};f.fn.evolutionHighlight=function(b){if(a[b])return a[b].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof b&&b)f.error("Method "+b+" does not exist on jQuery.evolutionHighlight");else return a.init.apply(this,arguments)};f.fn.evolutionHighlight.defaults={ranges:[],styles:"border-top-width border-top-style border-bottom-width border-bottom-style border-right-width border-right-width-value border-right-style border-right-style-value border-left-width border-left-width-value border-left-style border-left-style-value font-family font-size font-size-adjust font-stretch font-style font-variant font-weight padding-bottom padding-left padding-right padding-top letter-spacing line-height text-align text-indent word-spacing".split(" ")};
return{}},jQuery,window);u("plugin.evolutionInlineTagEditor",function(f,e,k){var h={},n=function(c,a){if(c.internal.isInitialized){for(var b=a.split(/[,;]/g),e=[],g=0;g<b.length;g++){var q=f.trim(b[g]);q&&(e[e.length]=q)}c.settings.onSave(e,function(){c.settings.currentTags=e})}},g=function(d){return this.each(function(){var a={settings:f.extend({},f.fn.evolutionInlineTagEditor.defaults,d||{}),internal:{state:f(this)}};f(this).data("evolutionTagInlineEditor_context",a);f(this).html()||f(this).text(a.settings.editButtonText);
c(a)})},c=function(c){var a=f("<div></div>").addClass(c.settings.editorCssClass).attr("style","display: none;"),b=f('<label for="tag-area"></label>').hide(),e=f('<textarea id="tag-area"></textarea>').attr("cols","40").attr("rows","2");if(c.settings.allTags&&0<c.settings.allTags.length)var g=f('<input type="button" />').val(c.settings.selectTagsText);var q=f('<input type="button" />').val(c.settings.saveTagsText),t=f('<input type="button" />').val(c.settings.cancelText),l=f('<div style="white-space: nowrap; padding-top: 4px;"><table width="100%" cellspacing="0" cellpadding="0" border="0"><tbody><td align="left"></td><td align="right"></td></tr></tbody></table></div>');
l.find("td:eq(1)").append(q);l.find("td:eq(1)").append(t);g&&l.find("td:first").append(g);a.append(b);a.append(e);a.append(l);e.evolutionTagTextBox({allTags:c.settings.allTags});a.glowPopUpPanel({cssClass:c.settings.editorCssClass,position:"updown",zIndex:500,hideOnDocumentClick:!1});f(c.internal.state).bind("click.evolutionInlineTagEditor",function(b){a.glowPopUpPanel("hide").glowPopUpPanel("show",f(this));e.val(0<c.settings.currentTags.length?c.settings.currentTags.join(", "):"");return!1});q.bind("click.evolutionInlineTagEditor",
function(b){n(c,e.attr("value"));a.glowPopUpPanel("hide");return!1});t.bind("click.evolutionInlineTagEditor",function(b){a.glowPopUpPanel("hide");return!1});g&&g.bind("click.evolutionInlineTagEditor",function(a){e.evolutionTagTextBox("openTagSelector");return!1});c.internal.state.after(a);c.internal.isInitialized=!0};f.fn.evolutionInlineTagEditor=function(c){if(c in h)return h[c].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof c&&c)f.error("Method "+c+" does not exist on jQuery.fn.evolutionInlineTagEditor");
else return g.apply(this,arguments)};f.extend(f.fn.evolutionInlineTagEditor,{defaults:{allTags:[""],currentTags:[""],editorCssClass:"tags-editor",editButtonText:"Edit",selectTagsText:"Select Tags",saveTagsText:"Save",cancelText:"Cancel",onSave:function(c,a){}}});return{}},jQuery,window);u("plugin.evolutionLike",function(f,e,k){var h=!1,n=!1,g=function(b){var c=b.settings.format;b.hasCount&&(c=c.replace(/\{count\}/gi,'<span class="like-count who-likes"></span>'));b.hasToggle&&(c=c.replace(/\{toggle\}/gi,
'<span class="like-toggle"><a href="#" class="internal-link"></a></span>'));b.hasMessage&&(c=c.replace(/\{message\}/gi,'<span class="like-message"></span>'));b.element.html(c);b.hasCount&&(b.countWrapper=b.element.find("span.like-count"),b.countWrapper.html(b.settings.initialCount),b.countWrapper.attr("data-count",b.settings.initialCount));b.hasToggle&&(b.toggleLink=b.element.find("span.like-toggle a"),b.toggleLink.evolutionToggleLink({onHtml:"<span></span>"+b.settings.unlikeText,offHtml:"<span></span>"+
b.settings.likeText,onTitle:"",offTitle:"",processingHtml:"<span></span>...",changeState:function(c){a(c,b)},onCssClass:"internal-link like-on",offCssClass:"internal-link like-off",processingCssClass:"internal-link processing",val:"true"===b.settings.initialState}));b.hasMessage&&(b.messageWrapper=b.element.find("span.like-message"),b.messageWrapper.html(b.settings.initialMessage))},c=function(a,b){var c="";if(0<b.count){var d=0;b.accessingLikes?1===b.count?c=a.settings.whoLikesAccessingText:2===
b.count?(c=a.settings.whoLikesAccessingTwoText,d=-1):2<b.count&&(c=a.settings.whoLikesAccessingMultipleText,d=-1):1===b.count?c=a.settings.whoLikesOtherText:2===b.count?(d=-1,c=a.settings.whoLikesOtherTwoText):2<b.count&&(d=-1,c=a.settings.whoLikesOtherMultipleText);c=c.replace(/\{count\}/gi,b.count+d);c=c.replace(/\{user_profile_url\}/gi,b.latestUserProfileUrl);c=c.replace(/\{user_display_name\}/gi,b.latestUserDisplayName)}return c},d=function(a,b,d){var e=c(a,{count:b.count,accessingLikes:d,latestUserProfileUrl:null!=
b.latestLike&&null!=b.latestLike.User?b.latestLike.User.ProfileUrl:null,latestUserDisplayName:null!=b.latestLike&&null!=b.latestLike.User?b.latestLike.User.DisplayName:null});f.telligent.evolution.messaging.publish("ui.like",{contentId:a.settings.contentId,contentTypeId:a.settings.contentTypeId,typeId:a.settings.typeId,count:b.count,liked:d,message:e},{crossWindow:!0})},a=function(a,b){if(a)b.settings.onLike(b.settings.contentId,b.settings.contentTypeId,b.settings.typeId,function(a){d(b,a,!0)});else b.settings.onUnlike(b.settings.contentId,
b.settings.contentTypeId,b.settings.typeId,function(a){d(b,a,!1)})},b=function(a,b){return f.telligent.evolution.get({url:f.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/like.json",data:{ContentId:b.contentId,TypeId:b.typeId},cache:!1}).then(function(a){return null!=a.Like})},p=function(a){n||(n=!0,f.telligent.evolution.messaging.subscribe("like.created",function(b){m(a,b,!0)}),f.telligent.evolution.messaging.subscribe("like.deleted",function(b){m(a,b,!1)}))},m=function(a,d,e){b(a,d).done(function(b){b=
c(a,{count:d.total,accessingLikes:b,latestUserProfileUrl:d.latestUser.profileUrl,latestUserDisplayName:d.latestUser.displayName});f.telligent.evolution.messaging.publish("ui.like",{contentId:d.contentId,contentTypeId:d.contentTypeId,typeId:d.typeId,count:d.total,liked:e,message:b})})},q=function(a){f.telligent.evolution.messaging.subscribe("ui.like",function(b){b.contentId===a.settings.contentId&&(b.contentTypeId===a.settings.contentTypeId&&b.typeId===a.settings.typeId)&&(a.hasToggle&&a.toggleLink.evolutionToggleLink("val",
b.liked),a.hasCount&&(a.countWrapper.html(b.count),a.countWrapper.attr("data-count",b.count)),a.hasMessage&&a.messageWrapper.html(b.message))})};f.fn.evolutionLike=function(a){var b=f.extend({},f.fn.evolutionLike.defaults,a||{});return this.each(function(){var a={element:f(this),settings:b,hasCount:0<=b.format.indexOf("{count}"),hasToggle:0<=b.format.indexOf("{toggle}"),hasMessage:0<=b.format.indexOf("{message}")};g(a);q(a);p(a)})};f.fn.evolutionLike.delegatePopups=function(a){if(!h){h=!0;var b=f.extend({},
f.fn.evolutionLike.defaults,a||{}),c=f.telligent.evolution.template.compile(b.likersTemplate),d=f.telligent.evolution.template.compile(b.likersPopupTemplate),e=function(a,c,d){b.onList(a.contentId,a.contentTypeId,a.typeId,function(a){d(a)},a.pageSize,c)},g=function(a,g){var p=0,m=f(c(a)),t=f(d({likers:m,hasMorePages:a.hasMorePages,showMoreText:b.modalShowMoreText})),q=t.find("ul"),h=t.find(".show-more"),k=b.onOptions(f(g).closest(b.delegatedSelector));q.html(m);h.on("click",function(a){a.preventDefault();
p++;e(k,p,function(a){q.append(c(a));a.hasMorePages?h.show():h.hide();q.scrollTop(q[0].scrollHeight)})});f.glowModal({title:b.modalTitleText,html:t,width:450,height:"100%"})};(function(){f(b.containerSelector).on("click",b.delegatedSelector+" .who-likes",function(a){var c=f(this);a=b.onOptions(f(c).closest(b.delegatedSelector));e(a,0,function(a){g(a,c)})})})()}};f.fn.evolutionLike.defaults={contentId:"",contentTypeId:"",typeId:"",initialState:!1,initialMessage:"",initialCount:0,format:"",onLike:function(a,
b,c,d){},onUnlike:function(a,b,c,d){},likeText:"Like",unlikeText:"Unlike",whoLikesOtherText:'<a href="{user_profile_url}" class="internal-link view-user-profile">{user_display_name}</a> likes this',whoLikesOtherTwoText:'<a href="{user_profile_url}" class="internal-link view-user-profile">{user_display_name}</a> <span class="who-likes">and 1 other</span> like this.',whoLikesOtherMultipleText:'<a href="{user_profile_url}" class="internal-link view-user-profile">{user_display_name}</a> and <span class="who-likes">{count} others</span> like this.',
whoLikesAccessingText:"You like this",whoLikesAccessingTwoText:'You and <span class="who-likes">1 other</span> like this',whoLikesAccessingMultipleText:'You and <span class="who-likes">{count} others</span> like this',modalTitleText:"People who like this",modalShowMoreText:"Show more",onList:function(a,b,c,d){},onOptions:function(a){},containerSelector:"",delegatedSelector:"",delay:500,likersTemplate:' <% foreach(likers, function(liker) { %>      <li class="content-item">          <div class="full-post-header"></div>          <div class="full-post">              <span class="avatar">                  <a href="<%: liker.profileUrl %>"  class="internal-link view-user-profile">                      <% if(liker.avatarHtml) { %>                          <%= liker.avatarHtml %>                      <% } else { %>                          <img src="<%: liker.avatarUrl %>" alt="" border="0" width="32" height="32" style="width:32px;height:32px" />                      <% } %>                  </a>              </span>              <span class="user-name">                  <a href="<%: liker.profileUrl %>" class="internal-link view-user-profile"><%= liker.displayName %></a>              </span>          </div>          <div class="full-post-footer"></div>      </li>  <% }); %> ',
likersPopupTemplate:' <div class="who-likes-list">      <div class="content-list-header"></div>      <ul class="content-list"><%= likers %></ul>      <div class="content-list-footer"></div>      <% if(hasMorePages) { %>          <a href="#" class="show-more"><%= showMoreText %></a>     <% } %>  </div> '};return{}},jQuery,window);u("plugin.evolutionMasonry",["lib.util"],function(f,e,k,h){function n(a){return e(document.createElement("div")).html("&nbsp;").addClass(a.columnClass).css({"float":"left",
minHeight:"1px",overflow:"hidden"})}function g(a){for(var b=0;b<a.columns.length;b++)e(a.columns[b]).empty()}function c(a,c){for(var d,g=d=null,p=0;p<a.columns.length;p++)if(null===d||null===g)d=a.columns[p],g=a.columns[p].height();else{var m=a.columns[p].height();m<g&&(d=a.columns[p],g=m)}b(a,e(c).get(0),a.reflow);d.append(c)}function d(a,b,d){a.rendering=!0;b||(b=a.children,g(a));e.each(b,function(b,d){var g=e(d).find("img:first");if(0<g.length&&!g.get(0).complete)g.on("load",function(){c(a,d)});
else c(a,d)});a.rendering=!1}function a(a,b){a.scrollTop=e(k).scrollTop();b&&a.children.detach();a.container.empty();a.columns=[];var c=0,g=0,p=n(a),m=!1;p.height(1200).appendTo(a.container);g=a.container.width();p.height(0).remove();for(var f=50;c<g&&0<f;){f--;var q=n(a);m?p.before(q):q.appendTo(a.container);c+=q.outerWidth(!0);c<=g?a.columns.push(q):q.remove();m||(p.appendTo(a.container),m=!0)}m&&p.remove();d(a,null,b);e(k).scrollTop(a.scrollTop)}function b(a,b,c){if(MutationObserver){var d=e(b);
d.data("observed")||(d.data("observed",!0),(new MutationObserver(function(){var a=d.data("masonryLastHeight"),b=d.height();a&&a==b||(d.data("masonryLastHeight",b),c())})).observe(b,{childList:!0,subtree:!0,attributes:!0}))}}function p(b){return this.each(function(){var c=e.extend({},e.fn.evolutionMasonry.defaults,b||{});c.container=e(this);c.children=c.container.children().detach();c.reflow=function(){a(c,!0)};a(c);var d;e(window).on("resized",function(b,e){clearTimeout(d);d=setTimeout(function(){c.rendering||
e&&0<Math.abs(e.oldWidth-e.newWidth)&&a(c,!0)},500)});c.container.data(m,c)})}var m="_evolutionMasonry_context",q={append:function(a){if(a&&0!=a.length){var b=e(a).filter("div");return this.each(function(){var a=e(this).data(m);a&&(a.children=a.children.add(b),d(a,b))})}},empty:function(){return this.each(function(){var b=e(this).data(m);b&&(b.container.empty(),b.children=b.container.children().detach(),a(b))})}};e.fn.evolutionMasonry=function(a){if(a in q)return q[a].apply(this,Array.prototype.slice.call(arguments,
1));if("object"!==typeof a&&a)e.error("Method "+a+" does not exist on jQuery.fn.evolutionMasonry");else return p.apply(this,arguments)};e.fn.evolutionMasonry.defaults={columnClass:"masonry-column"};return e.fn.evolutionMasonry},jQuery,window);u("plugin.evolutionModerate",function(f,e,k){var h=f.telligent.evolution,n=function(c){c.settings.onReport(c.settings.contentId,c.settings.contentTypeId,function(d){h.messaging.publish("ui.reportabuse",{contentId:c.settings.contentId,contentTypeId:c.settings.contentTypeId});
showNotification(c,d.Report)})},g=function(c){c.hideTimer&&(clearTimeout(c.hideTimer),c.hideTimer=null)};buildModerationLink=function(c){c.moderationLink=f(h.template.compile(c.settings.moderationLinkTemplate)({linkClassName:c.settings.linkClassName,resources:{moderateLinkText:c.settings.moderateLinkText}})).appendTo(c.element)};buildModerationPopup=function(c){c.popup=f("<div></div>").glowPopUpPanel({cssClass:"content-moderation",position:"downleft",zIndex:1E3,hideOnDocumentClick:!0});c.popup.bind({glowPopUpPanelShown:function(d){c.moderationLink.addClass("open")},
glowPopUpPanelHidden:function(d){c.moderationLink.removeClass("open")}})};buildModerationMenuContent=function(c,d){c.settings.onGetAdditionalLinks(function(a){var b=[],b=c.settings.supportsAbuse?c.settings.initialState?a.concat([{href:"#",className:"evolutionModerateFlagged",text:c.settings.reportedLinkText}]):a.concat([{href:"#",className:"evolutionModerateFlag",text:c.settings.reportLinkText}]):a;a=f(h.template.compile(c.settings.moderationMenuTemplate)({links:b}));a.bind("mouseleave",function(a){hideMenu(c)});
a.bind("mouseenter",function(a){g(c)});a.delegate("a","click",function(a){var b=f(a.target);b.hasClass("evolutionModerateFlag")?(a.preventDefault(),n(c)):b.hasClass("evolutionModerateFlagged")?a.preventDefault():("#"===b.attr("href")&&a.preventDefault(),c.element.trigger("evolutionModerateLinkClicked",a.target))});d(a)})};showMenu=function(c){c.popup||buildModerationPopup(c);buildModerationMenuContent(c,function(d){g(c);c.popup.glowPopUpPanel("html",d).glowPopUpPanel("show",c.moderationLink)})};hideMenu=
function(c){c.hideTimer||(c.hideTimer=setTimeout(function(){c.popup.glowPopUpPanel("hide");c.hideTimer=null},200))};formatNotificationMessage=function(c,d){return c.settings.reportedNotificationMessageText.replace(/\{NAME\}/gi,d&&d.AuthorUser&&d.AuthorUser.DisplayName?d.AuthorUser.DisplayName:"")};showNotification=function(c,d){var a=h.template.compile(c.settings.notificationTemplate)({resources:{reportedNotificationMessageText:formatNotificationMessage(c,d),undoLinkText:c.settings.undoLinkText},
contextId:c.contextId});h.notifications.show(a,{type:"moderation",duration:c.settings.notificationDuration,cssClass:""})};handleFlagMessages=function(c){h.messaging.subscribe("ui.reportabuse",function(d){c.settings.contentId===d.contentId&&c.settings.contentTypeId===d.contentTypeId&&(c.settings.initialState=!0)})};init=function(c){buildModerationLink(c);c.moderationLink.bind({mouseenter:function(d){d.preventDefault();c.popup&&c.popup.glowPopUpPanel("isShown")?hideMenu(c):showMenu(c);g(c)},mouseleave:function(d){f(d.relatedTarget).is(".content-moderation")||
0!==f(d.relatedTarget).closest(".content-moderation").length||hideMenu(c)}});handleFlagMessages(c)};f.fn.evolutionModerate=function(c){var d=f.extend({},f.fn.evolutionModerate.defaults,c||{});return this.each(function(){var a={element:f(this),settings:d};init(a)})};f.fn.evolutionModerate.defaults={contentId:"",contentTypeId:"",initialState:!1,linkClassName:"",onReport:function(c,d,a){},onGetAdditionalLinks:function(c){c([])},notificationDuration:5E3,moderateLinkText:"moderate",supportsAbuse:!0,reportLinkText:"Report as abusive",
reportedLinkText:"Reported as abusive",reportedNotificationMessageText:"{NAME}'s post has been reported. <strong>Thank you for your feedback.</strong>",undoLinkText:"Undo",moderationLinkTemplate:'<a href="#" class="<%: linkClassName %>"><span></span><%= resources.moderateLinkText %></a>',moderationMenuTemplate:'<ul class="navigation-list">   <% foreach(links, function(link){ %>       <li class="navigation-item">           <a href="<%: (link.href || "#") %>" class="<%: (link.className || "") %>"><%= link.text %></a>       </li>   <% }); %></ul>',
notificationTemplate:"<p><%= resources.reportedNotificationMessageText %></p>"};return{}},jQuery,window);u("plugin.evolutionPager",function(f,e,k){var h={},n={},g={},c=function(a){var b=[],c=a.settings,d=function(a){var b={};b[c.pageKey]=a;a={url:c.baseUrl,query:b};c.hash&&0<c.hash.length&&(a[c.hash]=c.hash);return f.telligent.evolution.url.modify(a)};0===c.totalItems||0===c.pageSize?a=0:(a=Math.floor(c.totalItems/c.pageSize),0<c.totalItems%c.pageSize&&(a+=1));if(1<a){c.showFirst&&3<=c.currentPage&&
a>c.numberOfPagesToDisplay&&(b[b.length]={type:"first",selected:!1,page:1,url:d(1)});c.showPrevious&&0<c.currentPage&&(b[b.length]={type:"previous",selected:!1,page:c.currentPage,url:d(c.currentPage)});if(c.showIndividualPages){var e;e=a<c.numberOfPagesToDisplay||0>c.currentPage-Math.floor(c.numberOfPagesToDisplay/2)?0:c.currentPage+Math.floor(c.numberOfPagesToDisplay/2)>=a?a-c.numberOfPagesToDisplay:c.currentPage-Math.floor(c.numberOfPagesToDisplay/2);var g;g=Math.floor(c.numberOfPagesToDisplay/
2);0===c.numberOfPagesToDisplay%2&&(g-=1);for(g=a<c.numberOfPagesToDisplay||c.currentPage+g>=a?a-1:0>c.currentPage-Math.floor(c.numberOfPagesToDisplay/2)?c.numberOfPagesToDisplay-1:c.currentPage+g;e<=g;e++)b[b.length]={type:"page",selected:c.currentPage===e,page:e+1,url:d(e+1)}}c.showNext&&c.currentPage+1<a&&(b[b.length]={type:"next",selected:!1,page:c.currentPage+2,url:d(c.currentPage+2)});c.showLast&&c.currentPage+3<a&&a>c.numberOfPagesToDisplay&&(b[b.length]={type:"last",selected:!1,page:a,url:d(a)})}return b},
d=function(a){var b=a.template({links:a.links});a.selection.html(b)},a=function(a){if(!a.settings.refreshOnAnyHashChange)return null;var b=f.telligent.evolution.url.hashData(),c=null,d;for(d in b)0==d.indexOf(a.settings.pageKey)&&(c=c||{},c[d.substr(a.settings.pageKey.length)]=b[d]);return c},b=function(b){var c=parseInt(f.telligent.evolution.url.hashData()[b.settings.pageKey],10),d=a(b);d&&(c=c||1);isNaN(c)||c===b.settings.currentPage||g[b.settings.pageKey]||(g[b.settings.pageKey]=!0,b.settings.onPage(c,
function(a){b.currentPageIndex=c;t(b,c,0,a,!1)},d||{}))},p=function(a){f(a.selection).delegate("a","click",function(b){b.preventDefault();b=f(this);var c={};c[a.settings.pageKey]=b.data("page");f.telligent.evolution.url.hashData(c)})},m=function(b){h[b.settings.pageKey]||(h[b.settings.pageKey]=!0,b.currentPageIndex=parseInt(f.telligent.evolution.url.hashData()[b.settings.pageKey],10),isNaN(b.currentPageIndex)&&(b.currentPageIndex=b.settings.currentPage),f(window).bind("hashchange",function(c){c=parseInt(f.telligent.evolution.url.hashData()[b.settings.pageKey],
10);if(a(b)||!isNaN(c)&&b.currentPageIndex!=c){b.newPageIndex=c;var d={currentPage:b.currentPageIndex||1,newPage:b.newPageIndex||1,container:b.settings.pagedContentContainer};f.telligent.evolution.messaging.publish(b.settings.pagedContentPagingEvent,d);b.selection.trigger("evolutionPagerPaging",d);b.currentPageIndex=c}}))},q=function(b){n[b.settings.pagedContentPagingEvent]&&(b.currentPageIndex=parseInt(f.telligent.evolution.url.hashData()[b.settings.pageKey],10),f.telligent.evolution.messaging.unsubscribe(n[b.settings.pagedContentPagingEvent]));
n[b.settings.pagedContentPagingEvent]=f.telligent.evolution.messaging.subscribe(b.settings.pagedContentPagingEvent,function(c){g[b.settings.pageKey]||(g[b.settings.pageKey]=!0,b.settings.onPage(c.newPage,function(a){b.currentPageIndex=c.newPage;t(b,c.newPage,c.currentPage,a,!0)},a(b)||{}))})},t=function(a,b,e,p,m){var q=function(){var c={page:b,container:a.settings.pagedContentContainer};f.telligent.evolution.messaging.publish(a.settings.pagedContentPagedEvent,c);a.selection.trigger("evolutionPagerPaged",
c)};!m||"slide"!==a.settings.transition&&"fade"!==a.settings.transition?(f(a.settings.pagedContentContainer).html(p),q(),g[a.settings.pageKey]=!1):(m="fade","slide"===a.settings.transition&&(m=b<e?"slideRight":"slideLeft"),e=f(a.settings.pagedContentContainer),p=f("<div></div>").attr("id",e.attr("id")).html(p).hide().insertAfter(a.settings.pagedContentContainer),e.glowTransition(p,{type:m,duration:a.settings.transitionDuration,complete:function(){f(a.settings.pagedContentContainer).css({width:"",
height:"",overflow:"hidden"});q();g[a.settings.pageKey]=!1}}));a.settings.currentPage=b-1;a.links=c(a);d(a)};f.fn.evolutionPager=function(a){a=f.extend({},f.fn.evolutionPager.defaults,a||{});var e={selection:this,settings:a,template:f.telligent.evolution.template.compile(a.template)};e.links=c(e);d(e);a.onPage&&(a.pagedContentContainer&&0<a.pagedContentContainer.length)&&(q(e),m(e),p(e),b(e));return this};f.fn.evolutionPager.defaults={currentPage:0,pageSize:10,totalItems:0,showPrevious:!1,showNext:!1,
showFirst:!0,showLast:!0,showIndividualPages:!0,numberOfPagesToDisplay:5,pageKey:"pi",hash:"",baseUrl:window.location.href,onPage:function(a,b){},pagedContentContainer:"",pagedContentPagingEvent:"ui.page.paging",pagedContentPagedEvent:"ui.page.paged",transition:null,transitionDuration:250,refreshOnAnyHashChange:!1,template:' <% foreach(links, function(link, i) { %>      <% if(link.type === "first") { %>          <a href="<%: link.url %>" class="first" data-type="first" data-page="<%= link.page %>" data-selected="false"><span>&#171;</span></a>      <% } else if(link.type === "previous") { %>          <a href="<%: link.url %>" class="previous" data-type="previous" data-page="<%= link.page %>" data-selected="false"><span>&#60;</span></a>     <% } else if(link.type === "page") { %>          <a href="<%: link.url %>" class="page<%= link.selected ? " selected" : "" %>" data-type="page" data-page="<%= link.page %>" data-selected="<%= link.selected ? "true" : "false" %>"><span><%= link.page %></span></a>      <% } else if(link.type === "next") { %>          <a href="<%: link.url %>" class="next" data-type="next" data-page="<%= link.page %>" data-selected="false"><span>&#62;</span></a>     <% } else if(link.type === "last") { %>          <a href="<%: link.url %>" class="last" data-type="last" data-page="<%= link.page %>" data-selected="false"><span>&#187;</span></a>      <% } %>      <% if(i < (links.length - 1)) { %>          <span class="separator"></span>      <% } %>  <% }); %> '};
return{}},jQuery,window);u("plugin.evolutionResize",function(f,e,k){function h(){if(!g){g=!0;var a=f("<textarea>test</textarea>").css({overflow:"hidden",resize:"none",visible:"none"}).appendTo("body");1>=Math.abs(a.prop("scrollHeight")-a.height())&&(n=0);a.remove()}}var n=null,g=!1,c=function(a){a.area.css({height:"auto"}).css({height:a.area.prop("scrollHeight")-(null===n?a.offset:n)});var b=a.area.outerHeight();b!==a.oldHeight&&(b>=a.maxHeight?a.area.css({overflow:"visible"}):a.area.css({overflow:"hidden"}),
a.area.trigger("evolutionResize",{newHeight:b,oldHeight:a.oldHeight}),a.oldHeight=b)},d=function(a){return parseInt(a.replace("px",""),10)};f.fn.evolutionResize=function(){h();return this.filter("textarea").each(function(){var a=f(this).css({resize:"none",overflow:"hidden"}),b={area:a,oldHeight:a.height(),maxHeight:d(a.css("max-height")),offset:a.innerHeight()!==a.height()?d(a.css("padding-top"))+d(a.css("padding-bottom")):0};a.bind("input keydown keyup",function(){c(b)});c(b)})};return{}},jQuery,
window);u("plugin.evolutionScrollSlider",function(f,e,k){var h=!1,n=function(c){var d=c.window.height()>=c.document.height(),a=function(){var a=c.document.height(),d=c.window.height(),e=c.window.scrollTop();return(a-e-d)/a};c.window.bind("scroll.evolutionScrollSlider",function(){d=!0});setInterval(function(){d&&(d=!1,!h&&1-a()>=c.revealAt?(h=!0,c.document.trigger("evolutionScrollSliderShow")):h&&1-a()<c.revealAt&&(h=!1,c.document.trigger("evolutionScrollSliderHide")))},c.bounceDelay)},g=function(c){var d=
f("<div></div>").hide().addClass(c.className).css({width:c.width,minHeight:c.height,maxHeight:0.7*c.window.height(),position:"fixed",bottom:c.offsetBottom,right:"0px"}).appendTo("body"),a=function(){c.load(function(a){a&&(d.html(a),f.fn.evolutionTransform.accelerated()?d.hide().evolutionTransform({left:d.width()+c.offsetRight,opacity:0},{duration:0}).show().evolutionTransform({left:-1*c.offsetRight,opacity:1},{duration:200}):d.css({right:-d.width()}).show().animate({right:c.offsetRight},{duration:c.animationDuration}))})},
b=function(){f.fn.evolutionTransform.accelerated()?d.evolutionTransform({opacity:0},{duration:100,complete:function(){d.hide()}}):d.animate({right:-d.width()},{duration:c.animationDuration,complete:function(){d.hide()}})};c.document.on("evolutionScrollSliderShow.evolutionScrollSlider",function(){a()}).on("evolutionScrollSliderHide.evolutionScrollSlider",function(){b()})};f.evolutionScrollSlider=function(c){c=f.extend({},f.evolutionScrollSlider.defaults,c||{},{window:f(window),document:f(document)});
c.document.unbind(".evolutionScrollSlider");c.window.unbind(".evolutionScrollSlider");n(c);g(c)};f.evolutionScrollSlider.hide=function(){f(document).trigger("evolutionScrollSliderHide")};f.evolutionScrollSlider.defaults={load:function(c){c(null)},width:400,height:75,className:"slider-content",animationDuration:250,offsetBottom:25,offsetRight:25,bounceDelay:150,revealAt:0.8};return{}},jQuery,window);u("plugin.evolutionStarRating",function(f,e,k){var h=[],n=/MSIE 6/i.test(navigator.userAgent)?"gif":
"png",g=function(a,b){return 1==b%2?a.settings.imagesPathUrl+"star-right-on."+n:a.settings.imagesPathUrl+"star-left-on."+n},c=function(a,b){return 1==b%2?a.settings.imagesPathUrl+"star-right-off."+n:a.settings.imagesPathUrl+"star-left-off."+n};_cacheImages=function(a){var b,d,e;for(e=0;2>e;e++)d=g(a,e),_isImageCached(d)||(b=new Image,b.src=d,h[h.length]=b),d=c(a,e),_isImageCached(d)||(b=new Image,b.src=d,h[h.length]=b)};_isImageCached=function(a,b){var c;for(c=0;c<h.length;c++)if(h[c].src==b)return!0;
return!1};_getItemTitle=function(a,b,c){return"object"==typeof a.settings.titles?a.settings.titles[b].replace("{0}",c):a.settings.titles?a.settings.titles.replace("{0}",c):c};_getValue=function(a){return"undefined"!==typeof a.internal.value?a.internal.value:a.settings.value};_setValue=function(a,b){a.internal.isInitialized&&!a.settings.isReadOnly&&(a.internal.value=b,a.settings.allowMultipleSelections||(a.settings.isReadOnly=!0),a.internal.savingValue=!0,a.settings.onRate(b))};_showValue=function(a,
b){var d,e=2*a.settings.maxRating;b=2*b-1;var q="img"==a.settings.starElement;for(d=0;d<e;d++)d<=b?q?f(a.internal.state.find("img").get(d)).attr("src",g(a,d)).removeClass().addClass("star-on-"+(0==d%2?"left":"right")):f(a.internal.state.find("span").get(d)).removeClass().addClass("star-on-"+(0==d%2?"left":"right")):q?f(a.internal.state.find("img").get(d)).attr("src",c(a,d)).removeClass().addClass("star-off-"+(0==d%2?"left":"right")):f(a.internal.state.find("span").get(d)).removeClass().addClass("star-off-"+
(0==d%2?"left":"right"))};_mouseOver=function(a,b){a.internal.isInitialized&&!a.settings.isReadOnly&&(a.internal.state.addClass(a.settings.overClass),_showValue(a,b))};_mouseOut=function(a,b){a.internal.isInitialized&&!a.settings.isReadOnly&&(a.internal.state.removeClass(a.settings.overClass),_showValue(a,b))};_init=function(a){return this.each(function(){var b={settings:f.extend({},f.fn.evolutionStarRating.defaults,a||{}),internal:{state:f(this)}};b.settings.imagesPathUrl||(b.settings.imagesPathUrl=
f.telligent.evolution.site.getBaseUrl()+"utility/images/");_cacheImages(b);f(this).data("evolutionStarRating_context",b);_initialize(b)})};_initialize=function(a){a.internal.state.addClass(a.settings.starClass).css("white-space","nowrap").find("a").unbind(".evolutionStarRating").empty().end().bind("mouseleave",function(){_showValue(a,_getValue(a))});a.settings.isReadOnly&&a.internal.state.addClass(a.settings.readOnlyClass);var b,d=2*a.settings.maxRating,e="undefined"===typeof a.settings.ratingCount,
q="img"==a.settings.starElement;for(b=0;b<d;b++)(function(){var d,p;p=q?f("<img />").css({borderLeftWidth:"0px",borderTopWidth:"0px",borderRightWidth:"0px",borderBottomWidth:"0px"}):f("<span></span>");a.settings.isReadOnly||(d=f('<a href="#" />').css({textDecoration:"none"}).append(p));var h=(b+1)/2;h<=a.settings.value?q?p.attr("src",g(a,b)).addClass("star-on-"+(0==b%2?"left":"right")):p.addClass("star-on-"+(0==b%2?"left":"right")):q?p.attr("src",c(a,b)).addClass("star-off-"+(0==b%2?"left":"right")):
p.addClass("star-off-"+(0==b%2?"left":"right"));if(!a.settings.isReadOnly){if(a.settings.useHalfStars)r=_getItemTitle(a,b,h);else var h=Math.ceil(h),r=_getItemTitle(a,h,h);e&&d.attr("title",r);q&&p.attr("alt",r);d.data("rating-value",h).bind("click.evolutionStarRating",function(b){_setValue(a,d.data("rating-value"));return!1}).bind("focus.evolutionStarRating",function(b){_mouseOver(a,d.data("rating-value"))}).bind("mouseover.evolutionStarRating",function(b){_mouseOver(a,d.data("rating-value"))}).bind("blur.evolutionStarRating",
function(b){_mouseOut(a,d.data("rating-value"))}).bind("mouseout.evolutionStarRating",function(b){_mouseOut(a,d.data("rating-value"))})}q&&p.attr("align","absmiddle").attr("border",0);d?a.internal.state.append(d):a.internal.state.append(p)})();_setMessage(a);a.internal.isInitialized=!0};_setMessage=function(a){!a.settings.ratingMessageFormat||(isNaN(parseInt(a.settings.ratingCount))||isNaN(parseInt(a.settings.value)))||a.internal.state.attr("title",a.settings.ratingMessageFormat.replace(/\{rating\}/gi,
Math.round(10*a.settings.value)/10).replace(/\{count\}/gi,a.settings.ratingCount))};var d={val:function(a){var b=this.data("evolutionStarRating_context");return null!==b?"undefined"!==typeof a?(b.internal.value=a,_showValue(b,a),a):_getValue(b):0},readOnly:function(a){var b=this.data("evolutionStarRating_context");if(null!==b)if("undefined"!==typeof a)(b.settings.isReadOnly=a)?b.internal.state.find("a").css({cursor:"default"}):b.internal.state.find("a").css({cursor:"pointer"});else return b.settings.isReadOnly;
return!0},option:function(a,b){if("object"===typeof a)return this.each(function(){var b=f(this).data("evolutionStarRating_context");null!=b&&(b.settings=f.extend({},b.settings,a),_init.apply(f(this),[b.settings]))});if("undefined"!==typeof a&&"undefined"!==typeof b)return this.each(function(){var c=f(this).data("evolutionStarRating_context");null!=c&&(c.settings[a]=b,_init.apply(f(this),[c.settings]))});if("undefined"!==typeof a){var c=this.data("evolutionStarRating_context");return null!==c?c.settings[a]:
null}}};f.fn.evolutionStarRating=function(a){if(a in d)return d[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)f.error("Method "+a+" does not exist on jQuery.fn.evolutionStarRating");else return _init.apply(this,arguments)};f.extend(f.fn.evolutionStarRating,{defaults:{value:0,maxRating:5,imagesPathUrl:"",starElement:"img",useHalfStars:!1,starClass:"rating",overClass:"active",readOnlyClass:"readonly",titles:"Terrible Poor Fair Average Good Excellent".split(" "),isReadOnly:!1,
allowMultipleSelections:!0,ratingCount:void 0,ratingMessageFormat:"Average rating: {rating} out of {count} ratings.",onRate:function(a){}}});return{}},jQuery,window);u("plugin.evolutionTagTextBox",function(f,e,k){var h={openTagSelector:function(){var c=this.data("evolutionTagTextBox");if(c){window.__tagEditor={SetSelectedTags:function(a){for(var e=f(c.internal.state);0<e.glowLookUpTextBox("count");)e.glowLookUpTextBox("removeByIndex",0);for(var g=0;g<a.length;g++){var q=e.glowLookUpTextBox("createLookUp",
a[g],f.telligent.evolution.html.encode(a[g]),f.telligent.evolution.html.encode(a[g]),!0);e.glowLookUpTextBox("add",q)}},GetAllTagsWithEncoding:function(){for(var a=[],e=c.settings.allTags,g=f("<div></div>"),q=0;q<e.length;q++)g.text(e[q]),a[q]=[e[q],g.html()];return a},GetSelectedTags:function(){return g(c)}};var a=f.telligent.evolution.ensureRemoteUrlEncoding(c.settings.selectTagsModalUrl);"~/"==a.substr(0,2)&&(a=f.telligent.evolution.site.getBaseUrl()+a.substr(2));window.Telligent_Modal?window.Telligent_Modal.Open(a,
400,350,null):f.glowModal&&f.glowModal(a,{width:400,height:350})}}},n=function(d){return this.each(function(){var a={settings:f.extend({},f.fn.evolutionTagTextBox.defaults,d||{}),internal:{state:this,suggestionTimeoutHandle:null,previousTags:[],previousValue:"",currentTag:"",currentTagPosition:0}},b=f(this);0<=b.val().indexOf(";")&&b.val(b.val().replace(/;/g,","));for(var e=b.val().split(/,/g),g=[],q=0;q<e.length;q++){var t=f.trim(e[q]);t&&g.push(f.telligent.evolution.html.encode(t))}b.data("evolutionTagTextBox",
a);b.glowLookUpTextBox({emptyHtml:"",maxValues:100,selectedLookUpsHtml:g,minimumLookUpLength:0,onGetLookUps:function(b,d){window.clearTimeout(a.suggestTimeout);d&&b.glowLookUpTextBox("updateSuggestions",[b.glowLookUpTextBox("createLookUp","",'<span class="ui-loading" width="48" height="48"></span>','<span class="ui-loading" width="48" height="48"></span>',!1)]);a.suggestTimeout=window.setTimeout(function(){c(a,d).done(function(a){for(var c=[],e=!1,g=0;g<a.length;g++)a[g].toLowerCase()==d.toLowerCase()?
e=!0:c.push(b.glowLookUpTextBox("createLookUp",a[g],f.telligent.evolution.html.encode(a[g]),f.telligent.evolution.html.encode(a[g]),!0));d&&(e?c.unshift(b.glowLookUpTextBox("createLookUp",d,f.telligent.evolution.html.encode(d),f.telligent.evolution.html.encode(d),!0)):c.unshift(b.glowLookUpTextBox("createLookUp",d,'<em class="new-tag">'+f.telligent.evolution.html.encode(d)+"</em>",'<em class="new-tag">'+f.telligent.evolution.html.encode(d)+"</em>",!0)));b.glowLookUpTextBox("updateSuggestions",c)})},
500)}})})},g=function(c){var a=[];c=f(c.internal.state);for(var b=c.glowLookUpTextBox("count"),e=0;e<b;e++){var g=c.glowLookUpTextBox("getByIndex",e);g&&a.push(g.Value)}return a},c=function(c,a){return f.Deferred(function(b){var e,m,q,t,l=g(c);if(c.settings.applicationId)f.telligent.evolution.get({url:f.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/aggregatetags.json",data:{ApplicationId:c.settings.applicationId,TagNameFilter:a,PageSize:a?20:100,PageIndex:0,MinimumContentCount:0,TypeId:c.settings.typeId,
SortBy:"ContentCount",SortOrder:"Descending"}}).done(function(a){var c=[];for(e=0;e<a.AggregateTags.length;e++){q=!1;t=f.telligent.evolution.html.decode(a.AggregateTags[e].Name);for(m=0;m<l.length&&!q;m++)l[m].toLowerCase()==t.toLowerCase()&&(q=!0);q||c.push(t)}b.resolve(c)}).fail(function(){b.resolve([])});else{var h=c.settings.allTags,r=[];for(e=0;e<h.length&&(!a||20>=r.length);e++)if(0===h[e].toLowerCase().indexOf(a.toLowerCase())){q=!1;for(m=0;m<l.length&&!q;m++)l[m].toLowerCase()==h[e].toLowerCase()&&
(q=!0);q||r.push(h[e])}b.resolve(r)}}).promise()};f.fn.evolutionTagTextBox=function(c){if(c in h)return h[c].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof c&&c)f.error("Method "+c+" does not exist on jQuery.fn.evolutionTagTextBox");else return n.apply(this,arguments)};f.extend(f.fn.evolutionTagTextBox,{defaults:{allTags:[],selectTagsModalUrl:"~/utility/tagselector?TagEditor=__tagEditor",applicationId:null,typeId:null}});return{}},jQuery,window);u("plugin.evolutionTextEditor",
function(f,e,k){var h=function(a){return f(a).data("__EVOLUTIONTEXTEDITOR_CONTEXT")},n=function(a){var b="";a.isReadOnly?b=a.readOnlyView.html():f.telligent.evolution.put({url:f.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/html/fromtext.json",data:{text:a.editor.evolutionComposer("val")},dataType:"json",async:!1,success:function(a){b=a.Html}});return b},g=function(a,b){f.telligent.evolution.put({url:f.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/text/fromhtml.json",data:{html:b},dataType:"json",
async:!1,success:function(c){c.TextConversion.IsDataLost?(a.isReadOnly||(a.readOnlyView.css("height",a.editor.height()+"px"),a.readOnlyView.css("width",a.editor.width()+"px"),a.isReadOnly=!0,a.readOnlyView.show(),a.editorWrapper.hide()),a.readOnlyView.html(b),a.editor.val("<!html>"+b)):(a.isReadOnly&&(a.isReadOnly=!1,a.readOnlyView.hide(),a.editorWrapper.show()),a.editor.evolutionComposer("val",c.TextConversion.Text),a.editor.trigger("input"))}})},c=function(a){var b=function(){var c=a.editorWrapper.offset(),
d=a.editorWrapper.height();if(!a.isReadOnly)if(d){var g=f(e),h=g.scrollTop(),g=g.height(),r=Math.max(0,g-f("body").height());h+g<c.top+d?f("body, html").animate({scrollTop:(d>g-r?c.top-r:c.top-(g-d-5))+"px"},200,"swing",function(){a.editor.focus()}):h+r>c.top?f("body, html").animate({scrollTop:c.top-r+"px"},200,"swing",function(){a.editor.focus()}):a.editor.focus()}else e.clearTimeout(a.attemptFocusHandle),a.attemptFocusHandle=e.setTimeout(function(){b()},50)};b()},d=function(a,b,c){a.editor.evolutionComposer("resize",
b,c);isNaN(parseInt(b,10))||a.readOnlyView.css("width",b+"px");isNaN(parseInt(c,10))||a.readOnlyView.css("height",c+"px")},a=function(a){var b=a.width,c=a.height;"%"==a.cssWidth.substr(a.cssWidth.length-1)&&(b=a.editorWrapper.parent().width()*(parseInt(a.cssWidth,10)/100)-parseInt(a.editor.css("padding-left"),10)-parseInt(a.editor.css("padding-right"),10)-(a.editor.outerWidth()-a.editor.innerWidth()),d(a,b,c))},b={init:function(a){return this.each(function(){var b=f(this),c,d;if(!b.data("__EVOLUTIONTEXTEDITOR_CONTEXT")){var e=
b.css("width"),k=b.css("height"),r=b.innerWidth()-parseInt(b.css("padding-left"),10)-parseInt(b.css("padding-right"),10),n=b.innerHeight()-parseInt(b.css("padding-top"),10)-parseInt(b.css("padding-bottom"),10),s=b.val(),y=f('<div class="text-editor-wrapper"></div>');y.insertAfter(b);y.append(b);if(a.onSubmit){var x="cb_"+(new Date).getTime(),z=[];z.push('<div class="text-editor-submit-panel">');z.push(a.beforeSubmitHtml||"");a.enableToggle&&(z.push('<span class="text-editor-submit-panel-message">'),
z.push('<input type="checkbox" id="'+x+'_enable" />'),z.push('<label for="'+x+'_enable">'+(a.submitEnterMessage||"Press enter to send")+"</label>"),z.push("</span>"));z.push('<button type="button" class="text-editor-submit-panel-button" id="'+x+'_submit">');z.push(a.submitButtonText||"Send");z.push("</button>");z.push(a.afterSubmitHtml||"");z.push("</div>");y.append(z.join(""));c=y.find("#"+x+"_enable");d=y.find("#"+x+"_submit")}x=f('<div class="text-editor-read-only" style="overflow: auto; padding: 2px; border: 1px solid; box-sizing: border-box"></div>').hide();
x.on("click",function(){a.readOnlyMessage&&alert(a.readOnlyMessage)});x.insertAfter(y);b.evolutionComposer({plugins:a.plugins,focus:!1}).data("__EVOLUTIONTEXTEDITOR_CONTEXT",{editorWrapper:y,editor:b,readOnlyView:x,isReadOnly:!1,onKeyDowns:[],onChanges:[],cssWidth:e,cssHeight:k,width:r,height:n});b.evolutionComposer("oninput",function(a){var c=h(b);if(c&&c.onChanges&&0<c.onChanges.length)for(var d=0;d<c.onChanges.length;d++)try{c.onChanges[d](a)}catch(e){}return!0});if(a.onSubmit){if(a.enableToggle){b.evolutionComposer("onkeydown",
function(d){if(13!=d.keyCode||!c.is(":checked")||d.shiftKey||d.altKey){var e=h(b);if(e&&e.onKeyDowns&&0<e.onKeyDowns.length)for(var g=0;g<e.onKeyDowns.length;g++)try{e.onKeyDowns[g](d)}catch(f){}return!0}if(a.onSubmit)a.onSubmit();return!1});e=a.enterToSubmit;null!=window.localStorage&&null!==window.localStorage.getItem("tinymce-entertosubmit")&&(e="true"==window.localStorage.getItem("tinymce-entertosubmit"));e?c.attr("checked",!0):c.removeAttr("checked");var A=function(){c.is(":checked")?d.hide():
d.show();null!=window.localStorage&&window.localStorage.setItem("tinymce-entertosubmit",c.is(":checked").toString())};c.on("change",function(){A();return!0});A()}d.on("click",function(b){if(a.onSubmit)a.onSubmit();return!1})}else b.evolutionComposer("onkeydown",function(a){var c=h(b);if(c&&c.onKeyDowns&&0<c.onKeyDowns.length)for(var d=0;d<c.onKeyDowns.length;d++)try{c.onKeyDowns[d](a)}catch(e){}return!0});setTimeout(function(){b.evolutionComposer("resize",r,n)},50);0<f.trim(s).length&&g(h(b),s)}})},
val:function(a){if("undefined"!==typeof a){var b=h(this);if(b)return g(b,a)}else return(b=h(this))?n(b):"";return this},focus:function(){var b=h(this);b&&(a(b),c(b));return this},onKeyDown:function(a){var b=h(this);b&&b.onKeyDowns.push(a);return this},onChange:function(a){var b=h(this);b&&b.onChanges.push(a);return this},resize:function(a,b){var c=h(this);c&&d(c,a,b);return this},appendTo:function(b){var c=h(this);c?(c.editorWrapper.appendTo(b),a(c)):this.appendTo(b);return this}};f.fn.evolutionTextEditor=
function(a){if(b[a])return b[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)f.error("Method "+a+" does not exist on jQuery.evolutionTextEditor");else return b.init.apply(this,arguments)};return{}},jQuery,window);u("plugin.evolutionSqueezeText",function(f,e,k){function h(a){return parseFloat(f(a).css("font-size"))}function n(a){return parseFloat(f(a).css("letter-spacing"))}function g(a,b){f(a).css("font-size",b)}function c(a,b){f(a).css("letter-spacing",b)}var d={minSize:9,
minSpacing:-0.5,enableSpacing:!0,resetOnFailure:!1,truncateOnFailure:!0,onFailure:function(){}};f.fn.evolutionSqueezeText=function(a){var b=f.extend({},d,a||{});return this.each(function(){f(this).css({"white-space":"nowrap",overflow:"hidden"});if(!(this.scrollWidth<=this.offsetWidth)){var a=b.enableSpacing?1:2,d=b.minSpacing,e=b.minSize,t=n(this),l=h(this),k=l,r=t,v=t,s=l,y=0,x,z;for(z=0;50>z;z++)if(1===a&&b.enableSpacing){if(this.scrollWidth<=this.offsetWidth){x=t;var A=n(this);x=A+(x-A)/2}else x=
d,A=n(this),x+=(A-x)/2;c(this,x);this.scrollWidth<=this.offsetWidth?d=x:t=x;if(0.01>=Math.abs(x-b.minSpacing)&&2>y)y++,a=2,t=v=r,d=b.minSpacing,c(this,r);else if(0.01>=Math.abs(v-x))break;else v=x}else if(2===a)if(this.scrollWidth<=this.offsetWidth?(x=l,A=h(this),x=A+(x-A)/2):(x=e,A=h(this),x+=(A-x)/2),g(this,x),this.scrollWidth<=this.offsetWidth?e=x:l=x,0.01>=Math.abs(x-b.minSize)&&b.enableSpacing&&2>y)y++,a=1;else if(0.01>=Math.abs(s-x))if(b.enableSpacing&&2>y)y++,a=1;else break;else s=x;this.scrollWidth<=
this.offsetWidth||(b.resetOnFailure&&(g(this,k),c(this,r)),b.truncateOnFailure&&f(this).css("text-overflow","ellipsis"),b.onFailure&&b.onFailure.apply(this))}})};f.fn.evolutionSqueezeText.defaults=d;return{}},jQuery,window);u("plugin.evolutionTheater",["lib.globalConfiguration"],function(f,e,k,h){var n={show:function(g){var c=e.extend({},n.defaults,g||{});g=f.previewClose;var d=e('<div class="theater-mask"></div>').css("opacity","0").appendTo("body"),a=e('<div class="theater-loading"><span class="ui-loading"></span></div>').appendTo(d),
b=e('<div class="theater-container"></div>').css("opacity","0").appendTo(d),p=e('<div class="theater-content-container"></div>').appendTo(b),m=e('<div class="theater-content"></div>').appendTo(p),q=e('<a href="#" class="theater-close">'+g+"</a>").appendTo(d),t=null,l=function(d,e){t=d;d(function(d){e?e(m,d):m.html(d);k.setTimeout(function(){a.hide();c.loaded(m);b.css("opacity","1")},50)})},h=function(){d.css("opacity","0");window.setTimeout(function(){d.remove()},100);q.unbind("._evolution_theater");
b.unbind("._evolution_theater");e(document).unbind("._evolution_theater");e(document).off("._evolution_theater");e("body").css("overflow","")};n.refresh=function(a){l(t,a)};n.hide=function(){h()};(function(){e("body").css({overflow:"hidden"});e(document).off(".evolutionTheater").on("touchstart._evolution_theater",".theater-mask",function(a){a=this.scrollTop;var b=this.scrollHeight,c=a+this.offsetHeight;0===a?this.scrollTop=1:c===b&&(this.scrollTop=a-1)}).on("touchmove._evolution_theater",function(a){for(var b=
a.target,c=!1;null!==b;){if(b.classList&&b.classList.contains("theater-mask")){c=!0;break}b=b.parentNode}c||a.preventDefault()})})();q.bind("click._evolution_theater",function(a){a.preventDefault();h()});b.bind("click._evolution_theater",function(a){a.target===b.get(0)&&h()});e(document).bind("keydown._evolution_theater",function(a){27===a.which&&h()});d.css("opacity","1");l(c.content)},hide:function(){},refresh:function(){},defaults:{content:function(){return null},loaded:function(){}}};e.evolutionTheater=
n;return{}},jQuery,window);u("plugin.evolutionThreadReplies.controller",["plugin.evolutionThreadReplies.model","plugin.evolutionThreadReplies.navigator","plugin.evolutionThreadReplies.repliesView","plugin.evolutionThreadReplies.votersPopup","plugin.evolutionThreadReplies.utility"],function(f,e,k,h,n,g,c,d){function a(a){a.model=new f({onListReplies:a.onListReplies,onListVoters:a.onListVoters,onAddReply:a.onAddReply,onEditReply:a.onEditReply,onGetReply:a.onGetReply,onVoteReply:a.onVoteReply,onFilterChange:a.onFilterChange,
onTyping:a.onTyping,onInit:a.onInit,onTypingStarted:function(b){b&&b.authorId==g.telligent.evolution.user.accessing.id||(a.view.indicateTyping({typing:!0,parentId:b.parentId,authorDisplayName:b.authorDisplayName}),a.typingTimeouts=a.typingTimeouts||{},c.clearTimeout(a.typingTimeouts[b.parentId]),delete a.typingTimeouts[b.parentId],a.typingTimeouts[b.parentId]=c.setTimeout(function(){a.view.indicateTyping({typing:!1,parentId:b.parentId,authorDisplayName:b.authorDisplayName})},1.5*b.delay))},onReplyCreated:function(b,
c){var d=b.forceRender;if(!d){if(b.authorId==g.telligent.evolution.user.accessing.id)return;a.view.indicateTyping({typing:!1,parentId:b.parentId});if(a.interacting){a.view.indicateNewReplies({parentId:b.parentId,replyId:b.replyId});return}if(!a.view.isContainerVisible({parentId:b.parentId})||a.interacting){a.view.indicateNewReplies({parentId:b.parentId,replyId:b.replyId});return}}a.model.getReply({replyId:b.replyId}).done(function(c){c=a.view.renderReplies({replies:[c],highlightNew:!0,permaLinked:b.replyId,
includeExplicitLoaders:!0,sortBy:a.sortBy,sortOrder:a.sortOrder,onlyIfVisible:!d});s(a);d?a.view.scrollTo({replyId:b.replyId}):c||a.view.indicateNewReplies({parentId:b.parentId,replyId:b.replyId})})},onReplyUpdated:function(b){w(a,b.replyId)||a.view.isReplyRendered({replyId:b.replyId})&&a.model.getReply({replyId:b.replyId}).done(function(c){!1!==c.isApproved&&a.view.renderReplies({replies:[c],highlightNew:!0,permaLinked:b.replyId,highlightPermaLinked:!0})})},onVote:function(b){a.view.updateVotes({replyId:b.replyId,
yesVotes:b.yesVotes,noVotes:b.noVotes,value:b.value})},onReplyDeleted:function(c){w(a,c.replyId)||b(a,c.replyId,c.deleteChildren)},onAttemptDelete:function(c){l(a,c.replyId);b(a,c.replyId,c.deleteChildren)},onShowReplyForm:function(b){a.view.showReplyForm(b)},onAttemptTyping:n.throttle(function(b){a.model.type({parentId:b.parentId})},1500),onAttemptCreate:function(b){b&&(b.body&&0!=g.trim(b.body).length)&&(a.view.hideReplyForms(),l(a),a.model.addReply({parentId:b.parentId,body:b.body,data:b.data}).done(function(c){!1!==
c.isApproved&&(a.view.renderReplies({replies:[c],sortBy:b.sortBy||a.sortBy,sortOrder:b.sortOrder||a.sortOrder,flattenedSortBy:a.flattenedSortBy,flattenedSortOrder:a.flattenedSortOrder,highlightNew:!0,permaLinked:c.id,includeExplicitLoaders:!0}),a.view.scrollTo({replyId:c.id}))}))},onAttemptUpdate:function(b){b&&(b.body&&0!=g.trim(b.body).length)&&(l(a,b.replyId),a.view.hideReplyForms(),a.model.editReply({replyId:b.replyId,body:b.body,data:b.data}).done(function(b){!1!==b.isApproved&&a.view.renderReplies({replies:[b],
highlightPermaLinked:!0,permaLinked:b.id})}))},shouldHandleLiveMutations:function(){return null==a.filter}})}function b(a,b,c){a.view.isReplyRendered({replyId:b})&&(c?a.view.removeReply({replyId:b}):a.model.getReply({replyId:b}).done(function(c){a.view.renderReplies({replies:[c],permaLinked:b})}))}function p(a){a.flattenedSortOrder="CreatedDate"==a.sortBy?a.sortOrder:"Ascending";a.navigator=new e({onParseReplyId:a.onParseReplyId,onGenerateReplyUrl:a.onGenerateReplyUrl,replySortByQueryStringKey:a.replySortByQueryStringKey,
replyFilterQueryStringKey:a.replyFilterQueryStringKey,replySortOrderQueryStringKey:a.replySortOrderQueryStringKey,defaultReplyIdQueryStringValue:a.defaultReplyIdQueryStringValue,defaultReplySortByQueryStringValue:a.defaultReplySortByQueryStringValue,defaultReplySortOrderQueryStringValue:a.defaultReplySortOrderQueryStringValue,initialSortBy:a.sortBy,initialSortOrder:a.sortOrder,initialFilter:a.filter,onLoadReply:function(b){return a.model.listReplies({replyId:b.replyId})},onLoadReplies:function(b){a.view.empty();
a.view.showLoading();return a.model.listReplies({sortBy:b.replySortBy,sortOrder:b.replySortOrder,flattenedSortBy:a.flattenedSortBy,flattenedSortOrder:a.flattenedSortOrder,filter:b.replyFilter})},onRenderReply:function(b,c,d){d.resetFilter&&(a.model.filterChange(d),a.view.empty());a.view.renderReplies({replies:b,permaLinked:c,sortBy:d.sortBy,sortOrder:d.sortOrder,flattenedSortBy:a.flattenedSortBy,flattenedSortOrder:a.flattenedSortOrder});a.view.scrollTo({replyId:c,highlight:!0})},onRenderReplies:function(b,
c){a.model.filterChange(c);a.view.empty();a.view.renderReplies({replies:b,sortBy:c.sortBy,sortOrder:c.sortOrder,flattenedSortBy:a.flattenedSortBy,flattenedSortOrder:a.flattenedSortOrder,appendOnly:!0})},onAdjustGlobalSort:function(b){a.sortBy=b.sortBy;a.filter=b.filter;a.sortOrder=b.sortOrder;a.flattenedSortOrder="CreatedDate"==b.sortBy?b.sortOrder:"Ascending"}})}function m(a){g(a.container).empty().show();a.view=new k({wrapper:a.wrapper,container:a.container,loadMoreTemplate:a.loadMoreTemplate,newRepliesTemplate:a.newRepliesTemplate,
replyTemplate:a.replyTemplate,typingIndicatorTemplate:a.typingIndicatorTemplate,replyListTemplate:a.replyListTemplate,replyFormTemplate:a.replyFormTemplate,pageSize:a.pageSize,flattenedDepth:a.flattenedDepth,loadOnScroll:a.loadOnScroll,delayLoadOnScroll:a.delayLoadOnScroll,highlightClassName:a.highlightClassName,loadMoreSelector:a.loadMoreSelector,containerSelector:a.containerSelector,replySelector:a.replySelector,loadMorePreviousSelector:a.loadMorePreviousSelector,renderedContentSelector:a.renderedContentSelector,
loadMoreNextSelector:a.loadMoreNextSelector,loadMoreLinkSelector:a.loadMoreLinkSelector,newReplySelector:a.newReplySelector,submitReplySelector:a.submitReplySelector,cancelReplySelector:a.cancelReplySelector,onEditorAppendTo:a.onEditorAppendTo,onEditorRemove:a.onEditorRemove,onEditorVal:a.onEditorVal,onEditorFocus:a.onEditorFocus,onGetFilter:function(){return a.filter}})}function q(a){a.voterPopup=new h({modalTitleText:a.text.peopleWhoVoted,modalShowMoreText:a.text.more,noVotesText:a.text.noVotes,
loadVoters:function(b){return a.model.listVoters(b)}});a.voterPopup.handleVoterPopupRequests({container:a.container})}function t(a){y.subscribe("ui.replies.navigate",function(b){a.navigator.navigate({url:b.url})});y.subscribe("ui.replies.loadpage",function(b){a.model.listReplies({parentId:b.parentId,startReplyId:b.startReplyId,endReplyId:b.endReplyId,flattenedDepth:a.flattenedDepth-b.currentDepth+1,sortBy:b.sortBy,sortOrder:b.sortOrder,flattenedSortBy:a.flattenedSortBy,flattenedSortOrder:a.flattenedSortOrder,
filter:b.filter,explicitPageIndex:b.explicitPageIndex}).done(function(c){a.view.renderReplies({replies:c.replies,sortBy:b.sortBy,sortOrder:b.sortOrder,offsetElement:b.offsetElement,flattenedSortBy:a.flattenedSortBy,flattenedSortOrder:a.flattenedSortOrder,loadDirection:b.loadDirection,explicitContainer:b.explicitContainer,loadInline:b.loadInline})})});y.subscribe("ui.replies.delete",function(b){if(a.onDeletePrompt)a.onDeletePrompt({replyId:g(b.target).data("id")})});y.subscribe("ui.replies.edit.cancel",
function(b){a.view.hideReplyForms()});y.subscribe("ui.replies.edit",function(b){var c=g(b.target).data("id");a.model.getReply({replyId:c}).done(function(b){g.fn.uilinks.hide();a.view.renderEdit({replyId:c,reply:b})})});y.subscribe("ui.replies.interaction.start",function(){a.interacting=!0});y.subscribe("ui.replies.interaction.stop",function(){a.interacting=!1});y.subscribe("ui.replies.cancel",function(){a.view.hideReplyForms()});y.subscribe("ui.replies.new",function(b){var c=g(b.target).data("replyid");
a.model.listReplies({replyId:c,includeSiblings:!0}).done(function(b){a.view.renderReplies({replies:b.replies,permaLinked:c,sortBy:a.sortBy,sortOrder:a.sortOrder,highlightNew:!0,includeExplicitLoaders:!0,flattenedSortBy:a.flattenedSortBy,flattenedSortOrder:a.flattenedSortOrder});a.view.scrollTo({replyId:c})})});y.subscribe("ui.replies.vote.message",function(a){a=g(a.target);g.fn.evolutionTip.hide();a.hasClass("selected")?y.publish("ui.replies.unvote",{replyId:a.data("replyid")}):y.publish("ui.replies.vote",
{replyId:a.data("replyid"),value:a.data("value")})});y.subscribe("ui.replies.vote",function(b){a.model.voteReply({replyId:b.replyId,value:b.value}).done(function(c){a.view.updateVotes({replyId:b.replyId,yesVotes:c.yesVotes,noVotes:c.noVotes,value:c.value})})});y.subscribe("ui.replies.unvote",function(b){a.model.voteReply({replyId:b.replyId}).done(function(c){a.view.updateVotes({replyId:b.replyId,value:null})})})}function l(a,b,d){b=b||"root";a.blockedReplies||(a.blockedReplies={});a.blockedReplies[b]||
(a.blockedReplies[b]=c.setTimeout(function(){delete a.blockedReplies[b]},d||2E3))}function w(a,b){return a.blockedReplies&&a.blockedReplies[b||"root"]}function r(a){var b={sortBy:a.sortBy,sortOrder:a.sortOrder,filter:a.filter,initial:!0};a.replyId&&(b.replyId=a.replyId);return b}function v(a){return a.model.listReplies(r(a)).then(function(a){return a})}function s(a){a.headerContentRendered||(a.headerContentRendered=!0,a.headerContent&&a.view.appendHeaderContent(a.headerContent))}var y=g.telligent.evolution.messaging,
x={};return function(b){var c=g.extend({},x,b||{});c.replyId&&c.loadOnScroll&&(c.delayLoadOnScroll=!0);a(c);p(c);b=v(c);m(c);q(c);t(c);c.view.showLoading();b.done(function(a){a.replies&&0<a.replies.length&&s(c);c.view.empty();c.view.renderReplies({replies:a.replies,permaLinked:a.initialPage?!1:c.replyId,sortBy:c.sortBy,sortOrder:c.sortOrder,flattenedSortBy:c.flattenedSortBy,flattenedSortOrder:c.flattenedSortOrder,appendOnly:!0});c.model.filterChange(r(c));c.replyId&&setTimeout(function(){c.view.scrollTo({replyId:c.replyId,
highlight:!0})},300)});c.replyId&&setTimeout(function(){c.preFocus&&c.view.showReplyForm({replyId:c.replyId,focus:!0});c.view.scrollTo({replyId:c.replyId,highlight:!0})},300);return{}}},jQuery,window);u("plugin.evolutionThreadReplies",["plugin.evolutionThreadReplies.controller"],function(f,e,k,h){var n={replyId:null,sortBy:null,sortOrder:null,flattenedSortBy:null,flattenedSortOrder:null,preFocus:!1,headerContent:null,replyIdQueryStringKey:null,replySortByQueryStringKey:null,replyFilterQueryStringKey:null,
replySortOrderQueryStringKey:null,pageSize:0,loadOnScroll:!1,onListReplies:function(e){},onListVoters:function(e){},onAddReply:function(e){},onEditReply:function(e){},onGetReply:function(e){},onVoteReply:function(e){},onFilterChange:function(e){},onDeletePrompt:function(e){},onEditorAppendTo:function(e){},onEditorRemove:function(e){},onEditorVal:function(e){},onEditorFocus:function(e){},onInit:function(e){},replyTemplate:null,loadMoreTemplate:null,typingIndicatorTemplate:null,newRepliesTemplate:null,
replyListTemplate:null,replyFormTemplate:null,highlightClassName:"new",loadMoreSelector:".load-more",loadMoreLinkSelector:".load-more a",loadMoreNextSelector:".load-more.next",loadMorePreviousSelector:".load-more.previous",containerSelector:"ul.content-list.threaded",replySelector:"li.threaded.content-item",newReplySelector:"a.new-reply",submitReplySelector:"a.submit-new-reply",cancelReplySelector:"a.cancel-new-reply",renderedContentSelector:".rendered-content",wrapper:"",container:""};e.fn.evolutionThreadedReplies=
function(g){var c=e.extend({},n,g||{});return e(this).each(function(){new f(c)})};e.fn.evolutionThreadedReplies.defaults=n;return{}},jQuery,window);u("plugin.evolutionThreadReplies.model",function(f,e,k){function h(e){if(e.onInit)e.onInit({raiseTypingStart:function(c){if(e.shouldHandleLiveMutations()&&e.onTypingStarted)e.onTypingStarted(c)},raiseReplyCreated:function(c){if(e.shouldHandleLiveMutations()&&e.onReplyCreated)e.onReplyCreated(c)},raiseReplyUpdated:function(c){if(e.onReplyUpdated)e.onReplyUpdated(c)},
raiseVote:function(c){if(e.onVote)e.onVote(c)},raiseReplyDeleted:function(c){if(e.onReplyDeleted)e.onReplyDeleted(c)},attemptDelete:function(c){if(e.onAttemptDelete)e.onAttemptDelete(c)},attemptTyping:function(c){if(e.onAttemptTyping)e.onAttemptTyping(c)},attemptCreate:function(c){if(e.onAttemptCreate)e.onAttemptCreate(c)},attemptUpdate:function(c){if(e.onAttemptUpdate)e.onAttemptUpdate(c)},showReplyForm:function(c){if(e.onShowReplyForm)e.onShowReplyForm(c||{})}})}var n={onListReplies:function(e){},
onListVoters:function(e){},onAddReply:function(e){},onEditReply:function(e){},onGetReply:function(e){},getReply:function(e){},onTyping:function(e){},onInit:function(e){},onTypingStarted:function(e){},onReplyCreated:function(e){},onReplyUpdated:function(e){},onVote:function(e){},onReplyDeleted:function(e){}};return function(e){var c=f.extend({},n,e||{});h(c);return{listReplies:function(d){if(c.onListReplies)return c.onListReplies(d).then(function(a){return a})},listVoters:function(d){if(c.onListVoters)return c.onListVoters(d)},
addReply:function(d){if(c.onAddReply)return c.onAddReply(d)},editReply:function(d){if(c.onEditReply)return c.onEditReply(d)},getReply:function(d){if(c.onGetReply)return c.onGetReply(d)},voteReply:function(d){if(c.onVoteReply)return c.onVoteReply(d)},filterChange:function(d){if(c.onFilterChange)return c.onFilterChange(d)},type:function(d){if(c.onTyping)return c.onTyping(d)}}}},jQuery,window);u("plugin.evolutionThreadReplies.navigator",function(f,e,k){function h(g){var c=f.telligent.evolution.url.parseQuery(e.location.href),
d=f.extend({replySortBy:g.defaultReplySortByQueryStringValue,replySortOrder:g.defaultReplySortOrderQueryStringValue,replyFilter:null},{replySortBy:c[g.replySortByQueryStringKey],replyFilter:c[g.replyFilterQueryStringKey],replySortOrder:c[g.replySortOrderQueryStringKey]});if(g.onParseReplyId){var a=g.onParseReplyId();a!==k&&(null!==a&&!1!==a)&&(d.replyId=a)}var b=d.replyId&&g.currentFilter;g.currentSortBy=d.replySortBy;g.currentSortOrder=d.replySortOrder;g.currentFilter=d.replyFilter;d.replySortBy&&
d.replySortOrder&&c[g.replySortByQueryStringKey]&&c[g.replySortOrderQueryStringKey]?(g.onAdjustGlobalSort({sortBy:d.replySortBy,sortOrder:d.replySortOrder,filter:d.replyFilter}),g.onLoadReplies(d).done(function(a){if(a&&a.replies&&g.onRenderReplies)g.onRenderReplies(a.replies,{sortBy:d.replySortBy,sortOrder:d.replySortOrder,filter:d.replyFilter})})):d.replyId&&(g.onAdjustGlobalSort({sortBy:d.replySortBy,sortOrder:d.replySortOrder,filter:d.replyFilter}),g.onLoadReply(d).done(function(a){if(a&&a.replies&&
g.onRenderReply)g.onRenderReply(a.replies,d.replyId,{sortBy:d.replySortBy,sortOrder:d.replySortOrder,filter:d.replyFilter,resetFilter:b})}))}var n={onParseReplyId:function(){},onGenerateReplyUrl:function(){},replySortByQueryStringKey:"",replyFilterQueryStringKey:"",replySortOrderQueryStringKey:"",defaultReplySortByQueryStringValue:null,defaultReplySortOrderQueryStringValue:null,onLoadReply:function(e){},onLoadReplies:function(e){},onRenderReply:function(e,c){},onRenderReplies:function(e){}};return function(g){var c=
f.extend({},n,g||{});f.extend(c,{currentSortBy:g.initialSortBy,currentSortOrder:g.initialSortOrder,currentFilter:g.initialFilter});var d=e.location.pathname;f(e).on("popstate",function(a){e.location.pathname!=d&&h(c);d=e.location.pathname});return{navigate:function(a){if(a.url)history.pushState({},"",a.url);else{a.replyId&&(delete a.replySortOrder,delete a.replySortBy,delete a.replyFilter);var b={},d=null;a.replyId&&null!==a.newUrl&&a.newUrl!==k?d=c.onGenerateReplyUrl(a.replyId):(a.replySortBy&&(b[c.replySortByQueryStringKey]=
a.replySortBy),a.replySortOrder&&(b[c.replySortOrderQueryStringKey]=a.replySortOrder),a.replyFilter&&(b[c.replyFilterQueryStringKey]=a.replyFilter),d=f.telligent.evolution.url.modify({url:e.location.href,query:b}));history.pushState({},"",d)}h(c)}}}},jQuery,window);u("plugin.evolutionThreadReplies.indicatorRegistrarView",["plugin.evolutionThreadReplies.indicatorView"],function(f,e,k,h){var n={container:null,onGetExistingRenderedReply:function(e){},template:null};return function(g){var c=e.extend({},
n,g||{},{indicators:{},offscreenIndicator:null});return{increment:function(d){var a=c.indicators[d.parentId];if(!a){var b=c.onGetExistingRenderedReply(d.parentId);b&&0<b.length&&(a=new f({container:b.find(".new-replies-wrapper").first(),template:c.template}),c.indicators[d.parentId]=a)}a&&a.increment(e.extend(d,{width:c.container.width()}));a&&a.isVisible()||(c.offscreenIndicatorContainer=c.offscreenIndicatorContainer||e("<div></div>").prependTo(c.container),c.offscreenIndicator||(c.offscreenIndicator=
new f({container:c.offscreenIndicatorContainer,offscreen:!0,template:c.template}),c.indicators.offscreen=c.offscreenIndicator),c.offscreenIndicator.increment(e.extend(d,{width:c.container.width()})));e.telligent.evolution.notifications.unread("+1",{isLocal:!0,namespace:"evolutionThreadReplies"})},isIndicating:function(d){return(d=c.indicators[d])?d.isIndicating():!1},decrement:function(d){e.each(c.indicators,function(a,b){b.decrement(e.extend(d,{width:c.container.width()}))||(b.remove(),delete b[a])});
e.telligent.evolution.notifications.unread("-1",{isLocal:!0,namespace:"evolutionThreadReplies"})}}}},jQuery,window);u("plugin.evolutionThreadReplies.indicatorView",["plugin.evolutionThreadReplies.utility"],function(f,e,k,h){var n={container:null,offscreen:!1,parentId:null,template:null};return function(g){var c=e.extend({},n,g||{},{replyStack:[]});return{increment:function(d){var a=d.replyId.toString();0<c.replyStack.indexOf(a)||(c.replyStack.push(a),c.container.empty(),d=e(c.template({newReplies:c.replyStack.length,
replyId:c.replyStack[0],offscreen:c.offscreen,width:d.width||100})),c.container.append(d))},decrement:function(d){var a=c.replyStack.indexOf(d.replyId.toString());0<=a&&c.replyStack.splice(a,1);return 0<c.replyStack.length?(c.container.empty(),d=e(c.template({newReplies:c.replyStack.length,replyId:c.replyStack[0],offscreen:c.offscreen,width:d.width||100})),c.container.append(d),!0):!1},isIndicating:function(){return c.replyStack&&0<c.replyStack.length},isVisible:function(){return f.isFullyVisible(document,
c.container,100)},remove:function(){c.container.empty()}}}},jQuery,window);u("plugin.evolutionThreadReplies.repliesView",["plugin.evolutionThreadReplies.indicatorRegistrarView","plugin.evolutionThreadReplies.utility"],function(f,e,k,h,n){function g(a){k(document).on("scrollend",function(){if(!a.scrolling&&!a.loadingPage){var b=a.container.find(a.loadMoreNextSelector+" a").last(),c=!1;b.parents(a.replySelector).each(function(){var b=k(this).next(a.replySelector);b&&0<b.length&&(c=!0)});c||b.click()}})}
function c(a){a.wrapper=k(a.wrapper);a.container=k(a.container);a.headerContainer=k('<div class="reply-header"></div>').appendTo(a.container);r(a);a.replyTemplate=k.telligent.evolution.template(a.replyTemplate);a.loadMoreTemplate=k.telligent.evolution.template(a.loadMoreTemplate);a.typingIndicatorTemplate=k.telligent.evolution.template(a.typingIndicatorTemplate);a.newRepliesTemplate=k.telligent.evolution.template(a.newRepliesTemplate);a.replyListTemplate=k.telligent.evolution.template(a.replyListTemplate);
a.replyFormTemplate=k.telligent.evolution.template(a.replyFormTemplate);a.loadOnScroll&&!a.delayLoadOnScroll&&g(a);a.newRepliesIndicatorRegistrar=new f({container:a.container,onGetExistingRenderedReply:function(b){return a.root?t(a,a.root,b):null},template:a.newRepliesTemplate})}function d(c){c.wrapper.on("click","a.navigable",function(a){a.stopPropagation();a.preventDefault();a=k(this).attr("href");k.telligent.evolution.messaging.publish("ui.replies.navigate",{url:a});return!1});c.wrapper.on("click",
c.loadMoreLinkSelector,function(a){a.preventDefault();c.delayLoadOnScroll&&(c.loadOnScroll&&!c.loadOnScrollInited)&&(c.loadOnScrollInited=!0,g(c));var d=!1;"inline"==k(a.target).data("inline")&&(d=!0);var e=k(this).closest(c.replySelector).data("id"),f=k(this).closest(c.containerSelector),l=k(this).hasClass("previous")?"previous":"next",m=null,p=null;if("previous"==l)m=k(this).closest(c.loadMoreSelector).next(c.replySelector);else{var m=k(this).closest(c.loadMoreSelector).prev(c.replySelector),q=
m.find(".explicitpager");q&&0<q.length&&(p=q.data("explicitpageindex"))}q=b(c,f);c.loadingPage=!0;k.telligent.evolution.messaging.publish("ui.replies.loadpage",{parentId:e,startReplyId:"next"==l&&m&&0<m.length?m.data("id"):null,endReplyId:"previous"==l&&m&&0<m.length?m.data("id"):null,offsetElement:m,currentDepth:q,sortBy:f.data("sortby"),sortOrder:f.data("sortorder"),filter:f.data("filter"),explicitPageIndex:p,loadDirection:l,explicitContainer:f,loadInline:d});k(a.target).closest("li").addClass("loading");
return!1});c.wrapper.on("click",c.newReplySelector,function(a){a.preventDefault();a=k(a.target);0==a.closest(c.replySelector).find(">.newreply .reply-form").length?(z(c,a.closest(c.replySelector).data("id"),!0),a.data("label-cancel")&&a.html(a.data("label-cancel"))):(x(c),a.data("label-reply")&&a.html(a.data("label-reply")));return!1});k(h).on("scroll",e.debounce(function(){k.telligent.evolution.messaging.publish("ui.replies.interaction.stop")},2E3,function(){a(c)}))}function a(a){k.telligent.evolution.messaging.publish("ui.replies.interaction.start")}
function b(a,b){var c=b.data("depth");if(null==c||c==n)c=b.parents(a.containerSelector).length+1,b.data("depth",c);return c}function p(a,c,d,e,g){var f=!1,q=!1,r=null,k=null;g.permaLinked&&(g.includeExplicitLoaders&&g.permaLinked&&0<d.length&&d[0].id==g.permaLinked)&&(q=!0);if(q){var n=!1,s=l(a,c,"next");null!==s&&0<s.length&&(r=s,n=!0);n&&(n=w(a,c,"previous",!1,!0),n&&0!=n.length&&document.contains(n[0])||(k=w(a,c,"previous",!0),c.append(k)))}for(n=0;n<d.length;n++){var s=d[n],v=t(a,c,s.id);if(v){g.loadInline&&
0<v.next("li.load-more[data-inline]").length&&(f=!0);s.isDeleted&&v.addClass("deleted");v.data("createddate",s.createdDate);v.data("yesvotes",s.yesVotes);v.data("novotes",s.noVotes);var x=v.find(".rendered-content").first();x.empty().append(s.body);x.get(0).className="rendered-content "+s.status}else{if(!q&&g.permaLinked&&!g.touchedPermaLink){var z=w(a,c,"previous");c.prepend(z)}z=b(a,c);s.sortBy=z>a.flattenedDepth?g.flattenedSortBy:g.sortBy;s.sortOrder=z>a.flattenedDepth?g.flattenedSortOrder:g.sortOrder;
if(z=m(a,c,s,g.appendOnly,g.onlyIfVisible))z.appendDirection===D.down&&null!==r?r.remove():z.appendDirection===D.up&&null!==k&&k.remove();else return k&&k.remove(),!1;v=z.renderedReply;!g.permaLinked||(g.touchedPermaLink||q)||(x=w(a,c,"next"),c.append(x));s.id==g.permaLinked&&(g.touchedPermaLink=!0);g.highlightNew&&function(){var b=v;b.addClass(a.highlightClassName);h.setTimeout(function(){b.removeClass(a.highlightClassName)},a.highlightTimeout)}()}g.highlightPermaLinked&&s.id==g.permaLinked&&function(){var b=
v;b.addClass(a.highlightClassName);h.setTimeout(function(){b.removeClass(a.highlightClassName)},a.highlightTimeout)}();a.newRepliesIndicatorRegistrar.decrement({replyId:s.id});if(s.children&&0<s.children.length&&(x=v.find(a.containerSelector).first(),!p(a,x,s.children,e+1,g)))return!1}g.loadInline&&(d.length<a.pageSize||f)&&(k=w(a,c,"previous",!1,!0),k.remove());e=0===e&&g.loadDirection?"previous"==g.loadDirection?"previous":"down":z&&z.appendDirection==D.up?"previous":"down";g.loadInline||(d.length>=
a.pageSize?(d=w(a,c,e),"previous"==e?d.prependTo(c):d.appendTo(c)):g.permaLinked||w(a,c,e).remove());return!0}function m(a,b,c,d,g){c.filter=a.filter;var f=k(a.replyTemplate(c));f.data(E+"votes",c.yesVotes-c.noVotes);f.data(E+"createdDate",k.telligent.evolution.parseDate(c.createdDate).getTime());if(d)b.append(f),b=D.down;else if(d=b.children(a.replySelector),a=q(a,d,c,f),a<d.length){if(g&&!e.isBottomVisible(document,k(d.get(a))))return!1;b=f.get(0);g=d.get(a);g.parentNode.insertBefore(b,g);k.telligent.evolution.ui.render(b);
b=D.up}else{if(g&&!e.isBottomVisible(document,b))return!1;b.append(f);b=D.down}return{renderedReply:f,appendDirection:b}}function q(a,b,c,d){var g="Ascending"==c.sortOrder?1:-1;return e.determineInsertionIndex(b,d,function(a,b){a=k(a);b=k(b);if("CreatedDate"==c.sortBy)return aDate=a.data(E+"createdDate"),bDate=b.data(E+"createdDate"),aDate<bDate?-1*g:aDate>bDate?1*g:0;aDate=a.data(E+"createdDate");bDate=b.data(E+"createdDate");aVotes=a.data(E+"votes");bVotes=b.data(E+"votes");return aVotes<bVotes?
-1*g:aVotes>bVotes?1*g:aDate<bDate?-1:aDate>bDate?1:0},{equivalentBefore:!1})}function t(a,b,c){return(a=b.find('li.content-item[data-id="'+c+'"]').first())&&a.length?a:null}function l(a,b,c,d){var e=null;return e="previous"==c?b.children(a.loadMorePreviousSelector+(d?"[data-inline]":"")):b.children(a.loadMoreNextSelector+(d?"[data-inline]":""))}function w(a,b,c,d,e){var g=null;d||(g="previous"==c?b.children(a.loadMorePreviousSelector+(e?"[data-inline]":"")):b.children(a.loadMoreNextSelector+(e?"[data-inline]":
"")));return g&&0<g.length?(e||g.detach(),g):k(a.loadMoreTemplate({previous:"previous"==c,loadInline:d}))}function r(a){a.onEditorRemove();delete a.root;var b=a.container.children(".reply-header").detach();a.container.empty().append(b)}function v(a,b){var c=t(a,a.container,b.replyId);c&&0<c.length&&(clearTimeout(a.currentlyScrollingTiemeout),a.scrolling=!0,b.highlight&&(a.container.find(".permalinked").removeClass("permalinked"),c.addClass("permalinked")),c=c.find(a.renderedContentSelector).first(),
e.scrollToElementIfNotVisible(document,c,130),a.currentlyScrollingTiemeout=setTimeout(function(){a.scrolling=!1},1E3))}function s(a){a.fadeOut(500,function(){a.remove()})}function y(a,b){a.root.find('li.content-item[data-parentid="'+b+'"]').each(function(){var b=k(this);y(a,b.data("id"));var c=b.prev(a.loadMorePreviousSelector);s(c);s(b)})}function x(a){a.onEditorRemove();a.container.find(".reply-form").each(function(){k(this).closest(".threaded.content-item").removeClass("hide-content").removeClass("edit")}).remove();
a=a.wrapper.find(a.newReplySelector);a.data("label-reply")&&a.html(a.data("label-reply"))}function z(b,c){x(b);var d=null;if((d=t(b,b.root,c).find(".newreply").first())&&0!=d.length){var e=d.find(".reply-form").first();0==e.length&&(e=k(b.replyFormTemplate({editingReplyId:null})),d.append(e));b.onEditorAppendTo({container:e.find(".editor").first()});b.onEditorVal({val:""});b.onEditorFocus();a(b)}}var A={replyTemplate:null,loadMoreTemplate:null,typingIndicatorTemplate:null,newRepliesTemplate:null,
highlightClassName:"new",wrapper:null,container:null,highlightTimeout:4E3,flattenedDepth:null,loadOnScroll:!1},E="_evolutionThreadReplies:",D={up:1,down:2};return function(g){var f=k.extend({},A,g||{});c(f);d(f);return{renderReplies:function(a){f.container.find(f.loadMoreSelector).removeClass("loading");f.loadingPage=!1;f.root||(f.root=k(f.replyListTemplate({sortBy:0==f.flattenedDepth?a.flattenedSortBy:a.sortBy,sortOrder:0==f.flattenedSortOrder?a.flattenedSortOrder:a.sortOrder,filter:f.filter===n?
f.onGetFilter():f.filter})).appendTo(f.container));var c=a.explicitContainer?a.explicitContainer:f.root;if(!a.explicitContainer&&a.replies&&0<a.replies.length&&a.replies[0].parentId){var d=t(f,f.root,a.replies[0].parentId);d&&(c=d.find(f.containerSelector).first())}d=b(f,c)-1;!a.explicitContainer&&d>f.flattenedDepth&&(c=c.parents(f.containerSelector).first());return p(f,c,a.replies,0,a)},empty:function(){return r(f)},scrollTo:function(a){return v(f,a)},indicateTyping:function(a){if(!f.newRepliesIndicatorRegistrar.isIndicating(a.parentId)){var b=
t(f,f.root,a.parentId),b=null!==b?b.find(".typing-status-wrapper").first():f.wrapper.find(".typing-status-wrapper").first();a.typing?b.empty().append(f.typingIndicatorTemplate({displayName:a.authorDisplayName})):b.empty()}},indicateNewReplies:function(a){f.root&&t(f,f.root,a.parentId);f.newRepliesIndicatorRegistrar.increment({parentId:a.parentId,replyId:a.replyId})},updateVotes:function(a){var b=t(f,f.root,a.replyId);b&&0<b.length&&(b=b.find(".votes").first(),!0===a.value?(b.find("a.vote").removeClass("selected"),
b.find(".up").first().addClass("selected")):!1===a.value?(b.find("a.vote").removeClass("selected"),b.find(".down").first().addClass("selected")):null===a.value&&b.find("a.vote").removeClass("selected"),a.yesVotes!==n&&a.noVotes!==n&&(a=a.yesVotes-a.noVotes,b.find(".vote.current").html(0<a?"+"+a:a)))},renderEdit:function(b){var c=t(f,f.root,b.replyId);if(c&&0<c.length){c.addClass("hide-content").addClass("edit");x(f);var c=c.find(".edit-form").first(),d=c.find(".reply-form").first();0==d.length&&(d=
k(f.replyFormTemplate({editingReplyId:b.replyId})),c.append(d));f.onEditorAppendTo({container:d.find(".editor").first()});f.onEditorVal({val:b.reply.rawBody,meta:b.reply});f.onEditorFocus();a(f)}},isContainerVisible:function(a){f.root?(a=t(f,f.root,a.parentId),a&&0!=a.length||(a=f.root),a=e.isPartiallyVisible(document,a)):a=!1;return a},isReplyRendered:function(a){a=f.root?(a=t(f,f.root,a.replyId))&&0<a.length:!1;return a},hideReplyForms:function(){return x(f)},removeReply:function(a){f.onEditorRemove();
if(f.root){var b=t(f,f.root,a.replyId);if(0<b.length){var c=b.prev(f.loadMorePreviousSelector);s(c)}s(b);y(f,a.replyId);a=void 0}else a=!1;return a},showReplyForm:function(a){return z(f,a.replyId)},appendHeaderContent:function(a){f.headerContainer.append(a)},showLoading:function(){f.container.append('<span class="ui-loading" data-width="48" data-height="48"></span>')}}}},jQuery,window);u("plugin.evolutionThreadReplies.utility",function(f,e,k){var h={throttle:function(f,g){var c,d;return function(){var a=
this,b=(new Date).getTime(),p=arguments;c&&c+(g||50)>b?(e.clearTimeout(d),d=e.setTimeout(function(){c=b;f.apply(a,p)},g||50)):(c=b,f.apply(a,p))}},debounce:function(e,g,c){var d;return function(){var a=this,b=arguments;c&&!d&&c.apply(a,b);clearTimeout(d);d=null;d=setTimeout(function(){e.apply(a,b);clearTimeout(d);d=null},g||10)}},determineInsertionIndex:function(e,g,c,d){if(null==e||0===e.length||null===g)return 0;var a=0,b=e.length,f,m;f=c(g,e[a]);m=b-1===a?f:c(g,e[b-1]);if(0>f)return a;if(0===f)return d&&
d.equivalentBefore?a:a+1;if(0<m)return b;if(0===m)return d&&d.equivalentBefore?b-1:b;for(;a<b;){f=Math.floor((a+b)/2);m=c(e[f],g);if(0===m)return d&&d.equivalentBefore?f:f+1;0>m?a=f+1:b=f}return a},isPartiallyVisible:function(h,g,c){c=c||0;if(h==document||h instanceof jQuery&&(h.get(0)==document||h.is("body"))){var d=g instanceof jQuery?g.get(0).getBoundingClientRect():g.getBoundingClientRect();return 0<d.top-c&&d.top+c<=(e.innerHeight||document.documentElement.clientHeight)||0<d.bottom-c&&d.bottom+
c<=(e.innerHeight||document.documentElement.clientHeight)}h=f(h);d=g.offset().top;g=d+g.height();var a=h.offset().top;h=a+h.height();return d+c>=a&&d-c<=h||g-c<=h&&g+c>=a},isFullyVisible:function(h,g,c){c=c||0;if(h==document||h instanceof jQuery&&(h.get(0)==document||h.is("body"))){var d=g instanceof jQuery?g.get(0).getBoundingClientRect():g.getBoundingClientRect();return 0<d.top-c&&d.top+c<=(e.innerHeight||document.documentElement.clientHeight)&&0<d.bottom-c&&d.bottom+c<=(e.innerHeight||document.documentElement.clientHeight)}h=
f(h);d=g.offset().top;g=d+g.height();var a=h.offset().top;h=a+h.height();return d+c>=a&&g-c<=h},isBottomVisible:function(h,g,c){c=c||0;if(h==document||h instanceof jQuery&&(h.get(0)==document||h.is("body"))){var d=g instanceof jQuery?g.get(0).getBoundingClientRect():g.getBoundingClientRect();return 0<d.bottom-c&&d.bottom+c<=(e.innerHeight||document.documentElement.clientHeight)}h=f(h);d=h.scrollTop();h=d+h.height();g=g.offset().top+g.height();return g-c<=h&&g+c>=d},isTopVisible:function(h,g,c){c=
c||0;if(h==document||h instanceof jQuery&&(h.get(0)==document||h.is("body"))){var d=g instanceof jQuery?g.get(0).getBoundingClientRect():g.getBoundingClientRect();return 0<d.top-c&&d.top+c<=(e.innerHeight||document.documentElement.clientHeight)}h=f(h);d=h.scrollTop();h=d+h.height();g=g.offset().top;return g+c<=h&&g-c>=d},scrollToElementIfNotVisible:function(e,g,c,d){c=c||0;d=d||100;h.isFullyVisible(e,g,c)||(e=f(e),e.get(0)==document&&(e=f("html, body")),e.stop().animate({scrollTop:g.offset().top-
c},d))}};return h},jQuery,window);u("plugin.evolutionThreadReplies.votersPopup",function(f,e,k){var h={votersTemplate:' <% if(voters && voters.length > 0) { %> \t<% foreach(voters, function(voter) { %> \t\t<li class="content-item"> \t\t\t<div class="full-post-header"></div> \t\t\t<div class="full-post"> \t\t\t\t<span class="avatar"> \t\t\t\t\t<a href="<%: voter.profileUrl %>"  class="internal-link view-user-profile"> \t\t\t\t\t\t<% if(voter.avatarHtml) { %> \t\t\t\t\t\t\t<%= voter.avatarHtml %> \t\t\t\t\t\t<% } else { %> \t\t\t\t\t\t\t<img src="<%: voter.avatarUrl %>" alt="" border="0" width="32" height="32" style="width:32px;height:32px" /> \t\t\t\t\t\t<% } %> \t\t\t\t\t</a> \t\t\t\t</span> \t\t\t\t<span class="user-name"> \t\t\t\t\t<a href="<%: voter.profileUrl %>" class="internal-link view-user-profile"><%= voter.displayName %></a> \t\t\t\t</span> \t\t\t</div> \t\t\t<div class="full-post-footer"></div> \t\t</li> \t<% }); %> <% } else { %> \t<li> \t\t<span class="content"><%= noVotesText %></span> \t</li> <% } %>',
votersPopupTemplate:' <div class="who-likes-list">      <div class="content-list-header"></div>      <ul class="content-list"><%= voters %></ul>      <div class="content-list-footer"></div>      <% if(hasMorePages) { %>          <a href="#" class="show-more"><%= showMoreText %></a>     <% } %>  </div> ',noVotesText:"No Votes",delegatedSelector:".votes .current",modalTitleText:"",modalShowMoreText:"More",loadVoters:function(e){}};return function(e){var g=f.extend({},h,e||{}),c=f.extend({},h,e||{}),
d=f.telligent.evolution.template.compile(c.votersTemplate),a=f.telligent.evolution.template.compile(c.votersPopupTemplate),b=function(a,b,c){g.loadVoters({replyId:a.replyid,pageIndex:b}).then(function(a){f.telligent.evolution.batch(function(){f.each(a.Users,function(a,b){f.telligent.evolution.get({url:f.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/ui/image.json",data:{url:b.AvatarUrl,maxWidth:32,maxHeight:32,resizeMethod:"ZoomAndCrop"}}).done(function(a){b.userAvatarHtml=a.Html})})}).done(function(){c({voters:f.map(a.Users,
function(a){return{displayName:a.DisplayName,profileUrl:a.ProfileUrl,avatarHtml:a.userAvatarHtml}}),hasMorePages:(a.PageIndex+1)*a.PageSize<a.TotalCount})})})},p=function(e,g){var p=0,l=f(d(f.extend(e,{noVotesText:c.noVotesText||h.noVotesText}))),k=f.telligent.evolution.ui.data(f(g)),r=f(a({voters:l,hasMorePages:e.hasMorePages,showMoreText:c.modalShowMoreText})),n=r.find("ul"),s=r.find(".show-more");n.html(l);s.on("click",function(a){a.preventDefault();p++;b(k,p,function(a){n.append(d(a));a.hasMorePages?
s.show():s.hide();n.scrollTop(n[0].scrollHeight)})});f.glowModal({title:c.modalTitleText,html:r,width:450,height:"100%"})};return{handleVoterPopupRequests:function(a){f(a.container).on("click",c.delegatedSelector,function(a){a.preventDefault();var c=f(this);a=f.telligent.evolution.ui.data(f(c));b(a,0,function(a){p(a,c)});return!1})}}}},jQuery,window);u("plugin.evolutionTip",function(f,e,k){function h(){n&&(n.ui.remove(),"title"!=n.attribute&&"alt"!=n.attribute||n.element.attr(n.attribute,n.content),
n.options.shown=!1)}var n;f.fn.evolutionTip=function(e){var c=f.extend({},f.fn.evolutionTip.defaults,e||{});c.template=f.telligent.evolution.template.compile(c.template);return this.off("._evolutionTip").on("mouseenter._evolutionTip mouseover._evolutionTip",function(d){if(!d.originalEvent._evolutionTipHandled&&!c.shown){h();for(var a=f(this),b=["data-"+c.attribute,"title","alt"],e,g,q=0;q<b.length;q++){e=b[q];var t=a.attr(e);if(t&&0<f.trim(t).length){g=t;break}}g&&0!=g.length&&(n={attribute:e,content:g,
element:a,options:c,ui:f(c.template({content:g})).css({position:"absolute",top:-500,left:-500}).appendTo("body")},"title"!=n.attribute&&"alt"!=n.attribute||n.element.attr(n.attribute,""),g=f(window),e=f(document).scrollTop(),b=a.offset(),targetWidth=a.outerWidth(),targetHeight=a.outerHeight(),windowWidth=g.outerWidth(),windowHeight=g.outerHeight(),tipWidth=n.ui.outerWidth(),tipHeight=n.ui.outerHeight(!0),c.horizontal?a=c.horizontal:(a="center",30>=b.left-tipWidth/2?a="left":30>=windowWidth-(b.left+
targetWidth+tipWidth/2)&&(a="right")),c.vertical?g=c.vertical:(g="above",30>=targetHeight+b.top-tipHeight-e&&(g="below")),e="right"==a?b.left+targetWidth-tipWidth:"left"==a?b.left:b.left+targetWidth/2-tipWidth/2,b="above"==g?b.top-tipHeight:b.top+targetHeight,n.options.shown=!0,n.ui.addClass(g).addClass(a).css({left:e,top:b,"z-index":1E6}))}d.originalEvent._evolutionTipHandled=!0}).on("mouseleave._evolutionTip",function(){c.shown&&h()})};f.fn.evolutionTip.hide=function(){h()};f.fn.evolutionTip.defaults=
{template:'<div class="tip"><%= content %></div>',attribute:"tip"};return{}},jQuery,window);u("plugin.evolutionToggleLink",function(f,e,k){var h={val:function(c){if(void 0===c){var d=this.data("evolutionToggleLink");return d?d.settings.val:!1}return this.each(function(){var a=f(this).data("evolutionToggleLink");a&&(a.settings.val=c,a.internal.processing=!1,g(a))})}},n=function(c){return this.each(function(){var d={settings:f.extend({},f.fn.evolutionToggleLink.defaults,c||{}),internal:{state:f(this),
processing:!1}};d.internal.state.data("evolutionToggleLink",d).click(function(a){!d.internal.processing&&d.settings.changeState&&(d.internal.processing=!0,g(d),d.settings.changeState(!d.settings.val));return!1});g(d)})},g=function(c){c.internal.processing?c.internal.state.attr("class",c.settings.processingCssClass).attr("title",c.settings.processingTitle).html(c.settings.processingHtml):c.settings.val?c.internal.state.attr("class",c.settings.onCssClass).attr("title",c.settings.onTitle).html(c.settings.onHtml):
c.internal.state.attr("class",c.settings.offCssClass).attr("title",c.settings.offTitle).html(c.settings.offHtml)};f.fn.evolutionToggleLink=function(c){if(c in h)return h[c].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof c&&c)f.error("Method "+c+" does not exist on jQuery.fn.evolutionToggleLink");else return n.apply(this,arguments)};f.extend(f.fn.evolutionToggleLink,{defaults:{onHtml:"",offHtml:"",processingHtml:"",changeState:null,onCssClass:"",offCssClass:"",processingCssClass:"",
onTitle:"",offTitle:"",processingTitle:"",val:!1}});return{}},jQuery,window);u("plugin.evolutionTokenTextBox",function(f,e,k){function h(a){var b=a.internal.textbox.val(),c="",d=0;a.internal.tokens.sort(function(a,b){return a.start-b.start});for(var e=0;e<a.internal.tokens.length;e++){var g=a.internal.tokens[e];g.start>d&&(c+=b.substr(d,g.start-d));c+=g.value;d=g.stop}d<b.length&&(c+=b.substr(d));a.internal.state.val(c);a.internal.lastLength=a.internal.textbox.val().length;a.internal.textbox.evolutionHighlight({ranges:a.internal.tokens})}
function n(a){var b=a.internal.textbox.get(0);if(b.selectionStart)return b.selectionStart;if(document.selection){a=document.selection.createRange();if(null===a)return 0;var b=b.createTextRange(),c=b.duplicate();b.moveToBookmark(a.getBookmark());c.setEndPoint("EndToStart",b);return c.text.length}return 0}function g(a){for(var b=/\$\{token:([0-9a-f]{8,8}-[0-9a-f]{4,4}-[0-9a-f]{4,4}-[0-9a-f]{4,4}-[0-9a-f]{12,12})(?::([^}]*))?\}/gi,d,e=0,g="",f=a.internal.state.val(),l=[],k=0;d=b.exec(f);){var r=d.index;
r>e&&(g+=f.substr(e,r-e));e=d[0];r=c[e];!r&&a.settings.previewToken&&(r=a.settings.previewToken(e));r||(r=e);l.push({start:d.index-k,stop:d.index-k+r.length,value:e,text:r,className:a.settings.highlightClassName});k+=e.length-r.length;g+=r;e=b.lastIndex}e<f.length&&(g+=f.substr(e));a.internal.tokens=l;a.internal.textbox.val(g);h(a)}var c={},d={init:function(a){return f(this).each(function(){a.tokenPlaceholders&&(c=f.extend({},c,a.tokenPlaceholders),delete a.tokenPlaceholders);var b={settings:f.extend({},
f.fn.evolutionTokenTextBox.defaults,a),internal:{state:f(this),textbox:f(this).clone().removeAttr("id").removeAttr("name").css("box-sizing","content-box"),lastLength:f(this).val().length,tokens:[]}};b.internal.state.after(b.internal.textbox).hide().data("_evolutionTokenTextBox",b);b.internal.textbox.on("evolutionRangeClick",function(a,d){e.evolutionInsertEditTokenOptions={dataTypeIds:b.settings.tokenDataTypeIds,token:d.value,save:function(a,e){c[a]=e;var g=b.internal.textbox.val(),g=g.substr(0,d.start)+
e+g.substr(d.stop);b.internal.textbox.val(g);var p=d.stop,r=e.length-d.text.length;d.stop=d.start+e.length;d.value=a;d.text=e;f.each(b.internal.tokens,function(){this.start>=p&&(this.start+=r,this.stop+=r)});h(b)},del:function(){var a=b.internal.textbox.val(),a=a.substr(0,d.start)+a.substr(d.stop),c=d.stop-d.start,e=d.start;b.internal.textbox.val(a);b.internal.tokens=f.grep(b.internal.tokens,function(a){return a.start!=e});f.each(b.internal.tokens,function(){this.start>=e&&(this.start-=c,this.stop-=
c)});h(b)}};f.glowModal(b.settings.insertEditTokenUrl,{width:b.settings.insertEditTokenModalWidth,height:b.settings.insertEditTokenModalHeight})});b.internal.textbox.evolutionResize().on("evolutionResize",function(){b.internal.textbox.evolutionHighlight("resize",b.internal.textbox.outerWidth(),b.internal.textbox.outerHeight())});b.internal.textbox.on("keydown",function(a){var c=n(b),d=!1,e=null;(37>a.which||40<a.which)&&f.each(b.internal.tokens,function(){(this.start<c||this.start==c&&46==a.which)&&
(this.stop>c||this.stop==c&&8==a.which)&&(d=!0,e=this)});if(d){if(8==a.which||46==a.which){var g=b.internal.textbox.val(),g=g.substr(0,e.start)+g.substr(e.stop),k=e.stop-e.start,r=e.start;b.internal.textbox.val(g);b.internal.tokens=f.grep(b.internal.tokens,function(a){return a.start!=r});f.each(b.internal.tokens,function(){this.start>=r&&(this.start-=k,this.stop-=k)});h(b);g=b.internal.textbox.get(0);g.createTextRange?(g=g.createTextRange(),g.move("character",c>r?c-k:c),g.select()):g.selectionStart&&
(g.focus(),g.setSelectionRange(c>r?c-k:c,c>r?c-k:c))}a.preventDefault();a.stopPropagation();return!1}});b.internal.textbox.on("keyup",function(){var a=b.internal.textbox.val().length;if(a!=b.internal.lastLength){var c=a-b.internal.lastLength;b.internal.lastLength=a;var d=n(b);f.each(b.internal.tokens,function(){this.start>=d-1&&(this.start+=c,this.stop+=c)});h(b)}});g(b)})},val:function(a){if(a===k){var b=f(this).data("_evolutionTokenTextBox");return b?b.internal.state.val():""}return f(this).each(function(){var b=
f(this).data("_evolutionTokenTextBox");b&&(b.internal.state.val(a),g(b))})},insertToken:function(){return f(this).each(function(){var a=f(this).data("_evolutionTokenTextBox");a&&(e.evolutionInsertEditTokenOptions={dataTypeIds:a.settings.tokenDataTypeIds,token:"",save:function(b,d){c[b]=d;var e=n(a);a.internal.textbox.val(a.internal.textbox.val().substr(0,e)+d+a.internal.textbox.val().substr(e));f.each(a.internal.tokens,function(){this.start>=e&&(this.start+=d.length,this.stop+=d.length)});a.internal.tokens.push({start:e,
stop:e+d.length,value:b,text:d,className:a.settings.highlightClassName});h(a)},del:function(){}},f.glowModal(a.settings.insertEditTokenUrl,{width:a.settings.insertEditTokenModalWidth,height:a.settings.insertEditTokenModalHeight}))})},tokenDataTypeIds:function(a){if(a===k){var b=f(this).data("_evolutionTokenTextBox");return b?b.settings.tokenDataTypeIds:[]}return f(this).each(function(){var b=f(this).data("_evolutionTokenTextBox");b&&(b.settings.tokenDataTypeIds=a||[])})}};f.fn.evolutionTokenTextBox=
function(a){if(d[a])return d[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)f.error("Method "+a+" does not exist on jQuery.evolutionHighlight");else return d.init.apply(this,arguments)};f.fn.evolutionTokenTextBox.defaults={highlightClassName:"token-highlight",insertEditTokenUrl:"",previewToken:function(a){return a},insertEditTokenModalWidth:400,insertEditTokenModalHeight:500,tokenDataTypeIds:[],tokenPlaceholders:null};return{}},jQuery,window);u("plugin.evolutionTransform",
function(f,e,k){function h(){var a=(document.body||document.documentElement).style,b="Moz webkit Webkit Khtml O ms".split(" ");if("string"==typeof a.transition)return!0;for(var c=0;c<b.length;c++)if("string"==typeof a[b[c]+"Transition"])return!0;return!1}function n(v,s){if(!this||0==this.length)return this;var y=v||{};s=s||{};var x=[],z,A,E=null,D=null,u=null,B=null;v=[];null===w&&(w=h());this.each(function(){if(3!==this.nodeType){var h=f(this),J=!1,M=null,P=function(){e.clearTimeout(M);J||(J=!0,
h.css({transition:"all 0s"}).off(".evolutionTransform"),s.complete&&s.complete())};h.off(".evolutionTransform").on("transitionend.evolutionTransform webkitTransitionEnd.evolutionTransform oTransitionEnd.evolutionTransform MSTransitionEnd.evolutionTransform",function(){P()});if(!w)return y.x&&(y.left=y.x),y.y&&(y.y=y.y),h.css(y);for(var C in n.defaults)s[C]||(s[C]=n.defaults[C]);for(var F in y)C=y[F],F===g||F===d?(z=C,delete y[F]):F===c||F===a?(A=C,delete y[F]):F===b?(E=C,delete y[F]):F===p?(D=C,delete y[F]):
F===m?(u=C,delete y[F]):F===q?(B=C,delete y[F]):(F==t?0===C?y[F]=1E-5:1===C&&(y[F]=0.99999):"number"===typeof C&&0==C%1&&(y[F]=C+"px"),x[x.length]=F);if(z!=k||A!=k)v[v.length]="translate3d("+(z||0)+"px, "+(A||0)+"px, 0px)";E!=k&&(v[v.length]="rotateZ("+E+"deg)");D!=k&&(v[v.length]="rotateX("+D+"deg)");u!=k&&(v[v.length]="rotateY("+u+"deg)");B!=k&&(v[v.length]="scale("+B+")");0<v.length&&(C=r+"transform",mergedTransforms=v.join(" "),x[x.length]=C,y[C]=mergedTransforms,y.transform=mergedTransforms);
C=f.fn.evolutionTransform.animationEnabled?s.duration/1E3+"s "+s.easing:"";transition=x.join(" "+C+", ")+" "+C;f.noop(this.offsetHeight);if(u||D)l=l||f("body").get(0),l.style[r+"perspective"]=s.perspective,l.style.perspective=s.perspective;this.style[r+"transition"]=transition;this.style.transition=transition;for(F in y)this.style[F]=y[F];M=e.setTimeout(function(){P()},s.duration+100)}});return this}var g="x",c="y",d="left",a="top",b="rotate",p="rotateX",m="rotateY",q="scale",t="opacity",l,w=null,
r=function(){if(!("getComputedStyle"in window))return"";var a=window.getComputedStyle(document.documentElement,"");return"-"+(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms)-/)||""===a.OLink&&["","o"])[1]+"-"}();n.defaults={duration:0,easing:"linear",perspective:250,complete:null};f.fn.evolutionTransform=n;f.fn.evolutionTransform.animationEnabled=!0;f.fn.evolutionTransform.accelerated=function(){null===w&&(w=h());return w};return{}},jQuery,window);u("plugin.evolutionUserFileTextBox",
function(f,e,k){var h={},n=1,g=function(c){return this.each(function(){var d={settings:f.extend({},f.fn.evolutionUserFileTextBox.defaults,c||{}),internal:{state:this,preview:null,select:null,remove:null}};f.telligent.evolution.post({url:d.settings.endpoint,data:{m:"c"},success:function(a){d.internal.contextid=a.uploadContextId;d.internal.uploadurl=a.uploadUrl;a=f("<div></div>").attr("class",d.settings.cssClass);d.internal.preview=f("<div></div>").attr("class",d.settings.previewCssClass);a.append(d.internal.preview);
d.internal.select=f('<a href="#" class="upload"></a>').attr("id","userfiletextbox_"+(new Date).getTime()+"_"+n++).html(d.settings.selectText).glowUpload({fileFilter:null,uploadUrl:d.internal.uploadurl,renderMode:"link"}).bind("glowUploadBegun",function(a){d.uploading=!0;d.internal.select.html("0%")}).bind("glowUploadComplete",function(a,b){d.internal.select.html(d.settings.selectText);b&&0<b.name.length&&f.telligent.evolution.post({url:d.settings.endpoint,data:{m:"f",ContextId:d.internal.contextid,
FileName:b.name},success:function(a){d.internal.state.value=a.url;d.uploading=!1;d.internal.preview.html(a.previewHtml).slideDown(100);d.internal.remove.show()}})}).bind("glowUploadFileProgress",function(a,b){d.internal.select.html(b.percent+"%")});a.append(d.internal.select);d.internal.remove=f('<a href="#" class="remove" style="margin-left: 1em;"></a>').html(d.settings.removeText).click(function(){d.internal.preview.html("").slideUp(100);d.internal.state.value="";d.internal.remove.hide();return!1}).hide();
a.append(d.internal.remove);var b=f(d.internal.state).val();b?(d.internal.remove.show(),f.telligent.evolution.post({url:d.settings.endpoint,data:{m:"p",Url:b},success:function(a){d.internal.preview.html(a.previewHtml).slideDown(100)}})):d.internal.preview.html("").hide();f(d.internal.state).data("evolutionUserFileTextBox",d).before(a).hide()}})})};f.fn.evolutionUserFileTextBox=function(c){if(c in h)return h[c].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof c&&c)f.error("Method "+
c+" does not exist on jQuery.fn.evolutionUserFileTextBox");else return g.apply(this,arguments)};f.extend(f.fn.evolutionUserFileTextBox,{defaults:{removeText:"",selectText:"",noFileText:"",initialPreviewHtml:"",cssClass:"user-file-url",previewCssClass:"user-file-url-preview",endpoint:""}});return{}},jQuery,window);u("plugin.validation",function(f,e,k){f.telligent||(f.telligent={});f.telligent.evolution||(f.telligent.evolution={});f.telligent.evolution.validation={registerExtensions:function(a){f.validator&&
(f.validator.addMethod("passwordvalid",function(b,c){return this.optional(c)||b.match(a.passwordRegex)},a.passwordInvalidMessage),f.validator.addMethod("email",function(b,c){return this.optional(c)||b.match(RegExp(a.emailRegex))},a.emailInvalidMessage),f.validator.addMethod("url",function(b,c){return this.optional(c)||b.match(a.urlRegex)?!0:("http://"+b).match(a.urlRegex)?(f(c).val("http://"+b),!0):!1},a.urlInvalidMessage),f.validator.addMethod("emails",function(b,c){for(var d=b.split(/[;,]/),e=!0,
g=RegExp(a.emailRegex),f=0;f<d.length;f++)jQuery.trim(d[f]).match(g)||(e=!1);return this.optional(c)||e},a.emailsInvalidMessage),f.validator.addMethod("username",function(b,c){return this.optional(c)||b.match(a.usernameRegex)},a.usernameInvalidMessage),f.validator.addMethod("usernameexists",function(a,b,c){if(this.optional(b))return"dependency-mismatch";var d=this.previousValue(b);this.settings.messages[b.name]||(this.settings.messages[b.name]={});d.originalMessage=this.settings.messages[b.name].remote;
this.settings.messages[b.name].remote=d.message;c="string"==typeof c&&{url:c}||c;var e=f.telligent.evolution.site.getBaseUrl()+"Utility/Validation/Core_Validator.asmx/IsUsernameAvailable";c.url&&(e=c.url);if(d.old!==a){d.old=a;var g=this;this.startRequest(b);var m='{"username":"'+a+'","elementName":"'+b.name+'"}';f.telligent.evolution.post({url:e,dataType:"json",contentType:"application/json; charset=utf-8",data:m,success:function(c){b=g.findByName(c.d.ElementName)[0];g.settings.messages[b.name].remote=
d.originalMessage;var e=!0===c.d.IsValid;if(e){var p=g.formSubmitted;g.prepareElement(b);g.formSubmitted=p;g.successList.push(b);g.showErrors()}else p={},c=d.message=c.d.ErrorMessage||g.defaultMessage(b,"usernameexists"),p[b.name]=f.isFunction(c)?m(a):c,g.showErrors(p);d.valid=e;g.stopRequest(b,e)}});return"pending"}return this.pending[b.name]?"pending":d.valid},void 0),f.validator.addMethod("emailexists",function(a,b,c){if(this.optional(b))return"dependency-mismatch";var d=this.previousValue(b);
this.settings.messages[b.name]||(this.settings.messages[b.name]={});d.originalMessage=this.settings.messages[b.name].remote;this.settings.messages[b.name].remote=d.message;c="string"==typeof c&&{url:c}||c;var e=f.telligent.evolution.site.getBaseUrl()+"Utility/Validation/Core_Validator.asmx/IsEmailAvailable";c.url&&(e=c.url);if(d.old!==a){d.old=a;var g=this;this.startRequest(b);var m='{"email":"'+a+'","elementName":"'+b.name+'"}';f.telligent.evolution.post({url:e,dataType:"json",contentType:"application/json; charset=utf-8",
data:m,success:function(c){b=g.findByName(c.d.ElementName)[0];g.settings.messages[b.name].remote=d.originalMessage;var e=!0===c.d.IsValid;if(e){var p=g.formSubmitted;g.prepareElement(b);g.formSubmitted=p;g.successList.push(b);g.showErrors()}else p={},c=d.message=g.customMessage(b.name,"emailexists")||c.d.ErrorMessage||g.defaultMessage(b,"emailexists"),p[b.name]=f.isFunction(c)?m(a):c,g.showErrors(p);d.valid=e;g.stopRequest(b,e)}});return"pending"}return this.pending[b.name]?"pending":d.valid},void 0),
f.validator.addMethod("groupnameexists",function(a,b,c){if(this.optional(b))return"dependency-mismatch";var d=encodeURIComponent(f.trim(a));if(0==d.length)return!0;var e=this.previousValue(b);this.settings.messages[b.name]||(this.settings.messages[b.name]={});e.originalMessage=this.settings.messages[b.name].remote;this.settings.messages[b.name].remote=e.message;c=c.getParentId();d='{"groupName":"'+d+'","parentGroupId":'+c+',"elementName":"'+b.name+'"}';if(e.old!==d){e.old=d;var g=this;this.startRequest(b);
c=f.telligent.evolution.site.getBaseUrl()+"Utility/Validation/Core_Validator.asmx/IsGroupNameAvailable";f.telligent.evolution.post({url:c,dataType:"json",contentType:"application/json; charset=utf-8",data:d,success:function(c){b=g.findByName(c.d.ElementName)[0];g.settings.messages[b.name].remote=e.originalMessage;var d=!0===c.d.IsValid;if(d){var m=g.formSubmitted;g.prepareElement(b);g.formSubmitted=m;g.successList.push(b);g.showErrors()}else m={},c=e.message=c.d.ErrorMessage||g.defaultMessage(b,"groupnameexists"),
m[b.name]=f.isFunction(c)?message(a):c,g.showErrors(m);e.valid=d;g.stopRequest(b,d)}});return"pending"}return this.pending[b.name]?"pending":e.valid},void 0),f.validator.addMethod("wikipageexists",function(a,b,c){if(this.optional(b))return"dependency-mismatch";var d=encodeURIComponent(f.trim(a));if(0==d.length)return!0;var e=this.previousValue(b);this.settings.messages[b.name]||(this.settings.messages[b.name]={});e.originalMessage=this.settings.messages[b.name].remote;this.settings.messages[b.name].remote=
e.message;c='{"pageName":"'+d+'","wikiId":'+c.wikiId+',"pageId":'+c.pageId+',"parentPageId":'+c.parentPageId()+',"elementName":"'+b.name+'"}';if(e.old!==c){e.old=c;var g=this;this.startRequest(b);d=f.telligent.evolution.site.getBaseUrl()+"Utility/Validation/Core_Validator.asmx/IsWikiPageNameAvailable";f.telligent.evolution.post({url:d,dataType:"json",contentType:"application/json; charset=utf-8",data:c,success:function(c){b=g.findByName(c.d.ElementName)[0];g.settings.messages[b.name].remote=e.originalMessage;
var d=!0===c.d.IsValid;if(d){var m=g.formSubmitted;g.prepareElement(b);g.formSubmitted=m;g.successList.push(b);g.showErrors()}else m={},c=e.message=c.d.ErrorMessage||g.defaultMessage(b,"wikipageexists"),m[b.name]=f.isFunction(c)?message(a):c,g.showErrors(m);e.valid=d;g.stopRequest(b,d)}});return"pending"}return this.pending[b.name]?"pending":e.valid},void 0),f.validator.addMethod("mailinglistnameexists",function(a,b,c){if(""==f.trim(a))return this.optional(b);var d=this.previousValue(b);this.settings.messages[b.name]||
(this.settings.messages[b.name]={});d.originalMessage=this.settings.messages[b.name].remote;this.settings.messages[b.name].remote=d.message;c="string"==typeof c&&{url:c}||c;var e=f.telligent.evolution.site.getBaseUrl()+"Utility/Validation/Core_Validator.asmx/IsMailingListNameAvailable";c.url&&(e=c.url);var g;c.id&&(g=c.id);if(d.old!==a){d.old=a;var m=this;this.startRequest(b);var p='{"mailingListName":"'+a+'","existingMailingListId":"'+g+'","elementName":"'+b.name+'"}';f.telligent.evolution.post({url:e,
dataType:"json",contentType:"application/json; charset=utf-8",data:p,success:function(c){b=m.findByName(c.d.ElementName)[0];m.settings.messages[b.name].remote=d.originalMessage;var e=!0===c.d.IsValid;if(e){var g=m.formSubmitted;m.prepareElement(b);m.formSubmitted=g;m.successList.push(b);m.showErrors()}else g={},c=d.message=c.d.ErrorMessage||m.defaultMessage(b,"mailinglistnameexists"),g[b.name]=f.isFunction(c)?p(a):c,m.showErrors(g);d.valid=e;m.stopRequest(b,e)}});return"pending"}return this.pending[b.name]?
"pending":d.valid},void 0),f.validator.addMethod("pattern",function(a,b,c){return this.optional(b)||null!=a.match(c||/.*/)},void 0))}};var h={addField:function(a,b,c,e){var g=this.data("evolutionValidation");if(g&&"undefined"!==typeof g){g.internal.fields[g.internal.fields.length]={selector:a,messageSelector:c,isValid:!0,context:e,initialized:!1};a=f(a);a.data("_evolutionValidation",g).data("_evolutionValidationFieldIndex",g.internal.fields.length-1).data("_evolutionValidationOldValue","$$$$$NULL$$$$$").rules("add",
b);try{a.keydown(function(){if(g.internal.hasAttemptedSubmit){window.clearTimeout(g.internal.keyPressValidationHandle);var a=this;g.internal.keyPressValidationHandle=window.setTimeout(function(){d(g,f(a))},499)}})}catch(m){}a.blur(function(){d(g,f(this))})}return this},addCustomValidation:function(a,c,d,e,g){var f=this.data("evolutionValidation");if(f&&"undefined"!==typeof f){var m=f.internal.customValidations.length;f.internal.customValidations[m]={id:a,validationFunction:c,message:d,messageSelector:e,
isValid:!0,context:g,initialized:!1};return function(){return b(f,m)}}},isValid:function(){var a=this.data("evolutionValidation");if(!a)return this;for(var e=0;e<a.internal.fields.length;e++)a.internal.fields[e].initialized||d(a,f(a.internal.fields[e].selector));for(e=0;e<a.internal.customValidations.length;e++)a.internal.customValidations[e].initialized||b(a,e);return c(a)},validate:function(){var a=this.data("evolutionValidation");if(!a)return this;for(var c=0;c<a.internal.fields.length;c++)d(a,
f(a.internal.fields[c].selector));for(c=0;c<a.internal.customValidations.length;c++)b(a,c);return h.isValid.apply(f(a.internal.state),[])},validateField:function(a){try{var b=this.data("evolutionValidation");f(a).data("_evolutionValidationOldValue","$$$$$NULL$$$$$");return d(b,f(a))}catch(c){}},validateCustom:function(a){var c=this.data("evolutionValidation");if(!c)return this;for(var d=0;d<c.internal.customValidations.length;d++)if(c.internal.customValidations[d].id==a)return b(c,d);return!0},reset:function(){var a=
this.data("evolutionValidation");if(!a)return this;for(var b=0;b<a.internal.customValidations.length;b++)f(a.internal.customValidations[b].messageSelector).hide(),a.internal.customValidations[b].isValid=!0,a.internal.customValidations[b].initialized=!1;for(b=0;b<a.internal.fields.length;b++)f(a.internal.fields[b].messageSelector).hide(),a.internal.fields[b].errorMessage=null,a.internal.fields[b].isValid=!0,a.internal.fields[b].initialized=!1,f(a.internal.fields[b].selector).data("_evolutionValidationOldValue",
"$$$$$NULL$$$$$");a.internal.submitButtonClicked=!1;a.internal.hasAttemptedSubmit=!1;window.clearTimeout(a.internal.initialValidationHandle);a.internal.initialValidationHandle=window.setTimeout(function(){g(a)},249)}},n=function(a){return this.each(function(){var b={settings:f.extend({},f.fn.evolutionValidation.defaults,a||{}),internal:{state:this,submitButtonClicked:!1,hasAttemptedSubmit:!1,fields:[],customValidations:[],initialValidationHandle:null}};f(this).data("evolutionValidation",b);f(this).click(function(a){return p(b,
a)});this._isValid=function(){return p(b,{})};window.clearTimeout(b.internal.initialValidationHandle);b.internal.initialValidationHandle=window.setTimeout(function(){g(b)},499)})},g=function(b){window.clearTimeout(b.internal.initialValidationHandle);try{var c=!1;if(!0===b.settings.validateOnLoad)c=!0;else if(!1!==b.settings.validateOnLoad)for(var d=0;d<b.internal.fields.length;d++){var e=f(b.internal.fields[d].selector),p=e.attr("type");if("checkbox"!=p&&"radio"!=p&&"select"!=p&&"submit"!=p&&"button"!=
p&&"reset"!=p&&""!=a(b,e)){c=!0;break}}if(c){b.internal.hasAttemptedSubmit=!0;var k=h.validate.apply(f(b.internal.state));m(b);if(b.settings.onValidated)b.settings.onValidated(k,!1,null)}else if(!b.internal.hasAttemptedSubmit&&b.settings.onValidated)b.settings.onValidated(!0,!1,null)}catch(n){b.internal.initialValidationHandle=window.setTimeout(function(){g(b)},499)}},c=function(a){for(var b=0;b<a.internal.fields.length;b++)if(!a.internal.fields[b].isValid)return!1;for(b=0;b<a.internal.customValidations.length;b++)if(!a.internal.customValidations[b].isValid)return!1;
return!0},d=function(b,c){var d=a(b,c);if(d!=c.data("_evolutionValidationOldValue"))return c.data("_evolutionValidationOldValue",d),c.valid();d=c.data("_evolutionValidationFieldIndex");return 0>d||d>=b.internal.fields.length?!1:b.internal.fields[d].isValid},a=function(a,b){return"checkbox"==b.attr("type")||"radio"==b.attr("type")?b.get(0).checked?b.val():"":b.val()},b=function(a,b){if(0>b||b>=a.internal.customValidations.length)return!0;var d=a.internal.customValidations[b].validationFunction();a.internal.customValidations[b].initialized=
!0;if(!0===d){a.internal.customValidations[b].isValid=!0;f(a.internal.customValidations[b].messageSelector).hide();if(c(a)&&a.internal.hasAttemptedSubmit&&a.settings.onValidated)a.settings.onValidated(!0,a.internal.submitButtonClicked,a.internal.customValidations[b].context);return!0}d=c(a);a.internal.customValidations[b].isValid=!1;a.internal.hasAttemptedSubmit&&f(a.internal.customValidations[b].messageSelector).html(a.internal.customValidations[b].message).show();if((a.internal.submitButtonClicked||
d)&&a.internal.hasAttemptedSubmit&&a.settings.onValidated)a.settings.onValidated(!1,a.internal.submitButtonClicked,a.internal.customValidations[b].context);return!1},p=function(a,b){var c=!a.internal.hasAttemptedSubmit;a.internal.hasAttemptedSubmit=!0;a.internal.submitButtonClicked=!0;h.validate.apply(f(a.internal.state),[]);var d=h.isValid.apply(f(a.internal.state),[]);c&&!d&&m(a);c=!0;d&&a.settings.onSuccessfulClick&&(c=a.settings.onSuccessfulClick(b));a.internal.submitButtonClicked=!1;!d&&b&&(b.cancelBubble=
!0,b.returnValue=!1);return d&&!1!==c},m=function(a){for(var b=0;b<a.internal.fields.length;b++)a.internal.fields[b].isValid||null==a.internal.fields[b].errorMessage||(f(a.internal.fields[b].messageSelector).html(a.internal.fields[b].errorMessage).show(),a.internal.fields[b].errorMessage=null);for(b=0;b<a.internal.customValidations.length;b++)a.internal.customValidations[b].isValid||f(a.internal.customValidations[b].messageSelector).html(a.internal.customValidations[b].message).show()};f.fn.evolutionValidation=
function(a){if(a in h)return h[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)f.error("Method "+a+" does not exist on jQuery.fn.evolutionValidation");else return n.apply(this,arguments)};f.extend(f.fn.evolutionValidation,{defaults:{validateOnLoad:null,onValidated:null,onSuccessfulClick:null},init:function(){f.fn.validate&&f("form").validate({errorPlacement:function(a,b){var c=f(b).data("_evolutionValidation");if(c){var d=parseInt(f(b).data("_evolutionValidationFieldIndex"),
10);0>d||d>=c.internal.fields.length||(c.internal.hasAttemptedSubmit?f(c.internal.fields[d].messageSelector).html(a).show():c.internal.fields[d].errorMessage=a)}},highlight:function(a,b,d){if(b=f(a).data("_evolutionValidation"))if(d=c(b),a=f(a).data("_evolutionValidationFieldIndex"),!(0>a||a>=b.internal.fields.length)&&(b.internal.fields[a].isValid=!1,b.internal.fields[a].initialized=!0,(b.internal.submitButtonClicked||d)&&b.internal.hasAttemptedSubmit&&b.settings.onValidated))b.settings.onValidated(!1,
b.internal.submitButtonClicked,b.internal.fields[a].context)},unhighlight:function(a,b,d){if(b=f(a).data("_evolutionValidation"))if(a=f(a).data("_evolutionValidationFieldIndex"),!(0>a||a>=b.internal.fields.length)&&(b.internal.fields[a].isValid=!0,b.internal.fields[a].initialized=!0,c(b)&&b.internal.hasAttemptedSubmit&&b.settings.onValidated))b.settings.onValidated(!0,b.internal.submitButtonClicked,b.internal.fields[a].context)},onsubmit:!1,onkeyup:!1,onfocusout:!1})}});e.Telligent_Validation=function(a,
b){this._jq=f(a);b.onValidatedFunction&&(b.onValidated=b.onValidatedFunction);b.onSuccessfulClickFunction&&(b.onSuccessfulClick=b.onSuccessfulClickFunction);this._jq.evolutionValidation(b)};Telligent_Validation.prototype.AddField=function(a,b,c,d){this._jq.evolutionValidation("addField",a,b,c,d)};Telligent_Validation.prototype.AddCustomValidation=function(a,b,c,d,e){return this._jq.evolutionValidation("addCustomValidation",a,b,c,d,e)};Telligent_Validation.prototype.IsValid=function(){return this._jq.evolutionValidation("isValid")};
Telligent_Validation.prototype.Validate=function(){return this._jq.evolutionValidation("validate")};Telligent_Validation.prototype.ValidateField=function(a){return this._jq.evolutionValidation("validateField",a)};Telligent_Validation.prototype.ValidateCustom=function(a){return this._jq.evolutionValidation("validateCustom",a)};return{}},jQuery,window);u("plugin.evolutionVote",function(f,e,k){var h=function(a,b){if(a.internal.isInitialized&&!a.settings.isReadOnly)if(a.internal.userVote=b,a.settings.allowMultipleSelections||
(a.settings.isReadOnly=!0),a.internal.savingValue=!0,null==b)a.settings.onDeleteVote();else a.settings.onVote(b)},n=function(a){return this.each(function(){var b={settings:f.extend({},f.fn.evolutionUpDownVoting.defaults,a||{}),internal:{state:f(this)}};f(this).data("evolutionUpDownVoting_context",b);b.internal.state.addClass(b.settings.voteClass).css("white-space","nowrap").find("a").unbind(".evolutionUpDownVoting").empty().end();b.internal.state.empty();"true"==b.settings.userVote?b.settings.userVote=
!0:"false"==b.settings.userVote&&(b.settings.userVote=!1);b.settings.isReadOnly&&b.internal.state.addClass(b.settings.readOnlyClass);g(b,!0);var c="",d="neutral";0<b.settings.score?(d="positive",c="+"):0>b.settings.score&&(d="negative");b.internal.state.append('<div class="score-summary"><div class="vote-score '+d+'">'+c+b.settings.score+"</div></div>");g(b,!1)})},g=function(a,b){(function(){if(!a.settings.isUserRegistered||!a.settings.isUserGroupMember||!1!=b||a.settings.canUserDownVote)if(!a.settings.isUserRegistered||
!a.settings.isUserGroupMember||!0!=b||a.settings.canUserUpVote){var d,e="",e=c(a,b);d=!a.settings.isUserRegistered||!0==b&&a.settings.canUserUpVote||!1==b&&a.settings.canUserDownVote?f('<a href="#" >'+e+"</a>").css({textDecoration:"none"}).attr("title",e).addClass("votingenabled ui-tip"):f('<a disabled="disabled">'+e+"</a>").addClass(a.settings.readOnlyClass).attr("title",e).addClass("votingdisabled ui-tip");d.addClass("vote");1==b?d.addClass("upvote"):d.addClass("downvote");if(!a.settings.isReadOnly)if(!a.settings.isUserRegistered)d.attr("href",
a.settings.loginUrl);else if(!0==b&&a.settings.canUserUpVote||!1==b&&a.settings.canUserDownVote)null==a.settings.userVote||a.settings.userVote!=b?d.data("rating-value",b).bind("click.evolutionUpDownVoting",function(b){h(a,d.data("rating-value"));return!1}):a.settings.userVote==b&&d.data("rating-value",b).addClass("selected").bind("click.evolutionUpDownVoting",function(b){h(a,null);return!1});a.internal.state.append(d)}})();a.internal.isInitialized=!0},c=function(a,b){if(a.settings.isReadOnly)return a.settings.readOnlyMessage;
if((!0!=b||a.settings.canUserUpVote)&&(!1!=b||a.settings.canUserDownVote)||a.settings.isUserRegistered){if(!0==b&&!a.settings.canUserUpVote||!1==b&&!a.settings.canUserDownVote)return a.settings.isUserGroupMember?a.settings.noPermissionMessage:a.settings.notGroupMemberMessage;if(!0==a.settings.userVote&&!0==b||!1==a.settings.userVote&&!1==b)return a.settings.deleteMessage;if(!0==b&&null==a.settings.userVote)return a.settings.voteUpMessage;if(!0==b&&!1==a.settings.userVote)return a.settings.switchToUpVoteMessage;
if(!1==b&&null==a.settings.userVote)return a.settings.voteDownMessage;if(!1==b&&!0==a.settings.userVote)return a.settings.switchToDownVoteMessage}else return a.settings.loginMessage;return""},d={val:function(a){var b=this.data("evolutionUpDownVoting_context");if(null!==b){if("undefined"!==typeof a)return b.internal.yesVotes=a;a="undefined"!==typeof b.internal.yesVotes?b.internal.yesVotes:b.settings.yesVotes;return a}return 0},readOnly:function(a){var b=this.data("evolutionUpDownVoting_context");if(null!==
b)if("undefined"!==typeof a)(b.settings.isReadOnly=a)?b.internal.state.find("a").css({cursor:"default"}):b.internal.state.find("a").css({cursor:"pointer"});else return b.settings.isReadOnly;return!0},option:function(a,b){if("object"===typeof a)return this.each(function(){var b=f(this).data("evolutionUpDownVoting_context");null!=b&&(b.settings=f.extend({},b.settings,a),n.apply(f(this),[b.settings]))});if("undefined"!==typeof a&&"undefined"!==typeof b)return this.each(function(){var c=f(this).data("evolutionUpDownVoting_context");
null!=c&&(c.settings[a]=b,n.apply(f(this),[c.settings]))});if("undefined"!==typeof a){var c=this.data("evolutionUpDownVoting_context");return null!==c?c.settings[a]:null}}};f.fn.evolutionUpDownVoting=function(a){if(a in d)return d[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)f.error("Method "+a+" does not exist on jQuery.fn.evolutionUpDownVoting");else return n.apply(this,arguments)};f.extend(f.fn.evolutionUpDownVoting,{defaults:{yesVotes:0,noVotes:0,voteCount:0,
score:0,userVote:null,voteClass:"updownvote",overClass:"active",readOnlyClass:"readonly",isReadOnly:!1,allowMultipleSelections:!0,canUserUpVote:!1,canUserDownVote:!1,isUserRegistered:!0,loginUrl:"",isUserGroupMember:!1,voteDownMessage:"Vote against this idea",voteUpMessage:"Vote for this idea",loginMessage:"Sign in to vote on ideas",noPermissionMessage:"You do not have permission to vote for this idea",notGroupMemberMessage:"Join this group to vote on this idea",deleteMessage:"Remove your vote for this idea",
readOnlyMessage:"Voting has been disabled",switchToDownVoteMessage:"Vote against this idea instead of for it",switchToUpVoteMessage:"Vote for this idea instead of against it",onVote:function(a){},onDeleteVote:function(a){}}});return{}},jQuery,window);"object"!==typeof JSON&&(JSON={});(function(){function f(a){return 10>a?"0"+a:a}function e(a){n.lastIndex=0;return n.test(a)?'"'+a.replace(n,function(a){var b=d[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':
'"'+a+'"'}function k(b,d){var f,q,h,l,n=g,r,v=d[b];v&&("object"===typeof v&&"function"===typeof v.toJSON)&&(v=v.toJSON(b));"function"===typeof a&&(v=a.call(d,b,v));switch(typeof v){case "string":return e(v);case "number":return isFinite(v)?String(v):"null";case "boolean":case "null":return String(v);case "object":if(!v)return"null";g+=c;r=[];if("[object Array]"===Object.prototype.toString.apply(v)){l=v.length;for(f=0;f<l;f+=1)r[f]=k(f,v)||"null";h=0===r.length?"[]":g?"[\n"+g+r.join(",\n"+g)+"\n"+
n+"]":"["+r.join(",")+"]";g=n;return h}if(a&&"object"===typeof a)for(l=a.length,f=0;f<l;f+=1)"string"===typeof a[f]&&(q=a[f],(h=k(q,v))&&r.push(e(q)+(g?": ":":")+h));else for(q in v)Object.prototype.hasOwnProperty.call(v,q)&&(h=k(q,v))&&r.push(e(q)+(g?": ":":")+h);h=0===r.length?"{}":g?"{\n"+g+r.join(",\n"+g)+"\n"+n+"}":"{"+r.join(",")+"}";g=n;return h}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+
1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var h=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,n=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g,c,d={"\b":"\\b","\t":"\\t","\n":"\\n",
"\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},a;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,d,e){var f;c=g="";if("number"===typeof e)for(f=0;f<e;f+=1)c+=" ";else"string"===typeof e&&(c=e);if((a=d)&&"function"!==typeof d&&("object"!==typeof d||"number"!==typeof d.length))throw Error("JSON.stringify");return k("",{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(a,c){function d(a,b){var e,g,f=a[b];if(f&&"object"===typeof f)for(e in f)Object.prototype.hasOwnProperty.call(f,
e)&&(g=d(f,e),void 0!==g?f[e]=g:delete f[e]);return c.call(a,b,f)}var e;a=String(a);h.lastIndex=0;h.test(a)&&(a=a.replace(h,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+a+")"),"function"===typeof c?d({"":e},""):e;throw new SyntaxError("JSON.parse");})})();!function(f,
e){function k(e,c){for(var d,a=[],b=0;b<e.length;++b){var p;if(!(p=n[e[b]]))a:{p=f;for(var m=e[b].split(/[.\/]/),h=0;h<m.length;++h){if(!p[m[h]]){p=void 0;break a}p=p[m[h]]}}if(d=p,!d)throw"module definition dependecy not found: "+e[b];a.push(d)}c.apply(null,a)}function h(g,c,d){if("string"!=typeof g)throw"invalid module definition, module id must be defined and be a string";if(c===e)throw"invalid module definition, dependencies must be specified";if(d===e)throw"invalid module definition, definition function must be specified";
k(c,function(){n[g]=d.apply(null,arguments)})}var n={};h("moxie/core/utils/Basic",[],function(){var e=function(a){return void 0===a?"undefined":null===a?"null":a.nodeType?"node":{}.toString.call(a).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},c=function(b){return d(arguments,function(f,m){0<m&&d(f,function(d,f){void 0!==d&&(e(b[f])===e(d)&&~a(e(d),["array","object"])?c(b[f],d):b[f]=d)})}),b},d=function(a,c){var d,f;if(a)if("number"===e(a.length))for(f=0,d=a.length;d>f&&!1!==c(a[f],f);f++);else if("object"===
e(a))for(d in a)if(a.hasOwnProperty(d)&&!1===c(a[d],d))break},a=function(a,c){if(c){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(c,a);for(var d=0,e=c.length;e>d;d++)if(c[d]===a)return d}return-1};return{guid:function(){var a=0;return function(c){var d=(new Date).getTime().toString(32),e;for(e=0;5>e;e++)d+=Math.floor(65535*Math.random()).toString(32);return(c||"o_")+d+(a++).toString(32)}}(),typeOf:e,extend:c,each:d,isEmptyObj:function(a){var c;if(!a||"object"!==e(a))return!0;for(c in a)return!1;
return!0},inSeries:function(a,c){function d(h){"function"===e(a[h])&&a[h](function(a){++h<f&&!a?d(h):c(a)})}var f=a.length;"function"!==e(c)&&(c=function(){});a&&a.length||c();d(0)},inParallel:function(a,c){var e=0,g=a.length,f=Array(g);d(a,function(a,b){a(function(a){if(a)return c(a);var d=[].slice.call(arguments);d.shift();f[b]=d;e++;e===g&&(f.unshift(null),c.apply(this,f))})})},inArray:a,arrayDiff:function(b,c){var d=[];"array"!==e(b)&&(b=[b]);"array"!==e(c)&&(c=[c]);for(var f in b)-1===a(b[f],
c)&&d.push(b[f]);return d.length?d:!1},arrayIntersect:function(b,c){var e=[];return d(b,function(b){-1!==a(b,c)&&e.push(b)}),e.length?e:null},toArray:function(a){var c,d=[];for(c=0;c<a.length;c++)d[c]=a[c];return d},trim:function(a){return a?String.prototype.trim?String.prototype.trim.call(a):a.toString().replace(/^\s*/,"").replace(/\s*$/,""):a},sprintf:function(a){var c=[].slice.call(arguments,1);return a.replace(/%[a-z]/g,function(){var a=c.shift();return"undefined"!==e(a)?a:""})},parseSizeStr:function(a){if("string"!=
typeof a)return a;var c={t:1099511627776,g:1073741824,m:1048576,k:1024},d;return a=/^([0-9\.]+)([tmgk]?)$/.exec(a.toLowerCase().replace(/[^0-9\.tmkg]/g,"")),d=a[2],a=+a[1],c.hasOwnProperty(d)&&(a*=c[d]),Math.floor(a)}}});h("moxie/core/utils/Env",["moxie/core/utils/Basic"],function(e){var c=function(a){var b={has:function(a,b){return-1!==b.toLowerCase().indexOf(a.toLowerCase())},lowerize:function(a){return a.toLowerCase()}},c=function(){for(var b,c=0,d,e,g,f,m,l=arguments;c<l.length;c+=2){m=l[c];var h=
l[c+1];if("undefined"===typeof b)for(g in b={},h)d=h[g],"object"===typeof d?b[d[0]]=a:b[d]=a;for(d=e=0;d<m.length;d++)if(f=m[d].exec(this.getUA())){for(g=0;g<h.length;g++)m=f[++e],d=h[g],"object"===typeof d&&0<d.length?2==d.length?"function"==typeof d[1]?b[d[0]]=d[1].call(this,m):b[d[0]]=d[1]:3==d.length?"function"!==typeof d[1]||d[1].exec&&d[1].test?b[d[0]]=m?m.replace(d[1],d[2]):a:b[d[0]]=m?d[1].call(this,m,d[2]):a:4==d.length&&(b[d[0]]=m?d[3].call(this,m.replace(d[1],d[2])):a):b[d]=m?m:a;break}if(f)break}return b},
d=function(c,d){for(var e in d)if("object"===typeof d[e]&&0<d[e].length)for(var g=0;g<d[e].length;g++){if(b.has(d[e][g],c))return"?"===e?a:e}else if(b.has(d[e],c))return"?"===e?a:e;return c},e={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2E3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",RT:"ARM"},g=[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],["name","version"],[/\s(opr)\/([\w\.]+)/i],
[["name","Opera"],"version"],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi)\/([\w\.-]+)/i],["name","version"],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[["name","IE"],"version"],[/(edge)\/((\d+)?[\w\.]+)/i],["name","version"],[/(yabrowser)\/([\w\.]+)/i],[["name",
"Yandex"],"version"],[/(comodo_dragon)\/([\w\.]+)/i],[["name",/_/g," "],"version"],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(uc\s?browser|qqbrowser)[\/\s]?([\w\.]+)/i],["name","version"],[/(dolfin)\/([\w\.]+)/i],[["name","Dolphin"],"version"],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[["name","Chrome"],"version"],[/XiaoMi\/MiuiBrowser\/([\w\.]+)/i],["version",["name","MIUI Browser"]],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)/i],["version",["name","Android Browser"]],
[/FBAV\/([\w\.]+);/i],["version",["name","Facebook"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],["version",["name","Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],["version","name"],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],["name",["version",d,{"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],["name","version"],[/(navigator|netscape)\/([\w\.-]+)/i],[["name",
"Netscape"],"version"],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],["name","version"]],f=[[/windows.+\sedge\/([\w\.]+)/i],["version",["name",
"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],["name","version"],[/rv\:([\w\.]+).*(gecko)/i],["version","name"]],h=[[/microsoft\s(windows)\s(vista|xp)/i],["name","version"],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],["name",["version",d,e]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[["name","Windows"],["version",
d,e]],[/\((bb)(10);/i],[["name","BlackBerry"],"version"],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],["name","version"],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[["name","Symbian"],"version"],[/\((series40);/i],["name"],[/mozilla.+\(mobile;.+gecko.+firefox/i],[["name","Firefox OS"],"version"],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,
/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],["name","version"],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[["name","Chromium OS"],"version"],[/(sunos)\s?([\w\.]+\d)*/i],[["name","Solaris"],"version"],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],["name","version"],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[["name",
"iOS"],["version",/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[["name","Mac OS"],["version",/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],["name","version"]];return function(a){var b=a||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:"");this.getBrowser=function(){return c.apply(this,
g)};this.getEngine=function(){return c.apply(this,f)};this.getOS=function(){return c.apply(this,h)};this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}};this.getUA=function(){return b};this.setUA=function(a){return b=a,this};this.setUA(b)}}(),d=function(){var a={define_property:!1,create_canvas:function(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}(),return_response_type:function(a){try{if(-1!==
e.inArray(a,["","text","document"]))return!0;if(window.XMLHttpRequest){var b=new XMLHttpRequest;if(b.open("get","/"),"responseType"in b)return b.responseType=a,b.responseType!==a?!1:!0}}catch(c){}return!1},use_data_uri:function(){var b=new Image;return b.onload=function(){a.use_data_uri=1===b.width&&1===b.height},setTimeout(function(){b.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1),!1}(),use_data_uri_over32kb:function(){return a.use_data_uri&&("IE"!==
b.browser||9<=b.version)},use_data_uri_of:function(b){return a.use_data_uri&&33E3>b||a.use_data_uri_over32kb()},use_fileinput:function(){if(navigator.userAgent.match(/(Android (1.0|1.1|1.5|1.6|2.0|2.1))|(Windows Phone (OS 7|8.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1.0|2.0|2.5|3.0))/))return!1;var a=document.createElement("input");return a.setAttribute("type","file"),!a.disabled}};return function(b){var c=[].slice.call(arguments);return c.shift(),"function"===e.typeOf(a[b])?a[b].apply(this,
c):!!a[b]}}(),a=(new c).getResult(),b={can:d,uaParser:c,browser:a.browser.name,version:a.browser.version,os:a.os.name,osVersion:a.os.version,verComp:function(a,b,c){var d=0,e=0,g=0,f={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},d=function(a){return a=(""+a).replace(/[_\-+]/g,"."),a=a.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,"."),a.length?a.split("."):[-8]};a=d(a);b=d(b);e=Math.max(a.length,b.length);for(d=0;e>d;d++)if(a[d]!=b[d]){if(a[d]=a[d]?isNaN(a[d])?f[a[d]]||-7:parseInt(a[d],
10):0,b[d]=b[d]?isNaN(b[d])?f[b[d]]||-7:parseInt(b[d],10):0,a[d]<b[d]){g=-1;break}if(a[d]>b[d]){g=1;break}}if(!c)return g;switch(c){case ">":case "gt":return 0<g;case ">=":case "ge":return 0<=g;case "<=":case "le":return 0>=g;case "==":case "=":case "eq":return 0===g;case "<>":case "!=":case "ne":return 0!==g;case "":case "<":case "lt":return 0>g;default:return null}},swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};
return b.OS=b.os,b});h("moxie/core/I18n",["moxie/core/utils/Basic"],function(e){var c={};return{addI18n:function(d){return e.extend(c,d)},translate:function(d){return c[d]||d},_:function(c){return this.translate(c)},sprintf:function(c){var a=[].slice.call(arguments,1);return c.replace(/%[a-z]/g,function(){var b=a.shift();return"undefined"!==e.typeOf(b)?b:""})}}});h("moxie/core/utils/Mime",["moxie/core/utils/Basic","moxie/core/I18n"],function(e,c){var d={mimes:{},extensions:{},addMimeType:function(a){a=
a.split(/,/);var b,c,d;for(b=0;b<a.length;b+=2){d=a[b+1].split(/ /);for(c=0;c<d.length;c++)this.mimes[d[c]]=a[b];this.extensions[a[b]]=d}},extList2mimes:function(a,b){var c,d,f,h,l=[];for(d=0;d<a.length;d++)for(c=a[d].extensions.split(/\s*,\s*/),f=0;f<c.length;f++){if("*"===c[f])return[];if(h=this.mimes[c[f]],h&&-1===e.inArray(h,l)&&l.push(h),b&&/^\w+$/.test(c[f]))l.push("."+c[f]);else if(!h)return[]}return l},mimes2exts:function(a){var b=this,c=[];return e.each(a,function(a){if("*"===a)return c=
[],!1;var d=a.match(/^(\w+)\/(\*|\w+)$/);d&&("*"===d[2]?e.each(b.extensions,function(a,e){RegExp("^"+d[1]+"/").test(e)&&[].push.apply(c,b.extensions[e])}):b.extensions[a]&&[].push.apply(c,b.extensions[a]))}),c},mimes2extList:function(a){var b=[],d=[];return"string"===e.typeOf(a)&&(a=e.trim(a).split(/\s*,\s*/)),d=this.mimes2exts(a),b.push({title:c.translate("Files"),extensions:d.length?d.join(","):"*"}),b.mimes=a,b},getFileExtension:function(a){return(a=a&&a.match(/\.([^.]+)$/))?a[1].toLowerCase():
""},getFileMime:function(a){return this.mimes[this.getFileExtension(a)]||""}};return d.addMimeType("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe"),
d});h("moxie/core/utils/Dom",["moxie/core/utils/Env"],function(e){var c=function(c,a){return c.className?RegExp("(^|\\s+)"+a+"(\\s+|$)").test(c.className):!1};return{get:function(c){return"string"!=typeof c?c:document.getElementById(c)},hasClass:c,addClass:function(d,a){c(d,a)||(d.className=d.className?d.className.replace(/\s+$/,"")+" "+a:a)},removeClass:function(c,a){c.className&&(c.className=c.className.replace(RegExp("(^|\\s+)"+a+"(\\s+|$)"),function(a,c,d){return" "===c&&" "===d?" ":""}))},getStyle:function(c,
a){return c.currentStyle?c.currentStyle[a]:window.getComputedStyle?window.getComputedStyle(c,null)[a]:void 0},getPos:function(c,a){function b(a){var b,c,d=0,e=0;return a&&(c=a.getBoundingClientRect(),b="CSS1Compat"===t.compatMode?t.documentElement:t.body,d=c.left+b.scrollLeft,e=c.top+b.scrollTop),{x:d,y:e}}var f=0,m=0,h,t=document,l;if(a=a||t.body,c&&c.getBoundingClientRect&&"IE"===e.browser&&(!t.documentMode||8>t.documentMode))return h=b(c),l=b(a),{x:h.x-l.x,y:h.y-l.y};for(h=c;h&&h!=a&&h.nodeType;)f+=
h.offsetLeft||0,m+=h.offsetTop||0,h=h.offsetParent;for(h=c.parentNode;h&&h!=a&&h.nodeType;)f-=h.scrollLeft||0,m-=h.scrollTop||0,h=h.parentNode;return{x:f,y:m}},getSize:function(c){return{w:c.offsetWidth||c.clientWidth,h:c.offsetHeight||c.clientHeight}}}});h("moxie/core/Exceptions",["moxie/core/utils/Basic"],function(e){function c(c,a){for(var b in c)if(c[b]===a)return b;return null}return{RuntimeError:function(){function d(b){this.code=b;this.name=c(a,b);this.message=this.name+": RuntimeError "+this.code}
var a={NOT_INIT_ERR:1,NOT_SUPPORTED_ERR:9,JS_ERR:4};return e.extend(d,a),d.prototype=Error.prototype,d}(),OperationNotAllowedException:function(){function c(a){this.code=a;this.name="OperationNotAllowedException"}return e.extend(c,{NOT_ALLOWED_ERR:1}),c.prototype=Error.prototype,c}(),ImageError:function(){function d(b){this.code=b;this.name=c(a,b);this.message=this.name+": ImageError "+this.code}var a={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2,INVALID_META_ERR:3};return e.extend(d,a),d.prototype=Error.prototype,
d}(),FileException:function(){function d(b){this.code=b;this.name=c(a,b);this.message=this.name+": FileException "+this.code}var a={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,SYNTAX_ERR:8};return e.extend(d,a),d.prototype=Error.prototype,d}(),DOMException:function(){function d(b){this.code=b;this.name=c(a,b);this.message=this.name+": DOMException "+this.code}var a={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,
WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};return e.extend(d,a),d.prototype=Error.prototype,d}(),EventException:function(){function c(a){this.code=
a;this.name="EventException"}return e.extend(c,{UNSPECIFIED_EVENT_TYPE_ERR:0}),c.prototype=Error.prototype,c}()}});h("moxie/core/EventTarget",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic"],function(e,c,d){function a(){var a={};d.extend(this,{uid:null,init:function(){this.uid||(this.uid=d.guid("uid_"))},addEventListener:function(c,e,g,f){var l=this,h;return this.hasOwnProperty("uid")||(this.uid=d.guid("uid_")),c=d.trim(c),/\s/.test(c)?void d.each(c.split(/\s+/),function(a){l.addEventListener(a,
e,g,f)}):(c=c.toLowerCase(),g=parseInt(g,10)||0,h=a[this.uid]&&a[this.uid][c]||[],h.push({fn:e,priority:g,scope:f||this}),a[this.uid]||(a[this.uid]={}),void(a[this.uid][c]=h))},hasEventListener:function(c){return(c=c?a[this.uid]&&a[this.uid][c]:a[this.uid])?c:!1},removeEventListener:function(c,e){c=c.toLowerCase();var g=a[this.uid]&&a[this.uid][c],f;if(g){if(e)for(f=g.length-1;0<=f;f--){if(g[f].fn===e){g.splice(f,1);break}}else g=[];g.length||(delete a[this.uid][c],d.isEmptyObj(a[this.uid])&&delete a[this.uid])}},
removeAllEventListeners:function(){a[this.uid]&&delete a[this.uid]},dispatchEvent:function(e){var g,f,h,l={},k=!0;if("string"!==d.typeOf(e)){if(f=e,"string"!==d.typeOf(f.type))throw new c.EventException(c.EventException.UNSPECIFIED_EVENT_TYPE_ERR);e=f.type;void 0!==f.total&&void 0!==f.loaded&&(l.total=f.total,l.loaded=f.loaded);l.async=f.async||!1}if(-1!==e.indexOf("::")?!function(a){g=a[0];e=a[1]}(e.split("::")):g=this.uid,e=e.toLowerCase(),f=a[g]&&a[g][e]){f.sort(function(a,b){return b.priority-
a.priority});h=[].slice.call(arguments);h.shift();l.type=e;h.unshift(l);var r=[];d.each(f,function(a){h[0].target=a.scope;r.push(l.async?function(b){setTimeout(function(){b(!1===a.fn.apply(a.scope,h))},1)}:function(b){b(!1===a.fn.apply(a.scope,h))})});r.length&&d.inSeries(r,function(a){k=!a})}return k},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},
trigger:function(){return this.dispatchEvent.apply(this,arguments)},handleEventProps:function(a){var b=this;this.bind(a.join(" "),function(a){var b="on"+a.type.toLowerCase();"function"===d.typeOf(this[b])&&this[b].apply(this,arguments)});d.each(a,function(a){a="on"+a.toLowerCase(a);"undefined"===d.typeOf(b[a])&&(b[a]=null)})}})}return a.instance=new a,a});h("moxie/runtime/Runtime",["moxie/core/utils/Env","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/EventTarget"],function(e,c,d,a){function b(a,
e,g,f,p){var h=this,k,n=c.guid(e+"_");p=p||"browser";a=a||{};m[n]=this;g=c.extend({access_binary:!1,access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,return_status_code:!0,send_custom_headers:!1,select_file:!1,select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,
use_http_method:!0},g);a.preferred_caps&&(p=b.getMode(f,a.preferred_caps,p));k=function(){var a={};return{exec:function(b,c,d,e){return k[c]&&(a[b]||(a[b]={context:this,instance:new k[c]}),a[b].instance[d])?a[b].instance[d].apply(this,e):void 0},removeInstance:function(b){delete a[b]},removeAllInstances:function(){var b=this;c.each(a,function(a,d){"function"===c.typeOf(a.instance.destroy)&&a.instance.destroy.call(a.context);b.removeInstance(d)})}}}();c.extend(this,{initialized:!1,uid:n,type:e,mode:b.getMode(f,
a.required_caps,p),shimid:n+"_container",clients:0,options:a,can:function(a,d,e){e=e||g;if("string"===c.typeOf(a)&&"undefined"===c.typeOf(d)&&(a=b.parseCaps(a)),"object"===c.typeOf(a)){for(var f in a)if(!this.can(f,a[f],e))return!1;return!0}return"function"===c.typeOf(e[a])?e[a].call(this,d):d===e[a]},getShimContainer:function(){var a,b=d.get(this.shimid);return b||(a=this.options.container?d.get(this.options.container):document.body,b=document.createElement("div"),b.id=this.shimid,b.className="moxie-shim moxie-shim-"+
this.type,c.extend(b.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),a.appendChild(b)),b},getShim:function(){return k},shimExec:function(a,b){var c=[].slice.call(arguments,2);return h.getShim().exec.call(this,this.uid,a,b,c)},exec:function(a,b){var c=[].slice.call(arguments,2);return h[a]&&h[a][b]?h[a][b].apply(this,c):h.shimExec.apply(this,arguments)},destroy:function(){if(h){var a=d.get(this.shimid);a&&a.parentNode.removeChild(a);k&&k.removeAllInstances();
this.unbindAll();delete m[this.uid];n=h=k=this.uid=null}}});this.mode&&a.required_caps&&!this.can(a.required_caps)&&(this.mode=!1)}var f={},m={};return b.order="html5,flash,silverlight,html4",b.getRuntime=function(a){return m[a]?m[a]:!1},b.addConstructor=function(b,c){c.prototype=a.instance;f[b]=c},b.getConstructor=function(a){return f[a]||null},b.getInfo=function(a){var c=b.getRuntime(a);return c?{uid:c.uid,type:c.type,mode:c.mode,can:function(){return c.can.apply(c,arguments)}}:null},b.parseCaps=
function(a){var b={};return"string"!==c.typeOf(a)?a||{}:(c.each(a.split(","),function(a){b[a]=!0}),b)},b.can=function(a,c){var d,e=b.getConstructor(a),g;return e?(d=new e({required_caps:c}),g=d.mode,d.destroy(),!!g):!1},b.thatCan=function(a,c){var d=(c||b.order).split(/\s*,\s*/),e;for(e in d)if(b.can(d[e],a))return d[e];return null},b.getMode=function(a,b,d){var e=null;if("undefined"===c.typeOf(d)&&(d="browser"),b&&!c.isEmptyObj(a)){if(c.each(b,function(b,d){if(a.hasOwnProperty(d)){var g=a[d](b);
if("string"==typeof g&&(g=[g]),e){if(!(e=c.arrayIntersect(e,g)))return e=!1}else e=g}}),e)return-1!==c.inArray(d,e)?d:e[0];if(!1===e)return!1}return d},b.capTrue=function(){return!0},b.capFalse=function(){return!1},b.capTest=function(a){return function(){return!!a}},b});h("moxie/runtime/RuntimeClient",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/Runtime"],function(e,c,d,a){return function(){var b;d.extend(this,{connectRuntime:function(e){function g(d){var h,
k;return d.length?(h=d.shift().toLowerCase(),(k=a.getConstructor(h))?(b=new k(e),b.bind("Init",function(){b.initialized=!0;setTimeout(function(){b.clients++;f.trigger("RuntimeInit",b)},1)}),b.bind("Error",function(){b.destroy();g(d)}),b.mode?void b.init():void b.trigger("Error")):void g(d)):(f.trigger("RuntimeError",new c.RuntimeError(c.RuntimeError.NOT_INIT_ERR)),void(b=null))}var f=this,h;if("string"===d.typeOf(e)?h=e:"string"===d.typeOf(e.ruid)&&(h=e.ruid),h){if(b=a.getRuntime(h))return b.clients++,
b;throw new c.RuntimeError(c.RuntimeError.NOT_INIT_ERR);}g((e.runtime_order||a.order).split(/\s*,\s*/))},disconnectRuntime:function(){b&&0>=--b.clients&&b.destroy();b=null},getRuntime:function(){return b&&b.uid?b:b=null},exec:function(){return b?b.exec.apply(this,arguments):null}})}});h("moxie/file/FileInput","moxie/core/utils/Basic moxie/core/utils/Env moxie/core/utils/Mime moxie/core/utils/Dom moxie/core/Exceptions moxie/core/EventTarget moxie/core/I18n moxie/runtime/Runtime moxie/runtime/RuntimeClient".split(" "),
function(e,c,d,a,b,f,m,h,k){function l(c){var f=this,l;if(-1!==e.inArray(e.typeOf(c),["string","node"])&&(c={browse_button:c}),l=a.get(c.browse_button),!l)throw new b.DOMException(b.DOMException.NOT_FOUND_ERR);l={accept:[{title:m.translate("All Files"),extensions:"*"}],name:"file",multiple:!1,required_caps:!1,container:l.parentNode||document.body};c=e.extend({},l,c);"string"==typeof c.required_caps&&(c.required_caps=h.parseCaps(c.required_caps));"string"==typeof c.accept&&(c.accept=d.mimes2extList(c.accept));
(l=a.get(c.container))||(l=document.body);"static"===a.getStyle(l,"position")&&(l.style.position="relative");l=l=null;k.call(f);e.extend(f,{uid:e.guid("uid_"),ruid:null,shimid:null,files:null,init:function(){f.bind("RuntimeInit",function(b,d){f.ruid=d.uid;f.shimid=d.shimid;f.bind("Ready",function(){f.trigger("Refresh")},999);f.bind("Refresh",function(){var b,f,m,l;m=a.get(c.browse_button);l=a.get(d.shimid);m&&(b=a.getPos(m,a.get(c.container)),f=a.getSize(m),l&&e.extend(l.style,{top:b.y+"px",left:b.x+
"px",width:f.w+"px",height:f.h+"px"}))});d.exec.call(f,"FileInput","init",c)});f.connectRuntime(e.extend({},c,{required_caps:{select_file:!0}}))},disable:function(a){var b=this.getRuntime();b&&b.exec.call(this,"FileInput","disable","undefined"===e.typeOf(a)?!0:a)},refresh:function(){f.trigger("Refresh")},destroy:function(){var a=this.getRuntime();a&&(a.exec.call(this,"FileInput","destroy"),this.disconnectRuntime());"array"===e.typeOf(this.files)&&e.each(this.files,function(a){a.destroy()});this.files=
null;this.unbindAll()}});this.handleEventProps(n)}var n="ready change cancel mouseenter mouseleave mousedown mouseup".split(" ");return l.prototype=f.instance,l});h("moxie/core/utils/Encode",[],function(){var e=function(c){return unescape(encodeURIComponent(c))},c=function(c){return decodeURIComponent(escape(c))};return{utf8_encode:e,utf8_decode:c,atob:function(d,a){if("function"==typeof window.atob)return a?c(window.atob(d)):window.atob(d);var b,e,g,f,h,l=0,k=0,n="",v=[];if(!d)return d;d+="";do b=
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(d.charAt(l++)),e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(d.charAt(l++)),f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(d.charAt(l++)),h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(d.charAt(l++)),g=b<<18|e<<12|f<<6|h,b=g>>16&255,e=g>>8&255,g&=255,64==f?v[k++]=String.fromCharCode(b):64==h?v[k++]=String.fromCharCode(b,e):v[k++]=
String.fromCharCode(b,e,g);while(l<d.length);return n=v.join(""),a?c(n):n},btoa:function(c,a){if(a&&(c=e(c)),"function"==typeof window.btoa)return window.btoa(c);var b,f,m,h,k=0,l=0,n="",n=[];if(!c)return c;do b=c.charCodeAt(k++),f=c.charCodeAt(k++),m=c.charCodeAt(k++),h=b<<16|f<<8|m,b=h>>18&63,f=h>>12&63,m=h>>6&63,h&=63,n[l++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(f)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(m)+
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h);while(k<c.length);n=n.join("");k=c.length%3;return(k?n.slice(0,k-3):n)+"===".slice(k||3)}}});h("moxie/file/Blob",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient"],function(e,c,d){function a(f,m){function h(c,d,f){var m,p=b[this.uid];return"string"===e.typeOf(p)&&p.length?(m=new a(null,{type:f,size:d-c}),m.detach(p.substr(c,m.size)),m):null}d.call(this);f&&this.connectRuntime(f);m?"string"===
e.typeOf(m)&&(m={data:m}):m={};e.extend(this,{uid:m.uid||e.guid("uid_"),ruid:f,size:m.size||0,type:m.type||"",slice:function(a,b,c){return this.isDetached()?h.apply(this,arguments):this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),a,b,c)},getSource:function(){return b[this.uid]?b[this.uid]:null},detach:function(a){if(this.ruid&&(this.getRuntime().exec.call(this,"Blob","destroy"),this.disconnectRuntime(),this.ruid=null),a=a||"","data:"==a.substr(0,5)){var d=a.indexOf(";base64,");this.type=
a.substring(5,d);a=c.atob(a.substring(d+8))}this.size=a.length;b[this.uid]=a},isDetached:function(){return!this.ruid&&"string"===e.typeOf(b[this.uid])},destroy:function(){this.detach();delete b[this.uid]}});m.data?this.detach(m.data):b[this.uid]=m}var b={};return a});h("moxie/file/File",["moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/file/Blob"],function(e,c,d){function a(a,f){f||(f={});d.apply(this,arguments);this.type||(this.type=c.getFileMime(f.name));var m;f.name?(m=f.name.replace(/\\/g,
"/"),m=m.substr(m.lastIndexOf("/")+1)):this.type&&(m=this.type.split("/")[0],m=e.guid((""!==m?m:"file")+"_"),c.extensions[this.type]&&(m+="."+c.extensions[this.type][0]));e.extend(this,{name:m||e.guid("file_"),relativePath:"",lastModifiedDate:f.lastModifiedDate||(new Date).toLocaleString()})}return a.prototype=d.prototype,a});h("moxie/file/FileDrop","moxie/core/I18n moxie/core/utils/Dom moxie/core/Exceptions moxie/core/utils/Basic moxie/core/utils/Env moxie/file/File moxie/runtime/RuntimeClient moxie/core/EventTarget moxie/core/utils/Mime".split(" "),
function(e,c,d,a,b,f,m,h,k){function l(b){var d=this,f;"string"==typeof b&&(b={drop_zone:b});f={accept:[{title:e.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}};b="object"==typeof b?a.extend({},f,b):f;b.container=c.get(b.drop_zone)||document.body;"static"===c.getStyle(b.container,"position")&&(b.container.style.position="relative");"string"==typeof b.accept&&(b.accept=k.mimes2extList(b.accept));m.call(d);a.extend(d,{uid:a.guid("uid_"),ruid:null,files:null,init:function(){d.bind("RuntimeInit",
function(a,c){d.ruid=c.uid;c.exec.call(d,"FileDrop","init",b);d.dispatchEvent("ready")});d.connectRuntime(b)},destroy:function(){var a=this.getRuntime();a&&(a.exec.call(this,"FileDrop","destroy"),this.disconnectRuntime());this.files=null;this.unbindAll()}});this.handleEventProps(n)}var n=["ready","dragenter","dragleave","drop","error"];return l.prototype=h.instance,l});h("moxie/file/FileReader","moxie/core/utils/Basic moxie/core/utils/Encode moxie/core/Exceptions moxie/core/EventTarget moxie/file/Blob moxie/runtime/RuntimeClient".split(" "),
function(e,c,d,a,b,f){function m(){function a(e,g){if(this.trigger("loadstart"),this.readyState===m.LOADING)return this.trigger("error",new d.DOMException(d.DOMException.INVALID_STATE_ERR)),void this.trigger("loadend");if(!(g instanceof b))return this.trigger("error",new d.DOMException(d.DOMException.NOT_FOUND_ERR)),void this.trigger("loadend");if(this.result=null,this.readyState=m.LOADING,g.isDetached()){var f=g.getSource();switch(e){case "readAsText":case "readAsBinaryString":this.result=f;break;
case "readAsDataURL":this.result="data:"+g.type+";base64,"+c.btoa(f)}this.readyState=m.DONE;this.trigger("load");this.trigger("loadend")}else this.connectRuntime(g.ruid),this.exec("FileReader","read",e,g)}f.call(this);e.extend(this,{uid:e.guid("uid_"),readyState:m.EMPTY,result:null,error:null,readAsBinaryString:function(b){a.call(this,"readAsBinaryString",b)},readAsDataURL:function(b){a.call(this,"readAsDataURL",b)},readAsText:function(b){a.call(this,"readAsText",b)},abort:function(){this.result=
null;-1===e.inArray(this.readyState,[m.EMPTY,m.DONE])&&(this.readyState===m.LOADING&&(this.readyState=m.DONE),this.exec("FileReader","abort"),this.trigger("abort"),this.trigger("loadend"))},destroy:function(){this.abort();this.exec("FileReader","destroy");this.disconnectRuntime();this.unbindAll()}});this.handleEventProps(h);this.bind("Error",function(a,b){this.readyState=m.DONE;this.error=b},999);this.bind("Load",function(a){this.readyState=m.DONE},999)}var h="loadstart progress load abort error loadend".split(" ");
return m.EMPTY=0,m.LOADING=1,m.DONE=2,m.prototype=a.instance,m});h("moxie/core/utils/Url",[],function(){var e=function(c,d){for(var a="source scheme authority userInfo user pass host port relative path directory file query fragment".split(" "),b=a.length,f={http:80,https:443},m={},h=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/.exec(c||"");b--;)h[b]&&(m[a[b]]=h[b]);m.scheme||(d&&"string"!=
typeof d||(d=e(d||document.location.href)),m.scheme=d.scheme,m.host=d.host,m.port=d.port,a="",/^[^\/]/.test(m.path)&&(a=d.path,a=/\/[^\/]*\.[^\/]*$/.test(a)?a.replace(/\/[^\/]+$/,"/"):a.replace(/\/?$/,"/")),m.path=a+(m.path||""));return m.port||(m.port=f[m.scheme]||80),m.port=parseInt(m.port,10),m.path||(m.path="/"),delete m.source,m};return{parseUrl:e,resolveUrl:function(c){c="object"==typeof c?c:e(c);return c.scheme+"://"+c.host+(c.port!=={http:80,https:443}[c.scheme]?":"+c.port:"")+c.path+(c.query?
c.query:"")},hasSameOrigin:function(c){function d(a){return[a.scheme,a.host,a.port].join("/")}return"string"==typeof c&&(c=e(c)),d(e())===d(c)}}});h("moxie/runtime/RuntimeTarget",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(e,c,d){function a(){this.uid=e.guid("uid_");c.call(this);this.destroy=function(){this.disconnectRuntime();this.unbindAll()}}return a.prototype=d.instance,a});h("moxie/file/FileReaderSync",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient",
"moxie/core/utils/Encode"],function(e,c,d){return function(){function a(a,c){if(!c.isDetached()){var e=this.connectRuntime(c.ruid).exec.call(this,"FileReaderSync","read",a,c);return this.disconnectRuntime(),e}e=c.getSource();switch(a){case "readAsBinaryString":return e;case "readAsDataURL":return"data:"+c.type+";base64,"+d.btoa(e);case "readAsText":for(var g="",f=0,h=e.length;h>f;f++)g+=String.fromCharCode(e[f]);return g}}c.call(this);e.extend(this,{uid:e.guid("uid_"),readAsBinaryString:function(b){return a.call(this,
"readAsBinaryString",b)},readAsDataURL:function(b){return a.call(this,"readAsDataURL",b)},readAsText:function(b){return a.call(this,"readAsText",b)}})}});h("moxie/xhr/FormData",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/file/Blob"],function(e,c,d){return function(){var a,b=[];c.extend(this,{append:function(e,g){var f=this,h=c.typeOf(g);g instanceof d?a={name:e,value:g}:"array"===h?(e+="[]",c.each(g,function(a){f.append(e,a)})):"object"===h?c.each(g,function(a,b){f.append(e+"["+b+"]",
a)}):"null"===h||"undefined"===h||"number"===h&&isNaN(g)?f.append(e,"false"):b.push({name:e,value:g.toString()})},hasBlob:function(){return!!this.getBlob()},getBlob:function(){return a&&a.value||null},getBlobName:function(){return a&&a.name||null},each:function(d){c.each(b,function(a){d(a.value,a.name)});a&&d(a.value,a.name)},destroy:function(){a=null;b=[]}})}});h("moxie/xhr/XMLHttpRequest","moxie/core/utils/Basic moxie/core/Exceptions moxie/core/EventTarget moxie/core/utils/Encode moxie/core/utils/Url moxie/runtime/Runtime moxie/runtime/RuntimeTarget moxie/file/Blob moxie/file/FileReaderSync moxie/xhr/FormData moxie/core/utils/Env moxie/core/utils/Mime".split(" "),
function(e,c,d,a,b,f,h,k,t,l,n,r){function v(){this.uid=e.guid("uid_")}function s(){function d(a,b){return D.hasOwnProperty(a)?1===arguments.length?n.can("define_property")?D[a]:u[a]:void(n.can("define_property")?D[a]=b:u[a]=b):void 0}function t(a){function b(){H&&(H.destroy(),H=null);k.dispatchEvent("loadend");k=null}function c(f){H.bind("LoadStart",function(a){d("readyState",s.LOADING);k.dispatchEvent("readystatechange");k.dispatchEvent(a);O&&k.upload.dispatchEvent(a)});H.bind("Progress",function(a){d("readyState")!==
s.LOADING&&(d("readyState",s.LOADING),k.dispatchEvent("readystatechange"));k.dispatchEvent(a)});H.bind("UploadProgress",function(a){O&&k.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:a.total,loaded:a.loaded})});H.bind("Load",function(a){d("readyState",s.DONE);d("status",Number(f.exec.call(H,"XMLHttpRequest","getStatus")||0));d("statusText",y[d("status")]||"");d("response",f.exec.call(H,"XMLHttpRequest","getResponse",d("responseType")));~e.inArray(d("responseType"),["text",""])?d("responseText",
d("response")):"document"===d("responseType")&&d("responseXML",d("response"));V=f.exec.call(H,"XMLHttpRequest","getAllResponseHeaders");k.dispatchEvent("readystatechange");0<d("status")?(O&&k.upload.dispatchEvent(a),k.dispatchEvent(a)):(U=!0,k.dispatchEvent("error"));b()});H.bind("Abort",function(a){k.dispatchEvent(a);b()});H.bind("Error",function(a){U=!0;d("readyState",s.DONE);k.dispatchEvent("readystatechange");T=!0;k.dispatchEvent(a);b()});f.exec.call(H,"XMLHttpRequest","send",{url:B,method:G,
async:L,user:M,password:P,headers:J,mimeType:F,encoding:C,responseType:k.responseType,withCredentials:k.withCredentials,options:N},a)}var k=this;(new Date).getTime();H=new h;"string"==typeof N.required_caps&&(N.required_caps=f.parseCaps(N.required_caps));N.required_caps=e.extend({},N.required_caps,{return_response_type:k.responseType});a instanceof l&&(N.required_caps.send_multipart=!0);e.isEmptyObj(J)||(N.required_caps.send_custom_headers=!0);R||(N.required_caps.do_cors=!0);N.ruid?c(H.connectRuntime(N)):
(H.bind("RuntimeInit",function(a,b){c(b)}),H.bind("RuntimeError",function(a,b){k.dispatchEvent("RuntimeError",b)}),H.connectRuntime(N))}var u=this,D={timeout:0,readyState:s.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},L=!0,B,G,J={},M,P,C=null,F=null,I=!1,K=!1,O=!1,T=!1,U=!1,R=!1,N={},H,V="",S;e.extend(this,D,{uid:e.guid("uid_"),upload:new v,open:function(f,h,m,l,p){var k;if(!f||!h)throw new c.DOMException(c.DOMException.SYNTAX_ERR);
if(/[\u0100-\uffff]/.test(f)||a.utf8_encode(f)!==f)throw new c.DOMException(c.DOMException.SYNTAX_ERR);if(~e.inArray(f.toUpperCase(),"CONNECT DELETE GET HEAD OPTIONS POST PUT TRACE TRACK".split(" "))&&(G=f.toUpperCase()),~e.inArray(G,["CONNECT","TRACE","TRACK"]))throw new c.DOMException(c.DOMException.SECURITY_ERR);if(h=a.utf8_encode(h),k=b.parseUrl(h),R=b.hasSameOrigin(k),B=b.resolveUrl(h),(l||p)&&!R)throw new c.DOMException(c.DOMException.INVALID_ACCESS_ERR);if(M=l||k.user,P=p||k.pass,L=m||!0,!1===
L&&(d("timeout")||d("withCredentials")||""!==d("responseType")))throw new c.DOMException(c.DOMException.INVALID_ACCESS_ERR);I=!L;K=!1;J={};d("responseText","");d("responseXML",null);d("response",null);d("status",0);d("statusText","");d("readyState",s.OPENED);this.dispatchEvent("readystatechange")},setRequestHeader:function(b,f){if(d("readyState")!==s.OPENED||K)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(b)||a.utf8_encode(b)!==b)throw new c.DOMException(c.DOMException.SYNTAX_ERR);
return b=e.trim(b).toLowerCase(),~e.inArray(b,"accept-charset accept-encoding access-control-request-headers access-control-request-method connection content-length cookie cookie2 content-transfer-encoding date expect host keep-alive origin referer te trailer transfer-encoding upgrade user-agent via".split(" "))||/^(proxy\-|sec\-)/.test(b)?!1:(J[b]?J[b]+=", "+f:J[b]=f,!0)},getAllResponseHeaders:function(){return V||""},getResponseHeader:function(a){return a=a.toLowerCase(),U||~e.inArray(a,["set-cookie",
"set-cookie2"])?null:V&&""!==V&&(S||(S={},e.each(V.split(/\r\n/),function(a){a=a.split(/:\s+/);2===a.length&&(a[0]=e.trim(a[0]),S[a[0].toLowerCase()]={header:a[0],value:e.trim(a[1])})})),S.hasOwnProperty(a))?S[a].header+": "+S[a].value:null},overrideMimeType:function(a){var b;if(~e.inArray(d("readyState"),[s.LOADING,s.DONE]))throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(a=e.trim(a.toLowerCase()),/;/.test(a)&&(b=a.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))&&(a=b[1]),!r.mimes[a])throw new c.DOMException(c.DOMException.SYNTAX_ERR);
},send:function(b,d){if(N="string"===e.typeOf(d)?{ruid:d}:d?d:{},this.readyState!==s.OPENED||K)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(b instanceof k)N.ruid=b.ruid,F=b.type||"application/octet-stream";else if(b instanceof l){if(b.hasBlob()){var f=b.getBlob();N.ruid=f.ruid;F=f.type||"application/octet-stream"}}else"string"==typeof b&&(C="UTF-8",F="text/plain;charset=UTF-8",b=a.utf8_encode(b));this.withCredentials||(this.withCredentials=N.required_caps&&N.required_caps.send_browser_cookies&&
!R);O=!I&&this.upload.hasEventListener();U=!1;T=!b;I||(K=!0);t.call(this,b)},abort:function(){if(U=!0,I=!1,~e.inArray(d("readyState"),[s.UNSENT,s.OPENED,s.DONE]))d("readyState",s.UNSENT);else{if(d("readyState",s.DONE),K=!1,!H)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);H.getRuntime().exec.call(H,"XMLHttpRequest","abort",T);T=!0}},destroy:function(){H&&("function"===e.typeOf(H.destroy)&&H.destroy(),H=null);this.unbindAll();this.upload&&(this.upload.unbindAll(),this.upload=null)}});this.handleEventProps(x.concat(["readystatechange"]));
this.upload.handleEventProps(x)}var y={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",
405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",
504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};v.prototype=d.instance;var x="loadstart progress abort error load timeout loadend".split(" ");return s.UNSENT=0,s.OPENED=1,s.HEADERS_RECEIVED=2,s.LOADING=3,s.DONE=4,s.prototype=d.instance,s});h("moxie/runtime/Transporter",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(e,c,d,a){function b(){function a(c,
d){var h=this;k=d;h.bind("TransportingProgress",function(a){r=a.loaded;n>r&&-1===e.inArray(h.state,[b.IDLE,b.DONE])&&f.call(h)},999);h.bind("TransportingComplete",function(){r=n;h.state=b.DONE;l=null;h.result=k.exec.call(h,"Transporter","getAsBlob",c||"")},999);h.state=b.BUSY;h.trigger("TransportingStarted");f.call(h)}function f(){var a;a=n-r;v>a&&(v=a);a=c.btoa(l.substr(r,v));k.exec.call(this,"Transporter","receive",a,n)}var h,k,l,n,r,v;d.call(this);e.extend(this,{uid:e.guid("uid_"),state:b.IDLE,
result:null,transport:function(b,c,d){var f=this;d=e.extend({chunk_size:204798},d);(h=d.chunk_size%3)&&(d.chunk_size+=3-h);v=d.chunk_size;n=r=0;l=this.result=null;if(l=b,n=b.length,"string"===e.typeOf(d)||d.ruid)a.call(f,c,this.connectRuntime(d));else{var m=function(b,d){f.unbind("RuntimeInit",m);a.call(f,c,d)};this.bind("RuntimeInit",m);this.connectRuntime(d)}},abort:function(){this.state=b.IDLE;k&&(k.exec.call(this,"Transporter","clear"),this.trigger("TransportingAborted"));n=r=0;l=this.result=
null},destroy:function(){this.unbindAll();k=null;this.disconnectRuntime();n=r=0;l=this.result=null}})}return b.IDLE=0,b.BUSY=1,b.DONE=2,b.prototype=a.instance,b});h("moxie/image/Image","moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/Exceptions moxie/file/FileReaderSync moxie/xhr/XMLHttpRequest moxie/runtime/Runtime moxie/runtime/RuntimeClient moxie/runtime/Transporter moxie/core/utils/Env moxie/core/EventTarget moxie/file/Blob moxie/file/File moxie/core/utils/Encode".split(" "),function(e,
c,d,a,b,f,h,k,n,l,w,r,v){function s(){function a(b){var c=e.typeOf(b);try{if(b instanceof s){if(!b.size)throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);l.apply(this,arguments)}else if(b instanceof w){if(!~e.inArray(b.type,["image/jpeg","image/png"]))throw new d.ImageError(d.ImageError.WRONG_FORMAT);A.apply(this,arguments)}else if(-1!==e.inArray(c,["blob","file"]))a.call(this,new r(null,b),arguments[1]);else if("string"===c)"data:"===b.substr(0,5)?a.call(this,new w(null,{data:b}),arguments[1]):
u.apply(this,arguments);else{if("node"!==c||"img"!==b.nodeName.toLowerCase())throw new d.DOMException(d.DOMException.TYPE_MISMATCH_ERR);a.call(this,b.src,arguments[1])}}catch(f){this.trigger("error",f.code)}}function l(a,b){var c=this.connectRuntime(a.ruid);this.ruid=c.uid;c.exec.call(this,"Image","loadFromImage",a,"undefined"===e.typeOf(b)?!0:b)}function A(a,b){function c(b){d.ruid=b.uid;b.exec.call(d,"Image","loadFromBlob",a)}var d=this;d.name=a.name||"";a.isDetached()?(this.bind("RuntimeInit",
function(a,b){c(b)}),b&&"string"==typeof b.required_caps&&(b.required_caps=f.parseCaps(b.required_caps)),this.connectRuntime(e.extend({required_caps:{access_image_binary:!0,resize_image:!0}},b))):c(this.connectRuntime(a.ruid))}function u(a,c){var d=this,e;e=new b;e.open("get",a);e.responseType="blob";e.onprogress=function(a){d.trigger(a)};e.onload=function(){A.call(d,e.response,!0)};e.onerror=function(a){d.trigger(a)};e.onloadend=function(){e.destroy()};e.bind("RuntimeError",function(a,b){d.trigger("RuntimeError",
b)});e.send(null,c)}h.call(this);e.extend(this,{uid:e.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){a.apply(this,arguments)},downsize:function(a,b,c,f){var h={width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90,crop:!1,preserveHeaders:!0,resample:!1};a="object"==typeof a?e.extend(h,a):e.extend(h,{width:a,height:b,crop:c,preserveHeaders:f});try{if(!this.size)throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);
if(this.width>s.MAX_RESIZE_WIDTH||this.height>s.MAX_RESIZE_HEIGHT)throw new d.ImageError(d.ImageError.MAX_RESOLUTION_ERR);this.exec("Image","downsize",a.width,a.height,a.crop,a.preserveHeaders)}catch(m){this.trigger("error",m.code)}},crop:function(a,b,c){this.downsize(a,b,!0,c)},getAsCanvas:function(){if(!n.can("create_canvas"))throw new d.RuntimeError(d.RuntimeError.NOT_SUPPORTED_ERR);return this.connectRuntime(this.ruid).exec.call(this,"Image","getAsCanvas")},getAsBlob:function(a,b){if(!this.size)throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);
return this.exec("Image","getAsBlob",a||"image/jpeg",b||90)},getAsDataURL:function(a,b){if(!this.size)throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);return this.exec("Image","getAsDataURL",a||"image/jpeg",b||90)},getAsBinaryString:function(a,b){var c=this.getAsDataURL(a,b);return v.atob(c.substring(c.indexOf("base64,")+7))},embed:function(a,b){function f(b,c){var l=this;if(n.can("create_canvas")){var p=l.getAsCanvas();if(p)return a.appendChild(p),p=null,l.destroy(),void h.trigger("embedded")}p=
l.getAsDataURL(b,c);if(!p)throw new d.ImageError(d.ImageError.WRONG_FORMAT);if(n.can("use_data_uri_of",p.length))a.innerHTML='<img src="'+p+'" width="'+l.width+'" height="'+l.height+'" />',l.destroy(),h.trigger("embedded");else{var r=new k;r.bind("TransportingComplete",function(){m=h.connectRuntime(this.result.ruid);h.bind("Embedded",function(){e.extend(m.getShimContainer().style,{top:"0px",left:"0px",width:l.width+"px",height:l.height+"px"});m=null},999);m.exec.call(h,"ImageView","display",this.result.uid,
width,height);l.destroy()});r.transport(v.atob(p.substring(p.indexOf("base64,")+7)),b,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",container:a})}}var h=this,m;b=e.extend({width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90},b||{});try{if(!(a=c.get(a)))throw new d.DOMException(d.DOMException.INVALID_NODE_TYPE_ERR);if(!this.size)throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);this.width>s.MAX_RESIZE_WIDTH||this.height>s.MAX_RESIZE_HEIGHT;var l=
new s;return l.bind("Resize",function(){f.call(this,b.type,b.quality)}),l.bind("Load",function(){l.downsize(b)}),this.meta.thumb&&this.meta.thumb.width>=b.width&&this.meta.thumb.height>=b.height?l.load(this.meta.thumb.data):l.clone(this,!1),l}catch(p){this.trigger("error",p.code)}},destroy:function(){this.ruid&&(this.getRuntime().exec.call(this,"Image","destroy"),this.disconnectRuntime());this.unbindAll()}});this.handleEventProps(y);this.bind("Load Resize",function(){var a=void 0,a=this.exec("Image",
"getInfo");this.size=a.size;this.width=a.width;this.height=a.height;this.type=a.type;this.meta=a.meta;""===this.name&&(this.name=a.name)},999)}var y=["progress","load","error","resize","embedded"];return s.MAX_RESIZE_WIDTH=8192,s.MAX_RESIZE_HEIGHT=8192,s.prototype=l.instance,s});h("moxie/runtime/html5/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(e,c,d,a){var b={};return d.addConstructor("html5",function(c,f,h){var k=this,l=d.capTest,
n=d.capTrue;h=e.extend({access_binary:l(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return k.can("access_binary")&&!!b.Image},display_media:l(a.can("create_canvas")||a.can("use_data_uri_over32kb")),do_cors:l(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:l(function(){var b=document.createElement("div");return("draggable"in b||"ondragstart"in b&&"ondrop"in b)&&("IE"!==a.browser||a.verComp(a.version,9,">"))}()),filter_by_extension:l("Chrome"===
a.browser&&a.verComp(a.version,28,">=")||"IE"===a.browser&&a.verComp(a.version,10,">=")||"Safari"===a.browser&&a.verComp(a.version,7,">=")),return_response_headers:n,return_response_type:function(b){return"json"===b&&window.JSON?!0:a.can("return_response_type",b)},return_status_code:n,report_upload_progress:l(window.XMLHttpRequest&&(new XMLHttpRequest).upload),resize_image:function(){return k.can("access_binary")&&a.can("create_canvas")},select_file:function(){return a.can("use_fileinput")&&window.File},
select_folder:function(){return k.can("select_file")&&"Chrome"===a.browser&&a.verComp(a.version,21,">=")},select_multiple:function(){return!(!k.can("select_file")||"Safari"===a.browser&&"Windows"===a.os||"iOS"===a.os&&a.verComp(a.osVersion,"7.0.0",">")&&a.verComp(a.osVersion,"8.0.0","<"))},send_binary_string:l(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:l(window.XMLHttpRequest),send_multipart:function(){return!!(window.XMLHttpRequest&&
(new XMLHttpRequest).upload&&window.FormData)||k.can("send_binary_string")},slice_blob:l(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return k.can("slice_blob")&&k.can("send_multipart")},summon_file_dialog:function(){return k.can("select_file")&&("Firefox"===a.browser&&a.verComp(a.version,4,">=")||"Opera"===a.browser&&a.verComp(a.version,12,">=")||"IE"===a.browser&&a.verComp(a.version,10,">=")||!!~e.inArray(a.browser,["Chrome",
"Safari"]))},upload_filesize:n},h);d.call(this,c,f||"html5",h);e.extend(this,{init:function(){this.trigger("Init")},destroy:function(a){return function(){a.call(k);a=k=null}}(this.destroy)});e.extend(this.getShim(),b)}),b});h("moxie/core/utils/Events",["moxie/core/utils/Basic"],function(e){function c(){this.returnValue=!1}function d(){this.cancelBubble=!0}var a={},b="moxie_"+e.guid(),f=function(c,d,f){var h;if(d=d.toLowerCase(),c[b]&&a[c[b]]&&a[c[b]][d]){h=a[c[b]][d];for(var p=h.length-1;0<=p&&(h[p].orig!==
f&&h[p].key!==f||(c.removeEventListener?c.removeEventListener(d,h[p].func,!1):c.detachEvent&&c.detachEvent("on"+d,h[p].func),h[p].orig=null,h[p].func=null,h.splice(p,1),void 0===f));p--);if(h.length||delete a[c[b]][d],e.isEmptyObj(a[c[b]])){delete a[c[b]];try{delete c[b]}catch(k){c[b]=void 0}}}};return{addEvent:function(f,h,p,l){var k;h=h.toLowerCase();f.addEventListener?(k=p,f.addEventListener(h,k,!1)):f.attachEvent&&(k=function(){var a=window.event;a.target||(a.target=a.srcElement);a.preventDefault=
c;a.stopPropagation=d;p(a)},f.attachEvent("on"+h,k));f[b]||(f[b]=e.guid());a.hasOwnProperty(f[b])||(a[f[b]]={});f=a[f[b]];f.hasOwnProperty(h)||(f[h]=[]);f[h].push({func:k,orig:p,key:l})},removeEvent:f,removeAllEvents:function(c,d){c&&c[b]&&e.each(a[c[b]],function(a,b){f(c,b,d)})}}});h("moxie/runtime/html5/file/FileInput","moxie/runtime/html5/Runtime moxie/file/File moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Events moxie/core/utils/Mime moxie/core/utils/Env".split(" "),function(e,
c,d,a,b,f,h){return e.FileInput=function(){var e;d.extend(this,{init:function(g){var l=this,k=l.getRuntime(),n,v,s;e=g;g=e.accept.mimes||f.extList2mimes(e.accept,k.can("filter_by_extension"));n=k.getShimContainer();n.innerHTML='<input id="'+k.uid+'" type="file" style="font-size:999px;opacity:0;"'+(e.multiple&&k.can("select_multiple")?"multiple":"")+(e.directory&&k.can("select_folder")?"webkitdirectory directory":"")+(g?' accept="'+g.join(",")+'"':"")+" />";g=a.get(k.uid);d.extend(g.style,{position:"absolute",
top:0,left:0,width:"100%",height:"100%"});v=a.get(e.browse_button);k.can("summon_file_dialog")&&("static"===a.getStyle(v,"position")&&(v.style.position="relative"),s=parseInt(a.getStyle(v,"z-index"),10)||1,v.style.zIndex=s,n.style.zIndex=s-1,b.addEvent(v,"click",function(b){var c=a.get(k.uid);c&&!c.disabled&&c.click();b.preventDefault()},l.uid));s=k.can("summon_file_dialog")?v:n;b.addEvent(s,"mouseover",function(){l.trigger("mouseenter")},l.uid);b.addEvent(s,"mouseout",function(){l.trigger("mouseleave")},
l.uid);b.addEvent(s,"mousedown",function(){l.trigger("mousedown")},l.uid);b.addEvent(a.get(e.container),"mouseup",function(){l.trigger("mouseup")},l.uid);g.onchange=function x(a){(l.files=[],d.each(this.files,function(a){var b="";return e.directory&&"."==a.name?!0:(a.webkitRelativePath&&(b="/"+a.webkitRelativePath.replace(/^\//,"")),a=new c(k.uid,a),a.relativePath=b,void l.files.push(a))}),"IE"!==h.browser&&"IEMobile"!==h.browser)?this.value="":(a=this.cloneNode(!0),this.parentNode.replaceChild(a,
this),a.onchange=x);l.files.length&&l.trigger("change")};l.trigger({type:"ready",async:!0});n=null},disable:function(b){var c=this.getRuntime(),d;(d=a.get(c.uid))&&(d.disabled=!!b)},destroy:function(){var c=this.getRuntime(),d=c.getShim(),c=c.getShimContainer();b.removeAllEvents(c,this.uid);b.removeAllEvents(e&&a.get(e.container),this.uid);b.removeAllEvents(e&&a.get(e.browse_button),this.uid);c&&(c.innerHTML="");d.removeInstance(this.uid);e=null}})}});h("moxie/runtime/html5/file/Blob",["moxie/runtime/html5/Runtime",
"moxie/file/Blob"],function(e,c){return e.Blob=function(){function d(a,b,c){var d;if(!window.File.prototype.slice)return(d=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?d.call(a,b,c):null;try{return a.slice(),a.slice(b,c)}catch(e){return a.slice(b,c-b)}}this.slice=function(){return new c(this.getRuntime().uid,d.apply(this,arguments))}}});h("moxie/runtime/html5/file/FileDrop","moxie/runtime/html5/Runtime moxie/file/File moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Events moxie/core/utils/Mime".split(" "),
function(e,c,d,a,b,f){return e.FileDrop=function(){function e(a){if(!a.dataTransfer||!a.dataTransfer.types)return!1;a=d.toArray(a.dataTransfer.types||[]);return-1!==d.inArray("Files",a)||-1!==d.inArray("public.file-url",a)||-1!==d.inArray("application/x-moz-file",a)}function g(a,b){var e;y.length?(e=f.getFileExtension(a.name),e=!e||-1!==d.inArray(e,y)):e=!0;e&&(e=new c(z,a),e.relativePath=b||"",s.push(e))}function h(a){for(var b=[],c=0;c<a.length;c++)[].push.apply(b,a[c].extensions.split(/\s*,\s*/));
return-1===d.inArray("*",b)?b:[]}function l(a,b){var c=[];d.each(a,function(a){var b=a.webkitGetAsEntry();b&&(b.isFile?g(a.getAsFile(),b.fullPath):c.push(b))});c.length?k(c,b):b()}function k(a,b){var c=[];d.each(a,function(a){c.push(function(b){n(a,b)})});d.inSeries(c,function(){b()})}function n(a,b){a.isFile?a.file(function(c){g(c,a.fullPath);b()},function(){b()}):a.isDirectory?v(a,b):b()}function v(a,b){function c(a){e.readEntries(function(b){b.length?([].push.apply(d,b),c(a)):a()},a)}var d=[],
e=a.createReader();c(function(){k(d,b)})}var s=[],y=[],x,z;d.extend(this,{init:function(a){var c=this;x=a;z=c.ruid;y=h(x.accept);a=x.container;b.addEvent(a,"dragover",function(a){e(a)&&(a.preventDefault(),a.dataTransfer.dropEffect="copy")},c.uid);b.addEvent(a,"drop",function(a){e(a)&&(a.preventDefault(),s=[],a.dataTransfer.items&&a.dataTransfer.items[0].webkitGetAsEntry?l(a.dataTransfer.items,function(){c.files=s;c.trigger("drop")}):(d.each(a.dataTransfer.files,function(a){g(a)}),c.files=s,c.trigger("drop")))},
c.uid);b.addEvent(a,"dragenter",function(a){c.trigger("dragenter")},c.uid);b.addEvent(a,"dragleave",function(a){c.trigger("dragleave")},c.uid)},destroy:function(){b.removeAllEvents(x&&a.get(x.container),this.uid);z=s=y=x=null}})}});h("moxie/runtime/html5/file/FileReader",["moxie/runtime/html5/Runtime","moxie/core/utils/Encode","moxie/core/utils/Basic"],function(e,c,d){return e.FileReader=function(){var a,b=!1;d.extend(this,{read:function(e,g){var f=this;f.result="";a=new window.FileReader;a.addEventListener("progress",
function(a){f.trigger(a)});a.addEventListener("load",function(d){f.result=b?c.atob(a.result.substring(a.result.indexOf("base64,")+7)):a.result;f.trigger(d)});a.addEventListener("error",function(b){f.trigger(b,a.error)});a.addEventListener("loadend",function(b){a=null;f.trigger(b)});"function"===d.typeOf(a[e])?(b=!1,a[e](g.getSource())):"readAsBinaryString"===e&&(b=!0,a.readAsDataURL(g.getSource()))},abort:function(){a&&a.abort()},destroy:function(){a=null}})}});h("moxie/runtime/html5/xhr/XMLHttpRequest",
"moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/utils/Mime moxie/core/utils/Url moxie/file/File moxie/file/Blob moxie/xhr/FormData moxie/core/Exceptions moxie/core/utils/Env".split(" "),function(e,c,d,a,b,f,h,k,n){return e.XMLHttpRequest=function(){function e(a,b){var c=this,d,g;d=b.getBlob().getSource();g=new window.FileReader;g.onload=function(){b.append(b.getBlobName(),new f(null,{type:d.type,data:g.result}));v.send.call(c,a,b)};g.readAsBinaryString(d)}function g(){var a;if(!window.XMLHttpRequest||
"IE"===n.browser&&n.verComp(n.version,8,"<"))a:{for(var b=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],c=0;c<b.length;c++)try{a=new ActiveXObject(b[c]);break a}catch(d){}a=void 0}else a=new window.XMLHttpRequest;return a}function r(a){var b="----moxieboundary"+(new Date).getTime(),c="";if(!this.getRuntime().can("send_binary_string"))throw new k.RuntimeError(k.RuntimeError.NOT_SUPPORTED_ERR);return s.setRequestHeader("Content-Type","multipart/form-data; boundary="+b),a.each(function(a,d){c+=a instanceof
f?"--"+b+'\r\nContent-Disposition: form-data; name="'+d+'"; filename="'+unescape(encodeURIComponent(a.name||"blob"))+'"\r\nContent-Type: '+(a.type||"application/octet-stream")+"\r\n\r\n"+a.getSource()+"\r\n":"--"+b+'\r\nContent-Disposition: form-data; name="'+d+'"\r\n\r\n'+unescape(encodeURIComponent(a))+"\r\n"}),c+="--"+b+"--\r\n"}var v=this,s,y;c.extend(this,{send:function(b,d){var k=this,q="Mozilla"===n.browser&&n.verComp(n.version,4,">=")&&n.verComp(n.version,7,"<"),v="Android Browser"===n.browser,
u=!1;if(y=b.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase(),s=g(),s.open(b.method,b.url,b.async,b.user,b.password),d instanceof f)d.isDetached()&&(u=!0),d=d.getSource();else if(d instanceof h){if(d.hasBlob())if(d.getBlob().isDetached())d=r.call(k,d),u=!0;else if((q||v)&&"blob"===c.typeOf(d.getBlob().getSource())&&window.FileReader)return void e.call(k,b,d);if(d instanceof h){var B=new window.FormData;d.each(function(a,b){a instanceof f?B.append(b,a.getSource()):B.append(b,a)});d=B}}s.upload?
(b.withCredentials&&(s.withCredentials=!0),s.addEventListener("load",function(a){k.trigger(a)}),s.addEventListener("error",function(a){k.trigger(a)}),s.addEventListener("progress",function(a){k.trigger(a)}),s.upload.addEventListener("progress",function(a){k.trigger({type:"UploadProgress",loaded:a.loaded,total:a.total})})):s.onreadystatechange=function(){switch(s.readyState){case 3:var c,d;try{a.hasSameOrigin(b.url)&&(c=s.getResponseHeader("Content-Length")||0),s.responseText&&(d=s.responseText.length)}catch(e){c=
d=0}k.trigger({type:"progress",lengthComputable:!!c,total:parseInt(c,10),loaded:d});break;case 4:s.onreadystatechange=function(){},k.trigger(0===s.status?"error":"load")}};c.isEmptyObj(b.headers)||c.each(b.headers,function(a,b){s.setRequestHeader(b,a)});""!==b.responseType&&"responseType"in s&&("json"!==b.responseType||n.can("return_response_type","json")?s.responseType=b.responseType:s.responseType="text");u?s.sendAsBinary?s.sendAsBinary(d):!function(){for(var a=new Uint8Array(d.length),b=0;b<d.length;b++)a[b]=
255&d.charCodeAt(b);s.send(a.buffer)}():s.send(d);k.trigger("loadstart")},getStatus:function(){try{if(s)return s.status}catch(a){}return 0},getResponse:function(a){var c=this.getRuntime();try{switch(a){case "blob":var e=new b(c.uid,s.response),g=s.getResponseHeader("Content-Disposition");if(g){var f=g.match(/filename=([\'\"'])([^\1]+)\1/);f&&(y=f[2])}return e.name=y,e.type||(e.type=d.getFileMime(y)),e;case "json":return n.can("return_response_type","json")?s.response:200===s.status&&window.JSON?JSON.parse(s.responseText):
null;case "document":var h=s.responseXML,l=s.responseText;return"IE"===n.browser&&l&&h&&!h.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(s.getResponseHeader("Content-Type"))&&(h=new window.ActiveXObject("Microsoft.XMLDOM"),h.async=!1,h.validateOnParse=!1,h.loadXML(l)),h&&("IE"===n.browser&&0!==h.parseError||!h.documentElement||"parsererror"===h.documentElement.tagName)?null:h;default:return""!==s.responseText?s.responseText:null}}catch(m){return null}},getAllResponseHeaders:function(){try{return s.getAllResponseHeaders()}catch(a){}return""},
abort:function(){s&&s.abort()},destroy:function(){v=y=null}})}});h("moxie/runtime/html5/utils/BinaryReader",["moxie/core/utils/Basic"],function(e){function c(b){b instanceof ArrayBuffer?d.apply(this,arguments):a.apply(this,arguments)}function d(a){var c=new DataView(a);e.extend(this,{readByteAt:function(a){return c.getUint8(a)},writeByteAt:function(a,b){c.setUint8(a,b)},SEGMENT:function(d,e,g){switch(arguments.length){case 2:return a.slice(d,d+e);case 1:return a.slice(d);case 3:if(null===g&&(g=new ArrayBuffer),
g instanceof ArrayBuffer){var f=new Uint8Array(this.length()-e+g.byteLength);0<d&&f.set(new Uint8Array(a.slice(0,d)),0);f.set(new Uint8Array(g),d);f.set(new Uint8Array(a.slice(d+e)),d+g.byteLength);this.clear();a=f.buffer;c=new DataView(a);break}default:return a}},length:function(){return a?a.byteLength:0},clear:function(){c=a=null}})}function a(a){function c(d,e,g){g=3===arguments.length?g:a.length-e-1;a=a.substr(0,e)+d+a.substr(g+e)}e.extend(this,{readByteAt:function(c){return a.charCodeAt(c)},
writeByteAt:function(a,b){c(String.fromCharCode(b),a,1)},SEGMENT:function(d,e,g){switch(arguments.length){case 1:return a.substr(d);case 2:return a.substr(d,e);case 3:c(null!==g?g:"",d,e);break;default:return a}},length:function(){return a?a.length:0},clear:function(){a=null}})}return e.extend(c.prototype,{littleEndian:!1,read:function(a,c){var d,e,g;if(a+c>this.length())throw Error("You are trying to read outside the source boundaries.");e=this.littleEndian?0:-8*(c-1);for(d=g=0;c>g;g++)d|=this.readByteAt(a+
g)<<Math.abs(e+8*g);return d},write:function(a,c,d){var e,g;if(a>this.length())throw Error("You are trying to write outside the source boundaries.");e=this.littleEndian?0:-8*(d-1);for(g=0;d>g;g++)this.writeByteAt(a+g,c>>Math.abs(e+8*g)&255)},BYTE:function(a){return this.read(a,1)},SHORT:function(a){return this.read(a,2)},LONG:function(a){return this.read(a,4)},SLONG:function(a){a=this.read(a,4);return 2147483647<a?a-4294967296:a},CHAR:function(a){return String.fromCharCode(this.read(a,1))},STRING:function(a,
c){return this.asArray("CHAR",a,c).join("")},asArray:function(a,c,d){for(var e=[],g=0;d>g;g++)e[g]=this[a](c+g);return e}}),c});h("moxie/runtime/html5/image/JPEGHeaders",["moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(e,c){return function a(b){var f=[],h,k,n,l=0;if(h=new e(b),65496!==h.SHORT(0))throw h.clear(),new c.ImageError(c.ImageError.WRONG_FORMAT);for(k=2;k<=h.length();)if(n=h.SHORT(k),65488<=n&&65495>=n)k+=2;else{if(65498===n||65497===n)break;l=h.SHORT(k+2)+2;65505<=
n&&65519>=n&&f.push({hex:n,name:"APP"+(15&n),start:k,length:l,segment:h.SEGMENT(k,l)});k+=l}return h.clear(),{headers:f,restore:function(a){var b,c,h;h=new e(a);k=65504==h.SHORT(2)?4+h.SHORT(4):2;c=0;for(b=f.length;b>c;c++)h.SEGMENT(k,0,f[c].segment),k+=f[c].length;return a=h.SEGMENT(),h.clear(),a},strip:function(b){var c,f,h;c=new a(b);f=c.headers;c.purge();c=new e(b);for(h=f.length;h--;)c.SEGMENT(f[h].start,f[h].length,"");return b=c.SEGMENT(),c.clear(),b},get:function(a){for(var b=[],c=0,e=f.length;e>
c;c++)f[c].name===a.toUpperCase()&&b.push(f[c].segment);return b},set:function(a,b){var c=[],e,g,h;"string"==typeof b?c.push(b):c=b;e=g=0;for(h=f.length;h>e&&(f[e].name===a.toUpperCase()&&(f[e].segment=c[g],f[e].length=c[g].length,g++),!(g>=c.length));e++);},purge:function(){this.headers=f=[]}}}});h("moxie/runtime/html5/image/ExifParser",["moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(g,c,d){function a(b){function f(a,b){var c,h,k,m,p,r,q,w,u=[],
J={},M={1:"BYTE",7:"UNDEFINED",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",9:"SLONG",10:"SRATIONAL"},P={BYTE:1,UNDEFINED:1,ASCII:1,SHORT:2,LONG:4,RATIONAL:8,SLONG:4,SRATIONAL:8};c=this.SHORT(a);for(h=0;c>h;h++)if(u=[],q=a+2+12*h,k=b[this.SHORT(q)],k!==e){if(m=M[this.SHORT(q+=2)],p=this.LONG(q+=2),r=P[m],!r)throw new d.ImageError(d.ImageError.INVALID_META_ERR);if(q+=4,4<r*p&&(q=this.LONG(q)+l.tiffHeader),q+r*p>=this.length())throw new d.ImageError(d.ImageError.INVALID_META_ERR);"ASCII"!==m?(u=this.asArray(m,
q,p),w=1==p?u[0]:u,n.hasOwnProperty(k)&&"object"!=typeof w?J[k]=n[k][w]:J[k]=w):J[k]=g.trim(this.STRING(q,p).replace(/\0$/,""))}return J}var h,k,n,l,w,r;if(c.call(this,b),k={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",
37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"},thumb:{513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength"}},n={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",
3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",
1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",
69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",
95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",
W:"West longitude"}},l={tiffHeader:10},w=l.tiffHeader,h={clear:this.clear},g.extend(this,{read:function(){try{return a.prototype.read.apply(this,arguments)}catch(b){throw new d.ImageError(d.ImageError.INVALID_META_ERR);}},write:function(){try{return a.prototype.write.apply(this,arguments)}catch(b){throw new d.ImageError(d.ImageError.INVALID_META_ERR);}},UNDEFINED:function(){return this.BYTE.apply(this,arguments)},RATIONAL:function(a){return this.LONG(a)/this.LONG(a+4)},SRATIONAL:function(a){return this.SLONG(a)/
this.SLONG(a+4)},ASCII:function(a){return this.CHAR(a)},TIFF:function(){return r||null},EXIF:function(){var a=null;if(l.exifIFD){try{a=f.call(this,l.exifIFD,k.exif)}catch(b){return null}if(a.ExifVersion&&"array"===g.typeOf(a.ExifVersion)){for(var c=0,d="";c<a.ExifVersion.length;c++)d+=String.fromCharCode(a.ExifVersion[c]);a.ExifVersion=d}}return a},GPS:function(){var a=null;if(l.gpsIFD){try{a=f.call(this,l.gpsIFD,k.gps)}catch(b){return null}a.GPSVersionID&&"array"===g.typeOf(a.GPSVersionID)&&(a.GPSVersionID=
a.GPSVersionID.join("."))}return a},thumb:function(){if(l.IFD1)try{var a=f.call(this,l.IFD1,k.thumb);if("JPEGInterchangeFormat"in a)return this.SEGMENT(l.tiffHeader+a.JPEGInterchangeFormat,a.JPEGInterchangeFormatLength)}catch(b){}return null},setExif:function(a,b){var c;if("PixelXDimension"!==a&&"PixelYDimension"!==a)c=!1;else a:{c=a;var d,e,g,f=0;if("string"==typeof c)for(e in d=k.exif,d)if(d[e]===c){c=e;break}d=l.exifIFD;e=this.SHORT(d);for(var h=0;e>h;h++)if(g=d+12*h+2,this.SHORT(g)==c){f=g+8;
break}if(f){try{this.write(f,b,4)}catch(m){c=!1;break a}c=!0}else c=!1}return c},clear:function(){h.clear();b=k=n=r=l=h=null}}),65505!==this.SHORT(0)||"EXIF\x00"!==this.STRING(4,5).toUpperCase())throw new d.ImageError(d.ImageError.INVALID_META_ERR);if(this.littleEndian=18761==this.SHORT(w),42!==this.SHORT(w+=2))throw new d.ImageError(d.ImageError.INVALID_META_ERR);l.IFD0=l.tiffHeader+this.LONG(w+=2);r=f.call(this,l.IFD0,k.tiff);"ExifIFDPointer"in r&&(l.exifIFD=l.tiffHeader+r.ExifIFDPointer,delete r.ExifIFDPointer);
"GPSInfoIFDPointer"in r&&(l.gpsIFD=l.tiffHeader+r.GPSInfoIFDPointer,delete r.GPSInfoIFDPointer);g.isEmptyObj(r)&&(r=null);(w=this.LONG(l.IFD0+12*this.SHORT(l.IFD0)+2))&&(l.IFD1=l.tiffHeader+w)}return a.prototype=c.prototype,a});h("moxie/runtime/html5/image/JPEG",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEGHeaders","moxie/runtime/html5/utils/BinaryReader","moxie/runtime/html5/image/ExifParser"],function(e,c,d,a,b){return function(f){function h(a){var b=0,c,d;for(a||
(a=n);b<=a.length();){if(c=a.SHORT(b+=2),65472<=c&&65475>=c)return b+=5,{height:a.SHORT(b),width:a.SHORT(b+2)};d=a.SHORT(b+=2);b+=d-2}return null}function k(){var b=w.thumb(),c,d;return b&&(c=new a(b),d=h(c),c.clear(),d)?(d.data=b,d):null}var n,l,w,r;if(n=new a(f),65496!==n.SHORT(0))throw new c.ImageError(c.ImageError.WRONG_FORMAT);l=new d(f);try{w=new b(l.get("app1")[0])}catch(v){}r=h.call(this);e.extend(this,{type:"image/jpeg",size:n.length(),width:r&&r.width||0,height:r&&r.height||0,setExif:function(a,
b){return w?("object"===e.typeOf(a)?e.each(a,function(a,b){w.setExif(b,a)}):w.setExif(a,b),void l.set("app1",w.SEGMENT())):!1},writeHeaders:function(){return l.restore(arguments.length?arguments[0]:f)},stripHeaders:function(a){return l.strip(a)},purge:function(){w&&l&&n&&(w.clear(),l.purge(),n.clear(),r=l=w=n=null)}});w&&(this.meta={tiff:w.TIFF(),exif:w.EXIF(),gps:w.GPS(),thumb:k()})}});h("moxie/runtime/html5/image/PNG",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],
function(e,c,d){return function(a){function b(){f&&(f.clear(),a=h=f=null)}var f,h;f=new d(a);(function(){for(var a=0,b=0,c=[35152,20039,3338,6666],b=0;b<c.length;b++,a+=2)if(c[b]!=f.SHORT(a))throw new e.ImageError(e.ImageError.WRONG_FORMAT);})();h=function(){var a,b,c=8,d,e,g,h;return a=(d=f.LONG(c),e=f.STRING(c+=4,4),g=c+=4,h=f.LONG(c+d),{length:d,type:e,start:g,CRC:h}),"IHDR"==a.type?(b=a.start,{width:f.LONG(b),height:f.LONG(b+4)}):null}.call(this);c.extend(this,{type:"image/png",size:f.length(),
width:h.width,height:h.height,purge:function(){b.call(this)}});b.call(this)}});h("moxie/runtime/html5/image/ImageInfo",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEG","moxie/runtime/html5/image/PNG"],function(e,c,d,a){return function(b){var f=[d,a],h;h=function(){for(var a=0;a<f.length;a++)try{return new f[a](b)}catch(d){}throw new c.ImageError(c.ImageError.WRONG_FORMAT);}();e.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(a){return a},
stripHeaders:function(a){return a},purge:function(){b=null}});e.extend(this,h);this.purge=function(){h.purge();h=null}}});h("moxie/runtime/html5/image/MegaPixel",[],function(){function e(c){var d=c.naturalWidth;if(1048576<d*c.naturalHeight){var a=document.createElement("canvas");a.width=a.height=1;a=a.getContext("2d");return a.drawImage(c,-d+1,0),0===a.getImageData(0,0,1,1).data[3]}return!1}return{isSubsampled:e,renderTo:function(c,d,a){var b=c.naturalWidth,f=c.naturalHeight,h=a.width,k=a.height,
n=a.x||0;a=a.y||0;d=d.getContext("2d");e(c)&&(b/=2,f/=2);var l=document.createElement("canvas");l.width=l.height=1024;var w=l.getContext("2d"),r;r=f;var v=document.createElement("canvas");v.width=1;v.height=r;v=v.getContext("2d");v.drawImage(c,0,0);for(var v=v.getImageData(0,0,1,r).data,s=0,u=r,x=r;x>s;)0===v[4*(x-1)+3]?u=x:s=x,x=u+s>>1;r=x/r;r=0===r?1:r;for(v=0;f>v;){s=v+1024>f?f-v:1024;for(u=0;b>u;){x=u+1024>b?b-u:1024;w.clearRect(0,0,1024,1024);w.drawImage(c,-u,-v);var z=u*h/b+n<<0,A=Math.ceil(x*
h/b),E=v*k/f/r+a<<0,D=Math.ceil(s*k/f/r);d.drawImage(l,0,0,x,s,z,E,A,D);u+=1024}v+=1024}}}});h("moxie/runtime/html5/image/Image","moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/Exceptions moxie/core/utils/Encode moxie/file/Blob moxie/file/File moxie/runtime/html5/image/ImageInfo moxie/runtime/html5/image/MegaPixel moxie/core/utils/Mime moxie/core/utils/Env".split(" "),function(e,c,d,a,b,f,h,k,n,l){return e.Image=function(){function e(){if(!D&&!A)throw new d.ImageError(d.DOMException.INVALID_STATE_ERR);
return D||A}function g(b){return a.atob(b.substring(b.indexOf("base64,")+7))}function v(b){var c=this;A=new Image;A.onerror=function(){x.call(this);c.trigger("error",d.ImageError.WRONG_FORMAT)};A.onload=function(){c.trigger("load")};A.src="data:"==b.substr(0,5)?b:"data:"+(B.type||"")+";base64,"+a.btoa(b)}function s(a,b){var c=this,e;return window.FileReader?(e=new FileReader,e.onload=function(){b(this.result)},e.onerror=function(){c.trigger("error",d.ImageError.WRONG_FORMAT)},e.readAsDataURL(a),void 0):
b(a.getAsDataURL())}function u(a,b,d,f){var g,h=0,m=0,p,n;if(J=f,n=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1,-1!==c.inArray(n,[5,6,7,8]))p=a,a=b,b=p;p=e();d?(a=Math.min(a,p.width),b=Math.min(b,p.height),g=Math.max(a/p.width,b/p.height)):g=Math.min(a/p.width,b/p.height);if(1<g&&!d&&f)m=void this.trigger("Resize");else{D||(D=document.createElement("canvas"));f=Math.round(p.width*g);g=Math.round(p.height*g);d?(D.width=a,D.height=b,f>a&&(h=Math.round((f-a)/2)),g>b&&(m=Math.round((g-b)/
2))):(D.width=f,D.height=g);if(!J){a=D.width;b=D.height;switch(n){case 5:case 6:case 7:case 8:D.width=b;D.height=a;break;default:D.width=a,D.height=b}d=D.getContext("2d");switch(n){case 2:d.translate(a,0);d.scale(-1,1);break;case 3:d.translate(a,b);d.rotate(Math.PI);break;case 4:d.translate(0,b);d.scale(1,-1);break;case 5:d.rotate(0.5*Math.PI);d.scale(1,-1);break;case 6:d.rotate(0.5*Math.PI);d.translate(0,-b);break;case 7:d.rotate(0.5*Math.PI);d.translate(a,-b);d.scale(-1,1);break;case 8:d.rotate(-0.5*
Math.PI),d.translate(-a,0)}}n=D;h=-h;m=-m;"iOS"===l.OS?k.renderTo(p,n,{width:f,height:g,x:h,y:m}):n.getContext("2d").drawImage(p,h,m,f,g);m=(this.width=D.width,this.height=D.height,G=!0,void this.trigger("Resize"))}return m}function x(){E&&(E.purge(),E=null);L=A=D=B=null;G=!1}var z=this,A,E,D,L,B,G=!1,J=!0;c.extend(this,{loadFromBlob:function(a){var b=this,c=b.getRuntime(),e=1<arguments.length?arguments[1]:!0;if(!c.can("access_binary"))throw new d.RuntimeError(d.RuntimeError.NOT_SUPPORTED_ERR);return B=
a,a.isDetached()?(L=a.getSource(),void v.call(this,L)):void s.call(this,a.getSource(),function(a){e&&(L=g(a));v.call(b,a)})},loadFromImage:function(a,b){this.meta=a.meta;B=new f(null,{name:a.name,size:a.size,type:a.type});v.call(this,b?L=a.getAsBinaryString():a.getAsDataURL())},getInfo:function(){var a=this.getRuntime(),c;return!E&&L&&a.can("access_image_binary")&&(E=new h(L)),c={width:e().width||0,height:e().height||0,type:B.type||n.getFileMime(B.name),size:L&&L.length||B.size||0,name:B.name||"",
meta:E&&E.meta||this.meta||{}},!c.meta||!c.meta.thumb||c.meta.thumb.data instanceof b||(c.meta.thumb.data=new b(null,{type:"image/jpeg",data:c.meta.thumb.data})),c},downsize:function(){u.apply(this,arguments)},getAsCanvas:function(){return D&&(D.id=this.uid+"_canvas"),D},getAsBlob:function(a,b){return a!==this.type&&u.call(this,this.width,this.height,!1),new f(null,{name:B.name||"",type:a,data:z.getAsBinaryString.call(this,a,b)})},getAsDataURL:function(a,b){var c=b||90;if(!G)return A.src;if("image/jpeg"!==
a)return D.toDataURL("image/png");try{return D.toDataURL("image/jpeg",c/100)}catch(d){return D.toDataURL("image/jpeg")}},getAsBinaryString:function(a,b){if(!G)return L||(L=g(z.getAsDataURL(a,b))),L;if("image/jpeg"!==a)L=g(z.getAsDataURL(a,b));else{var c;b||(b=90);try{c=D.toDataURL("image/jpeg",b/100)}catch(d){c=D.toDataURL("image/jpeg")}L=g(c);E&&(L=E.stripHeaders(L),J&&(E.meta&&E.meta.exif&&E.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),L=E.writeHeaders(L)),E.purge(),E=null)}return G=
!1,L},destroy:function(){z=null;x.call(this);this.getRuntime().getShim().removeInstance(this.uid)}})}});h("moxie/runtime/flash/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(e,c,d,a,b){function f(){var a;try{a=navigator.plugins["Shockwave Flash"],a=a.description}catch(b){try{a=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version")}catch(c){a="0.0"}}return a=a.match(/\d+/g),parseFloat(a[0]+
"."+a[1])}function h(a){var b=d.get(a);b&&"OBJECT"==b.nodeName&&("IE"===c.browser?(b.style.display="none",function r(){if(4==b.readyState){var c=d.get(a);if(c){for(var e in c)"function"==typeof c[e]&&(c[e]=null);c.parentNode.removeChild(c)}}else setTimeout(r,10)}()):b.parentNode.removeChild(b))}var k={};return b.addConstructor("flash",function(n){var l=this,w;n=e.extend({swf_url:c.swf_url},n);b.call(this,n,"flash",{access_binary:function(a){return a&&"browser"===l.mode},access_image_binary:function(a){return a&&
"browser"===l.mode},display_media:b.capTrue,do_cors:b.capTrue,drag_and_drop:!1,report_upload_progress:function(){return"client"===l.mode},resize_image:b.capTrue,return_response_headers:!1,return_response_type:function(a){return"json"===a&&window.JSON?!0:!e.arrayDiff(a,["","text","document"])||"browser"===l.mode},return_status_code:function(a){return"browser"===l.mode||!e.arrayDiff(a,[200,404])},select_file:b.capTrue,select_multiple:b.capTrue,send_binary_string:function(a){return a&&"browser"===l.mode},
send_browser_cookies:function(a){return a&&"browser"===l.mode},send_custom_headers:function(a){return a&&"browser"===l.mode},send_multipart:b.capTrue,slice_blob:function(a){return a&&"browser"===l.mode},stream_upload:function(a){return a&&"browser"===l.mode},summon_file_dialog:!1,upload_filesize:function(a){return 2097152>=e.parseSizeStr(a)||"client"===l.mode},use_http_method:function(a){return!e.arrayDiff(a,["GET","POST"])}},{access_binary:function(a){return a?"browser":"client"},access_image_binary:function(a){return a?
"browser":"client"},report_upload_progress:function(a){return a?"browser":"client"},return_response_type:function(a){return e.arrayDiff(a,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(a){return e.arrayDiff(a,[200,404])?"browser":["client","browser"]},send_binary_string:function(a){return a?"browser":"client"},send_browser_cookies:function(a){return a?"browser":"client"},send_custom_headers:function(a){return a?"browser":"client"},stream_upload:function(a){return a?
"client":"browser"},upload_filesize:function(a){return 2097152<=e.parseSizeStr(a)?"client":"browser"}},"client");10>f()&&(this.mode=!1);e.extend(this,{getShim:function(){return d.get(this.uid)},shimExec:function(a,b){var c=[].slice.call(arguments,2);return l.getShim().exec(this.uid,a,b,c)},init:function(){var b,d,f;f=this.getShimContainer();e.extend(f.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"});b='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+
n.swf_url+'" ';"IE"===c.browser&&(b+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" ');b+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+n.swf_url+'" /><param name="flashvars" value="uid='+escape(this.uid)+"&target="+c.global_event_dispatcher+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>';"IE"===c.browser?(d=document.createElement("div"),f.appendChild(d),d.outerHTML=b,d=f=null):f.innerHTML=b;w=setTimeout(function(){l&&
!l.initialized&&l.trigger("Error",new a.RuntimeError(a.RuntimeError.NOT_INIT_ERR))},5E3)},destroy:function(a){return function(){h(l.uid);a.call(l);clearTimeout(w);n=w=a=l=null}}(this.destroy)},k)}),k});h("moxie/runtime/flash/file/FileInput",["moxie/runtime/flash/Runtime","moxie/file/File","moxie/core/utils/Basic"],function(e,c,d){return e.FileInput={init:function(a){var b=this,e=this.getRuntime();this.bind("Change",function(){var a=e.shimExec.call(b,"FileInput","getFiles");b.files=[];d.each(a,function(a){b.files.push(new c(e.uid,
a))})},999);this.getRuntime().shimExec.call(this,"FileInput","init",{name:a.name,accept:a.accept,multiple:a.multiple});this.trigger("ready")}}});h("moxie/runtime/flash/file/Blob",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(e,c){return e.Blob={slice:function(d,a,b,e){var f=this.getRuntime();return 0>a?a=Math.max(d.size+a,0):0<a&&(a=Math.min(a,d.size)),0>b?b=Math.max(d.size+b,0):0<b&&(b=Math.min(b,d.size)),d=f.shimExec.call(this,"Blob","slice",a,b,e||""),d&&(d=new c(f.uid,d)),d}}});h("moxie/runtime/flash/file/FileReader",
["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(e,c){function d(a,b){switch(b){case "readAsText":return c.atob(a,"utf8");case "readAsBinaryString":return c.atob(a);case "readAsDataURL":return a}return null}return e.FileReader={read:function(a,b){var c=this;return c.result="","readAsDataURL"===a&&(c.result="data:"+(b.type||"")+";base64,"),c.bind("Progress",function(b,e){e&&(c.result+=d(e,a))},999),c.getRuntime().shimExec.call(this,"FileReader","readAsBase64",b.uid)}}});h("moxie/runtime/flash/file/FileReaderSync",
["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(e,c){function d(a,b){switch(b){case "readAsText":return c.atob(a,"utf8");case "readAsBinaryString":return c.atob(a);case "readAsDataURL":return a}return null}return e.FileReaderSync={read:function(a,b){var c;return(c=this.getRuntime().shimExec.call(this,"FileReaderSync","readAsBase64",b.uid))?("readAsDataURL"===a&&(c="data:"+(b.type||"")+";base64,"+c),d(c,a,b.type)):null}}});h("moxie/runtime/flash/xhr/XMLHttpRequest","moxie/runtime/flash/Runtime moxie/core/utils/Basic moxie/file/Blob moxie/file/File moxie/file/FileReaderSync moxie/xhr/FormData moxie/runtime/Transporter".split(" "),
function(e,c,d,a,b,f,h){return e.XMLHttpRequest={send:function(a,b){function e(){a.transport=s.mode;s.shimExec.call(n,"XMLHttpRequest","send",a,b)}function g(a,c){s.shimExec.call(n,"XMLHttpRequest","appendBlob",a,c.uid);b=null;e()}function k(a,b){var c=new h;c.bind("TransportingComplete",function(){b(this.result)});c.transport(a.getSource(),a.type,{ruid:s.uid})}var n=this,s=n.getRuntime();if(c.isEmptyObj(a.headers)||c.each(a.headers,function(a,b){s.shimExec.call(n,"XMLHttpRequest","setRequestHeader",
b,a.toString())}),b instanceof f){var u;if(b.each(function(a,b){a instanceof d?u=b:s.shimExec.call(n,"XMLHttpRequest","append",b,a)}),b.hasBlob()){var x=b.getBlob();x.isDetached()?k(x,function(a){x.destroy();g(u,a)}):g(u,x)}else b=null,e()}else b instanceof d?b.isDetached()?k(b,function(a){b.destroy();b=a.uid;e()}):(b=b.uid,e()):e()},getResponse:function(d){var e,f,g=this.getRuntime();if(f=g.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob")){if(f=new a(g.uid,f),"blob"===d)return f;try{if(e=
new b,~c.inArray(d,["","text"]))return e.readAsText(f);if("json"===d&&window.JSON)return JSON.parse(e.readAsText(f))}finally{f.destroy()}}return null},abort:function(a){this.getRuntime().shimExec.call(this,"XMLHttpRequest","abort");this.dispatchEvent("readystatechange");this.dispatchEvent("abort")}}});h("moxie/runtime/flash/runtime/Transporter",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(e,c){return e.Transporter={getAsBlob:function(d){var a=this.getRuntime();return(d=a.shimExec.call(this,
"Transporter","getAsBlob",d))?new c(a.uid,d):null}}});h("moxie/runtime/flash/image/Image",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/runtime/Transporter","moxie/file/Blob","moxie/file/FileReaderSync"],function(e,c,d,a,b){return e.Image={loadFromBlob:function(a){function b(a){e.shimExec.call(c,"Image","loadFromBlob",a.uid);c=e=null}var c=this,e=c.getRuntime();if(a.isDetached()){var f=new d;f.bind("TransportingComplete",function(){b(f.result.getSource())});f.transport(a.getSource(),
a.type,{ruid:e.uid})}else b(a.getSource())},loadFromImage:function(a){return this.getRuntime().shimExec.call(this,"Image","loadFromImage",a.uid)},getInfo:function(){var b=this.getRuntime(),c=b.shimExec.call(this,"Image","getInfo");return!c.meta||!c.meta.thumb||c.meta.thumb.data instanceof a||(c.meta.thumb.data=new a(b.uid,c.meta.thumb.data)),c},getAsBlob:function(b,c){var d=this.getRuntime(),e=d.shimExec.call(this,"Image","getAsBlob",b,c);return e?new a(d.uid,e):null},getAsDataURL:function(){var a=
this.getRuntime().Image.getAsBlob.apply(this,arguments),c;return a?(c=new b,c.readAsDataURL(a)):null}}});h("moxie/runtime/silverlight/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(e,c,d,a,b){function f(a){var b=!1,c=null,d,e,g,h,k,m=0;try{try{c=new ActiveXObject("AgControl.AgControl"),c.IsVersionSupported(a)&&(b=!0)}catch(p){var n=navigator.plugins["Silverlight Plug-In"];if(n){d=n.description;"1.0.30226.2"===
d&&(d="2.0.30226.2");for(e=d.split(".");3<e.length;)e.pop();for(;4>e.length;)e.push(0);for(g=a.split(".");4<g.length;)g.pop();do h=parseInt(g[m],10),k=parseInt(e[m],10),m++;while(m<g.length&&h===k);k>=h&&!isNaN(h)&&(b=!0)}}}catch(u){b=!1}return b}var h={};return b.addConstructor("silverlight",function(k){var n=this,l;k=e.extend({xap_url:c.xap_url},k);b.call(this,k,"silverlight",{access_binary:b.capTrue,access_image_binary:b.capTrue,display_media:b.capTrue,do_cors:b.capTrue,drag_and_drop:!1,report_upload_progress:b.capTrue,
resize_image:b.capTrue,return_response_headers:function(a){return a&&"client"===n.mode},return_response_type:function(a){return"json"!==a?!0:!!window.JSON},return_status_code:function(a){return"client"===n.mode||!e.arrayDiff(a,[200,404])},select_file:b.capTrue,select_multiple:b.capTrue,send_binary_string:b.capTrue,send_browser_cookies:function(a){return a&&"browser"===n.mode},send_custom_headers:function(a){return a&&"client"===n.mode},send_multipart:b.capTrue,slice_blob:b.capTrue,stream_upload:!0,
summon_file_dialog:!1,upload_filesize:b.capTrue,use_http_method:function(a){return"client"===n.mode||!e.arrayDiff(a,["GET","POST"])}},{return_response_headers:function(a){return a?"client":"browser"},return_status_code:function(a){return e.arrayDiff(a,[200,404])?"client":["client","browser"]},send_browser_cookies:function(a){return a?"browser":"client"},send_custom_headers:function(a){return a?"client":"browser"},use_http_method:function(a){return e.arrayDiff(a,["GET","POST"])?"client":["client",
"browser"]}});f("2.0.31005.0")&&"Opera"!==c.browser||(this.mode=!1);e.extend(this,{getShim:function(){return d.get(this.uid).content.Moxie},shimExec:function(a,b){var c=[].slice.call(arguments,2);return n.getShim().exec(this.uid,a,b,c)},init:function(){this.getShimContainer().innerHTML='<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="'+k.xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid='+
this.uid+",target="+c.global_event_dispatcher+'"/></object>';l=setTimeout(function(){n&&!n.initialized&&n.trigger("Error",new a.RuntimeError(a.RuntimeError.NOT_INIT_ERR))},"Windows"!==c.OS?1E4:5E3)},destroy:function(a){return function(){a.call(n);clearTimeout(l);k=l=a=n=null}}(this.destroy)},h)}),h});h("moxie/runtime/silverlight/file/FileInput",["moxie/runtime/silverlight/Runtime","moxie/file/File","moxie/core/utils/Basic"],function(e,c,d){return e.FileInput={init:function(a){var b=this,e=this.getRuntime();
this.bind("Change",function(){var a=e.shimExec.call(b,"FileInput","getFiles");b.files=[];d.each(a,function(a){b.files.push(new c(e.uid,a))})},999);this.getRuntime().shimExec.call(this,"FileInput","init",function(a){for(var b="",c=0;c<a.length;c++)b+=(""!==b?"|":"")+a[c].title+" | *."+a[c].extensions.replace(/,/g,";*.");return b}(a.accept),a.name,a.multiple);this.trigger("ready")}}});h("moxie/runtime/silverlight/file/Blob",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/Blob"],
function(e,c,d){return e.Blob=c.extend({},d)});h("moxie/runtime/silverlight/file/FileDrop",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Dom","moxie/core/utils/Events"],function(e,c,d){return e.FileDrop={init:function(){var a=this.getRuntime(),b;return b=a.getShimContainer(),d.addEvent(b,"dragover",function(a){a.preventDefault();a.stopPropagation();a.dataTransfer.dropEffect="copy"},this.uid),d.addEvent(b,"dragenter",function(b){b.preventDefault();c.get(a.uid).dragEnter(b)&&b.stopPropagation()},
this.uid),d.addEvent(b,"drop",function(b){b.preventDefault();c.get(a.uid).dragDrop(b)&&b.stopPropagation()},this.uid),a.shimExec.call(this,"FileDrop","init")}}});h("moxie/runtime/silverlight/file/FileReader",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReader"],function(e,c,d){return e.FileReader=c.extend({},d)});h("moxie/runtime/silverlight/file/FileReaderSync",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReaderSync"],
function(e,c,d){return e.FileReaderSync=c.extend({},d)});h("moxie/runtime/silverlight/xhr/XMLHttpRequest",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/xhr/XMLHttpRequest"],function(e,c,d){return e.XMLHttpRequest=c.extend({},d)});h("moxie/runtime/silverlight/runtime/Transporter",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/runtime/Transporter"],function(e,c,d){return e.Transporter=c.extend({},d)});h("moxie/runtime/silverlight/image/Image",
["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/file/Blob","moxie/runtime/flash/image/Image"],function(e,c,d,a){return e.Image=c.extend({},a,{getInfo:function(){var a=this.getRuntime(),e=["tiff","exif","gps","thumb"],f={meta:{}},g=a.shimExec.call(this,"Image","getInfo");return g.meta&&(c.each(e,function(a){var b=g.meta[a],c,d,e,h;if(b&&b.keys)for(f.meta[a]={},d=0,e=b.keys.length;e>d;d++)c=b.keys[d],(h=b[c])&&(/^(\d|[1-9]\d+)$/.test(h)?h=parseInt(h,10):/^\d*\.\d+$/.test(h)&&(h=
parseFloat(h)),f.meta[a][c]=h)}),!f.meta||!f.meta.thumb||f.meta.thumb.data instanceof d||(f.meta.thumb.data=new d(a.uid,f.meta.thumb.data))),f.width=parseInt(g.width,10),f.height=parseInt(g.height,10),f.size=parseInt(g.size,10),f.type=g.type,f.name=g.name,f}})});h("moxie/runtime/html4/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(e,c,d,a){var b={};return d.addConstructor("html4",function(c){var f=this,h=d.capTest,k=d.capTrue;d.call(this,
c,"html4",{access_binary:h(window.FileReader||window.File&&File.getAsDataURL),access_image_binary:!1,display_media:h(b.Image&&(a.can("create_canvas")||a.can("use_data_uri_over32kb"))),do_cors:!1,drag_and_drop:!1,filter_by_extension:h("Chrome"===a.browser&&a.verComp(a.version,28,">=")||"IE"===a.browser&&a.verComp(a.version,10,">=")||"Safari"===a.browser&&a.verComp(a.version,7,">=")),resize_image:function(){return b.Image&&f.can("access_binary")&&a.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,
return_response_type:function(a){return"json"===a&&window.JSON?!0:!!~e.inArray(a,["text","document",""])},return_status_code:function(a){return!e.arrayDiff(a,[200,404])},select_file:function(){return a.can("use_fileinput")},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function(){return f.can("select_file")},summon_file_dialog:function(){return f.can("select_file")&&("Firefox"===a.browser&&a.verComp(a.version,4,">=")||"Opera"===a.browser&&
a.verComp(a.version,12,">=")||"IE"===a.browser&&a.verComp(a.version,10,">=")||!!~e.inArray(a.browser,["Chrome","Safari"]))},upload_filesize:k,use_http_method:function(a){return!e.arrayDiff(a,["GET","POST"])}});e.extend(this,{init:function(){this.trigger("Init")},destroy:function(a){return function(){a.call(f);a=f=null}}(this.destroy)});e.extend(this.getShim(),b)}),b});h("moxie/runtime/html4/file/FileInput","moxie/runtime/html4/Runtime moxie/file/File moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Events moxie/core/utils/Mime moxie/core/utils/Env".split(" "),
function(e,c,d,a,b,f,h){return e.FileInput=function(){function e(){var f=this,p=f.getRuntime(),s,u,x,z,A,E;E=d.guid("uid_");s=p.getShimContainer();g&&(x=a.get(g+"_form"),x&&d.extend(x.style,{top:"100%"}));z=document.createElement("form");z.setAttribute("id",E+"_form");z.setAttribute("method","post");z.setAttribute("enctype","multipart/form-data");z.setAttribute("encoding","multipart/form-data");d.extend(z.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"});A=document.createElement("input");
A.setAttribute("id",E);A.setAttribute("type","file");A.setAttribute("name",n.name||"Filedata");A.setAttribute("accept",k.join(","));d.extend(A.style,{fontSize:"999px",opacity:0});z.appendChild(A);s.appendChild(z);d.extend(A.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"});"IE"===h.browser&&h.verComp(h.version,10,"<")&&d.extend(A.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"});A.onchange=function(){var a;if(this.value){if(this.files){if(a=this.files[0],0===
a.size)return void z.parentNode.removeChild(z)}else a={name:this.value};a=new c(p.uid,a);this.onchange=function(){};e.call(f);f.files=[a];A.setAttribute("id",a.uid);z.setAttribute("id",a.uid+"_form");f.trigger("change");A=z=null}};p.can("summon_file_dialog")&&(u=a.get(n.browse_button),b.removeEvent(u,"click",f.uid),b.addEvent(u,"click",function(a){A&&!A.disabled&&A.click();a.preventDefault()},f.uid));g=E;s=x=u=null}var g,k=[],n;d.extend(this,{init:function(c){var d=this,g=d.getRuntime(),h;n=c;k=c.accept.mimes||
f.extList2mimes(c.accept,g.can("filter_by_extension"));h=g.getShimContainer();(function(){var e,f;e=a.get(c.browse_button);g.can("summon_file_dialog")&&("static"===a.getStyle(e,"position")&&(e.style.position="relative"),f=parseInt(a.getStyle(e,"z-index"),10)||1,e.style.zIndex=f,h.style.zIndex=f-1);e=g.can("summon_file_dialog")?e:h;b.addEvent(e,"mouseover",function(){d.trigger("mouseenter")},d.uid);b.addEvent(e,"mouseout",function(){d.trigger("mouseleave")},d.uid);b.addEvent(e,"mousedown",function(){d.trigger("mousedown")},
d.uid);b.addEvent(a.get(c.container),"mouseup",function(){d.trigger("mouseup")},d.uid);e=null})();e.call(this);h=null;d.trigger({type:"ready",async:!0})},disable:function(b){var c;(c=a.get(g))&&(c.disabled=!!b)},destroy:function(){var c=this.getRuntime(),d=c.getShim(),c=c.getShimContainer();b.removeAllEvents(c,this.uid);b.removeAllEvents(n&&a.get(n.container),this.uid);b.removeAllEvents(n&&a.get(n.browse_button),this.uid);c&&(c.innerHTML="");d.removeInstance(this.uid);g=k=n=null}})}});h("moxie/runtime/html4/file/FileReader",
["moxie/runtime/html4/Runtime","moxie/runtime/html5/file/FileReader"],function(e,c){return e.FileReader=c});h("moxie/runtime/html4/xhr/XMLHttpRequest","moxie/runtime/html4/Runtime moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Url moxie/core/Exceptions moxie/core/utils/Events moxie/file/Blob moxie/xhr/FormData".split(" "),function(e,c,d,a,b,f,h,k){return e.XMLHttpRequest=function(){function e(a){var b=this,c,g,h,k=!1;if(r){if(c=r.id.replace(/_iframe$/,""),g=d.get(c+"_form")){c=g.getElementsByTagName("input");
for(h=c.length;h--;)switch(c[h].getAttribute("type")){case "hidden":c[h].parentNode.removeChild(c[h]);break;case "file":k=!0}c=[];k||g.parentNode.removeChild(g);g=null}setTimeout(function(){f.removeEvent(r,"load",b.uid);r.parentNode&&r.parentNode.removeChild(r);var c=b.getRuntime().getShimContainer();c.children.length||c.parentNode.removeChild(c);r=null;a()},1)}}var g,n,r;c.extend(this,{send:function(u,s){var y=this,x=y.getRuntime(),z,A,E,D;if(g=n=null,s instanceof k&&s.hasBlob()){if(D=s.getBlob(),
z=D.uid,E=d.get(z),A=d.get(z+"_form"),!A)throw new b.DOMException(b.DOMException.NOT_FOUND_ERR);}else z=c.guid("uid_"),A=document.createElement("form"),A.setAttribute("id",z+"_form"),A.setAttribute("method",u.method),A.setAttribute("enctype","multipart/form-data"),A.setAttribute("encoding","multipart/form-data"),x.getShimContainer().appendChild(A);A.setAttribute("target",z+"_iframe");s instanceof k&&s.each(function(a,b){if(a instanceof h)E&&E.setAttribute("name",b);else{var d=document.createElement("input");
c.extend(d,{type:"hidden",name:b,value:a});E?A.insertBefore(d,E):A.appendChild(d)}});A.setAttribute("action",u.url);(function(){var b=x.getShimContainer()||document.body,d=document.createElement("div");d.innerHTML='<iframe id="'+z+'_iframe" name="'+z+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>';r=d.firstChild;b.appendChild(r);f.addEvent(r,"load",function(){var b;try{b=r.contentWindow.document||r.contentDocument||window.frames[r.id].document,/^4(0[0-9]|1[0-7]|2[2346])\s/.test(b.title)?
g=b.title.replace(/^(\d+).*$/,"$1"):(g=200,n=c.trim(b.body.innerHTML),y.trigger({type:"progress",loaded:n.length,total:n.length}),D&&y.trigger({type:"uploadprogress",loaded:D.size||1025,total:D.size||1025}))}catch(d){if(!a.hasSameOrigin(u.url))return void e.call(y,function(){y.trigger("error")});g=404}e.call(y,function(){y.trigger("load")})},y.uid)})();A.submit();y.trigger("loadstart")},getStatus:function(){return g},getResponse:function(a){if("json"===a&&"string"===c.typeOf(n)&&window.JSON)try{return JSON.parse(n.replace(/^\s*<pre[^>]*>/,
"").replace(/<\/pre>\s*$/,""))}catch(b){return null}return n},abort:function(){var a=this;r&&r.contentWindow&&(r.contentWindow.stop?r.contentWindow.stop():r.contentWindow.document.execCommand?r.contentWindow.document.execCommand("Stop"):r.src="about:blank");e.call(this,function(){a.dispatchEvent("abort")})}})}});h("moxie/runtime/html4/image/Image",["moxie/runtime/html4/Runtime","moxie/runtime/html5/image/Image"],function(e,c){return e.Image=c});(function(g){for(var c=0;c<g.length;c++){for(var d=f,
a=g[c],b=a.split(/[.\/]/),h=0;h<b.length-1;++h)d[b[h]]===e&&(d[b[h]]={}),d=d[b[h]];d[b[b.length-1]]=n[a]}})("moxie/core/utils/Basic moxie/core/utils/Env moxie/core/I18n moxie/core/utils/Mime moxie/core/utils/Dom moxie/core/Exceptions moxie/core/EventTarget moxie/runtime/Runtime moxie/runtime/RuntimeClient moxie/file/FileInput moxie/core/utils/Encode moxie/file/Blob moxie/file/File moxie/file/FileDrop moxie/file/FileReader moxie/core/utils/Url moxie/runtime/RuntimeTarget moxie/file/FileReaderSync moxie/xhr/FormData moxie/xhr/XMLHttpRequest moxie/runtime/Transporter moxie/image/Image moxie/core/utils/Events".split(" "))}(this);
(function(f){var e={},k=f.moxie.core.utils.Basic.inArray;return function n(f){var c,d;for(c in f)d=typeof f[c],"object"!==d||~k(c,["Exceptions","Env","Mime"])?"function"===d&&(e[c]=f[c]):n(f[c])}(f.moxie),e.Env=f.moxie.core.utils.Env,e.Mime=f.moxie.core.utils.Mime,e.Exceptions=f.moxie.core.Exceptions,f.mOxie=e,f.o||(f.o=e),e})(this);(function(f,e,k){function h(d){function a(a,b,c){var d={chunks:"slice_blob",jpgresize:"send_binary_string",pngresize:"send_binary_string",progress:"report_upload_progress",
multi_selection:"select_multiple",dragdrop:"drag_and_drop",drop_element:"drag_and_drop",headers:"send_custom_headers",urlstream_upload:"send_binary_string",canSendBinary:"send_binary",triggerDialog:"summon_file_dialog"};d[a]?e[d[a]]=b:c||(e[a]=b)}var b=d.required_features,e={};if("string"==typeof b)c.each(b.split(/\s*,\s*/),function(b){a(b,!0)});else if("object"==typeof b)c.each(b,function(b,c){a(c,b)});else if(!0===b){0<d.chunk_size&&(e.slice_blob=!0);if(d.resize.enabled||!d.multipart)e.send_binary_string=
!0;c.each(d,function(b,c){a(c,!!b,!0)})}return e}var n=f.setTimeout,g={},c={VERSION:"2.1.8",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,FILE_DUPLICATE_ERROR:-602,IMAGE_FORMAT_ERROR:-700,MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:e.mimes,ua:e.ua,typeOf:e.typeOf,extend:e.extend,guid:e.guid,get:function(c){var a=[],b;"array"!==e.typeOf(c)&&(c=[c]);
for(var f=c.length;f--;)(b=e.get(c[f]))&&a.push(b);return a.length?a:null},each:e.each,getPos:e.getPos,getSize:e.getSize,xmlEncode:function(c){var a={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},b=/[<>&\"\']/g;return c?(""+c).replace(b,function(b){return a[b]?"&"+a[b]+";":b}):c},toArray:e.toArray,inArray:e.inArray,addI18n:e.addI18n,translate:e.translate,isEmptyObj:e.isEmptyObj,hasClass:e.hasClass,addClass:e.addClass,removeClass:e.removeClass,getStyle:e.getStyle,addEvent:e.addEvent,removeEvent:e.removeEvent,
removeAllEvents:e.removeAllEvents,cleanName:function(c){var a,b;b=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"];for(a=0;a<b.length;a+=2)c=c.replace(b[a],b[a+1]);return c=c.replace(/\s+/g,"_"),c=c.replace(/[^a-z0-9_\-\.]+/gi,""),c},buildUrl:function(d,a){var b="";return c.each(a,function(a,c){b+=(b?"&":"")+
encodeURIComponent(c)+"="+encodeURIComponent(a)}),b&&(d+=(0<d.indexOf("?")?"&":"?")+b),d},formatSize:function(d){function a(a,b){return Math.round(a*Math.pow(10,b))/Math.pow(10,b)}if(d===k||/\D/.test(d))return c.translate("N/A");var b=Math.pow(1024,4);return d>b?a(d/b,1)+" "+c.translate("tb"):d>(b/=1024)?a(d/b,1)+" "+c.translate("gb"):d>(b/=1024)?a(d/b,1)+" "+c.translate("mb"):1024<d?Math.round(d/1024)+" "+c.translate("kb"):d+" "+c.translate("b")},parseSize:e.parseSizeStr,predictRuntime:function(d,
a){var b,f;return b=new c.Uploader(d),f=e.Runtime.thatCan(b.getOption().required_features,a||d.runtimes),b.destroy(),f},addFileFilter:function(c,a){g[c]=a}};c.addFileFilter("mime_types",function(d,a,b){d.length&&!d.regexp.test(a.name)?(this.trigger("Error",{code:c.FILE_EXTENSION_ERROR,message:c.translate("File extension error."),file:a}),b(!1)):b(!0)});c.addFileFilter("max_file_size",function(d,a,b){d=c.parseSize(d);void 0!==a.size&&d&&a.size>d?(this.trigger("Error",{code:c.FILE_SIZE_ERROR,message:c.translate("File size error."),
file:a}),b(!1)):b(!0)});c.addFileFilter("prevent_duplicates",function(d,a,b){if(d)for(d=this.files.length;d--;)if(a.name===this.files[d].name&&a.size===this.files[d].size){this.trigger("Error",{code:c.FILE_DUPLICATE_ERROR,message:c.translate("Duplicate file error."),file:a});b(!1);return}b(!0)});c.Uploader=function(d){function a(){var a,b=0,d;if(this.state==c.STARTED){for(d=0;d<G.length;d++)a||G[d].status!=c.QUEUED?b++:(a=G[d],this.trigger("BeforeUpload",a)&&(a.status=c.UPLOADING,this.trigger("UploadFile",
a)));b==G.length&&(this.state!==c.STOPPED&&(this.state=c.STOPPED,this.trigger("StateChanged")),this.trigger("UploadComplete",G))}}function b(a){a.percent=0<a.size?Math.ceil(100*(a.loaded/a.size)):100;f()}function f(){var a,b;F.reset();for(a=0;a<G.length;a++)b=G[a],b.size!==k?(F.size+=b.origSize,F.loaded+=b.loaded*b.origSize/b.size):F.size=k,b.status==c.DONE?F.uploaded++:b.status==c.FAILED?F.failed++:F.queued++;F.size===k?F.percent=0<G.length?Math.ceil(100*(F.uploaded/G.length)):0:(F.bytesPerSec=Math.ceil(F.loaded/
((+new Date-C||1)/1E3)),F.percent=0<F.size?Math.ceil(100*(F.loaded/F.size)):0)}function m(){var a=M[0]||P[0];return a?a.getRuntime().uid:!1}function q(a,b){if(a.ruid){var c=e.Runtime.getInfo(a.ruid);if(c)return c.can(b)}return!1}function t(){this.bind("FilesAdded FilesRemoved",function(a){a.trigger("QueueChanged");a.refresh()});this.bind("CancelUpload",z);this.bind("BeforeUpload",v);this.bind("UploadFile",s);this.bind("UploadProgress",y);this.bind("StateChanged",x);this.bind("QueueChanged",f);this.bind("Error",
E);this.bind("FileUploaded",A);this.bind("Destroy",D)}function l(a,b){var d=this,f=0,g=[],h={runtime_order:a.runtimes,required_caps:a.required_features,preferred_caps:J,swf_url:a.flash_swf_url,xap_url:a.silverlight_xap_url};c.each(a.runtimes.split(/\s*,\s*/),function(b){a[b]&&(h[b]=a[b])});a.browse_button&&c.each(a.browse_button,function(b){g.push(function(g){var k=new e.FileInput(c.extend({},h,{accept:a.filters.mime_types,name:a.file_data_name,multiple:a.multi_selection,container:a.container,browse_button:b}));
k.onready=function(){var a=e.Runtime.getInfo(this.ruid);e.extend(d.features,{chunks:a.can("slice_blob"),multipart:a.can("send_multipart"),multi_selection:a.can("select_multiple")});f++;M.push(this);g()};k.onchange=function(){d.addFile(this.files)};k.bind("mouseenter mouseleave mousedown mouseup",function(c){I||(a.browse_button_hover&&("mouseenter"===c.type?e.addClass(b,a.browse_button_hover):"mouseleave"===c.type&&e.removeClass(b,a.browse_button_hover)),a.browse_button_active&&("mousedown"===c.type?
e.addClass(b,a.browse_button_active):"mouseup"===c.type&&e.removeClass(b,a.browse_button_active)))});k.bind("mousedown",function(){d.trigger("Browse")});k.bind("error runtimeerror",function(){k=null;g()});k.init()})});a.drop_element&&c.each(a.drop_element,function(a){g.push(function(b){var g=new e.FileDrop(c.extend({},h,{drop_zone:a}));g.onready=function(){var a=e.Runtime.getInfo(this.ruid);d.features.dragdrop=a.can("drag_and_drop");f++;P.push(this);b()};g.ondrop=function(){d.addFile(this.files)};
g.bind("error runtimeerror",function(){g=null;b()});g.init()})});e.inSeries(g,function(){"function"==typeof b&&b(f)})}function u(a,b,c){var d=new e.Image;try{d.onload=function(){if(b.width>this.width&&b.height>this.height&&b.quality===k&&b.preserve_headers&&!b.crop)return this.destroy(),c(a);d.downsize(b.width,b.height,b.crop,b.preserve_headers)},d.onresize=function(){c(this.getAsBlob(a.type,b.quality));this.destroy()},d.onerror=function(){c(a)},d.load(a)}catch(f){c(a)}}function r(a,b,d){function f(a,
b,d){var e=B[a];switch(a){case "max_file_size":"max_file_size"===a&&(B.max_file_size=B.filters.max_file_size=b);break;case "chunk_size":if(b=c.parseSize(b))B[a]=b,B.send_file_name=!0;break;case "multipart":(B[a]=b)||(B.send_file_name=!0);break;case "unique_names":(B[a]=b)&&(B.send_file_name=!0);break;case "filters":"array"===c.typeOf(b)&&(b={mime_types:b});d?c.extend(B.filters,b):B.filters=b;b.mime_types&&(B.filters.mime_types.regexp=function(a){var b=[];return c.each(a,function(a){c.each(a.extensions.split(/,/),
function(a){/^\s*\*\s*$/.test(a)?b.push("\\.*"):b.push("\\."+a.replace(RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),RegExp("("+b.join("|")+")$","i")}(B.filters.mime_types));break;case "resize":d?c.extend(B.resize,b,{enabled:!0}):B.resize=b;break;case "prevent_duplicates":B.prevent_duplicates=B.filters.prevent_duplicates=!!b;break;case "browse_button":case "drop_element":b=c.get(b);case "container":case "runtimes":case "multi_selection":case "flash_swf_url":case "silverlight_xap_url":B[a]=
b;d||(k=!0);break;default:B[a]=b}d||g.trigger("OptionChanged",a,b,e)}var g=this,k=!1;"object"==typeof a?c.each(a,function(a,b){f(b,a,d)}):f(a,b,d);d?(B.required_features=h(c.extend({},B)),J=h(c.extend({},B,{required_features:!0}))):k&&(g.trigger("Destroy"),l.call(g,B,function(a){a?(g.runtime=e.Runtime.getInfo(m()).type,g.trigger("Init",{runtime:g.runtime}),g.trigger("PostInit")):g.trigger("Error",{code:c.INIT_ERROR,message:c.translate("Init error.")})}))}function v(a,b){if(a.settings.unique_names){var c=
b.name.match(/\.([^.]+)$/),d="part";c&&(d=c[1]);b.target_name=b.id+"."+d}}function s(a,b){function d(){0<k--?n(f,1E3):(b.loaded=m,a.trigger("Error",{code:c.HTTP_ERROR,message:c.translate("HTTP Error."),file:b,response:K.responseText,status:K.status,responseHeaders:K.getAllResponseHeaders()}))}function f(){var q,r,s={},t;b.status===c.UPLOADING&&a.state!==c.STOPPED&&(a.settings.send_file_name&&(s.name=b.target_name||b.name),h&&l.chunks&&p.size>h?(t=Math.min(h,p.size-m),q=p.slice(m,m+t)):(t=p.size,q=
p),h&&l.chunks&&(a.settings.send_chunk_number?(s.chunk=Math.ceil(m/h),s.chunks=Math.ceil(p.size/h)):(s.offset=m,s.total=p.size)),K=new e.XMLHttpRequest,K.upload&&(K.upload.onprogress=function(c){b.loaded=Math.min(b.size,m+c.loaded);a.trigger("UploadProgress",b)}),K.onload=function(){400<=K.status?d():(k=a.settings.max_retries,t<p.size?(q.destroy(),m+=t,b.loaded=Math.min(m,p.size),a.trigger("ChunkUploaded",b,{offset:b.loaded,total:p.size,response:K.responseText,status:K.status,responseHeaders:K.getAllResponseHeaders()}),
"Android Browser"===e.Env.browser&&a.trigger("UploadProgress",b)):b.loaded=b.size,q=r=null,!m||m>=p.size?(b.size!=b.origSize&&(p.destroy(),p=null),a.trigger("UploadProgress",b),b.status=c.DONE,a.trigger("FileUploaded",b,{response:K.responseText,status:K.status,responseHeaders:K.getAllResponseHeaders()})):n(f,1))},K.onerror=function(){d()},K.onloadend=function(){this.destroy();K=null},a.settings.multipart&&l.multipart?(K.open("post",g,!0),c.each(a.settings.headers,function(a,b){K.setRequestHeader(b,
a)}),r=new e.FormData,c.each(c.extend(s,a.settings.multipart_params),function(a,b){r.append(b,a)}),r.append(a.settings.file_data_name,q),K.send(r,{runtime_order:a.settings.runtimes,required_caps:a.settings.required_features,preferred_caps:J,swf_url:a.settings.flash_swf_url,xap_url:a.settings.silverlight_xap_url})):(g=c.buildUrl(a.settings.url,c.extend(s,a.settings.multipart_params)),K.open("post",g,!0),K.setRequestHeader("Content-Type","application/octet-stream"),c.each(a.settings.headers,function(a,
b){K.setRequestHeader(b,a)}),K.send(q,{runtime_order:a.settings.runtimes,required_caps:a.settings.required_features,preferred_caps:J,swf_url:a.settings.flash_swf_url,xap_url:a.settings.silverlight_xap_url})))}var g=a.settings.url,h=a.settings.chunk_size,k=a.settings.max_retries,l=a.features,m=0,p;b.loaded&&(m=b.loaded=h?h*Math.floor(b.loaded/h):0);p=b.getSource();a.settings.resize.enabled&&q(p,"send_binary_string")&&~e.inArray(p.type,["image/jpeg","image/png"])?u.call(this,p,a.settings.resize,function(a){p=
a;b.size=a.size;f()}):f()}function y(a,c){b(c)}function x(a){if(a.state==c.STARTED)C=+new Date;else if(a.state==c.STOPPED)for(var b=a.files.length-1;0<=b;b--)a.files[b].status==c.UPLOADING&&(a.files[b].status=c.QUEUED,f())}function z(){K&&K.abort()}function A(b){f();n(function(){a.call(b)},1)}function E(d,e){e.code===c.INIT_ERROR?d.destroy():e.code===c.HTTP_ERROR&&(e.file.status=c.FAILED,b(e.file),d.state==c.STARTED&&(d.trigger("CancelUpload"),n(function(){a.call(d)},1)))}function D(a){a.stop();c.each(G,
function(a){a.destroy()});G=[];M.length&&(c.each(M,function(a){a.destroy()}),M=[]);P.length&&(c.each(P,function(a){a.destroy()}),P=[]);J={};I=!1;C=K=null;F.reset()}var L=c.guid(),B,G=[],J={},M=[],P=[],C,F,I=!1,K;B={runtimes:e.Runtime.order,max_retries:0,chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",flash_swf_url:"js/Moxie.swf",silverlight_xap_url:"js/Moxie.xap",filters:{mime_types:[],prevent_duplicates:!1,max_file_size:0},resize:{enabled:!1,preserve_headers:!0,crop:!1},send_file_name:!0,
send_chunk_number:!0};r.call(this,d,null,!0);F=new c.QueueProgress;c.extend(this,{id:L,uid:L,state:c.STOPPED,features:{},runtime:null,files:G,settings:B,total:F,init:function(){var a=this;"function"==typeof B.preinit?B.preinit(a):c.each(B.preinit,function(b,c){a.bind(c,b)});t.call(this);B.browse_button&&B.url?l.call(this,B,function(b){"function"==typeof B.init?B.init(a):c.each(B.init,function(b,c){a.bind(c,b)});b?(a.runtime=e.Runtime.getInfo(m()).type,a.trigger("Init",{runtime:a.runtime}),a.trigger("PostInit")):
a.trigger("Error",{code:c.INIT_ERROR,message:c.translate("Init error.")})}):this.trigger("Error",{code:c.INIT_ERROR,message:c.translate("Init error.")})},setOption:function(a,b){r.call(this,a,b,!this.runtime)},getOption:function(a){return a?B[a]:B},refresh:function(){M.length&&c.each(M,function(a){a.trigger("Refresh")});this.trigger("Refresh")},start:function(){this.state!=c.STARTED&&(this.state=c.STARTED,this.trigger("StateChanged"),a.call(this))},stop:function(){this.state!=c.STOPPED&&(this.state=
c.STOPPED,this.trigger("StateChanged"),this.trigger("CancelUpload"))},disableBrowse:function(a){I=a!==k?a:!0;M.length&&c.each(M,function(a){a.disable(I)});this.trigger("DisableBrowse",I)},getFile:function(a){var b;for(b=G.length-1;0<=b;b--)if(G[b].id===a)return G[b]},addFile:function(a,b){function d(a,b){var c=[];e.each(h.settings.filters,function(b,d){g[d]&&c.push(function(c){g[d].call(h,b,a,function(a){c(!a)})})});e.inSeries(c,b)}function f(a){var g=e.typeOf(a);if(a instanceof e.File){if(!a.ruid&&
!a.isDetached()){if(!p)return!1;a.ruid=p;a.connectRuntime(p)}f(new c.File(a))}else a instanceof e.Blob?(f(a.getSource()),a.destroy()):a instanceof c.File?(b&&(a.name=b),k.push(function(b){d(a,function(c){c||(G.push(a),l.push(a),h.trigger("FileFiltered",a));n(b,1)})})):-1!==e.inArray(g,["file","blob"])?f(new e.File(null,a)):"node"===g&&"filelist"===e.typeOf(a.files)?e.each(a.files,f):"array"===g&&(b=null,e.each(a,f))}var h=this,k=[],l=[],p;p=m();f(a);k.length&&e.inSeries(k,function(){l.length&&h.trigger("FilesAdded",
l)})},removeFile:function(a){a="string"==typeof a?a:a.id;for(var b=G.length-1;0<=b;b--)if(G[b].id===a)return this.splice(b,1)[0]},splice:function(a,b){var d=G.splice(a===k?0:a,b===k?G.length:b),e=!1;return this.state==c.STARTED&&(c.each(d,function(a){if(a.status===c.UPLOADING)return e=!0,!1}),e&&this.stop()),this.trigger("FilesRemoved",d),c.each(d,function(a){a.destroy()}),e&&this.start(),d},dispatchEvent:function(a){var b,c;a=a.toLowerCase();if(b=this.hasEventListener(a)){b.sort(function(a,b){return b.priority-
a.priority});c=[].slice.call(arguments);c.shift();c.unshift(this);for(var d=0;d<b.length;d++)if(!1===b[d].fn.apply(b[d].scope,c))return!1}return!0},bind:function(a,b,d,e){c.Uploader.prototype.bind.call(this,a,b,e,d)},destroy:function(){this.trigger("Destroy");B=F=null;this.unbindAll()}})};c.Uploader.prototype=e.EventTarget.instance;c.File=function(){var d={};return function(a){c.extend(this,{id:c.guid(),name:a.name||a.fileName,type:a.type||"",size:a.size||a.fileSize,origSize:a.size||a.fileSize,loaded:0,
percent:0,status:c.QUEUED,lastModifiedDate:a.lastModifiedDate||(new Date).toLocaleString(),getNative:function(){var a=this.getSource().getSource();return-1!==e.inArray(e.typeOf(a),["blob","file"])?a:null},getSource:function(){return d[this.id]?d[this.id]:null},destroy:function(){var a=this.getSource();a&&(a.destroy(),delete d[this.id])}});d[this.id]=a}}();c.QueueProgress=function(){var c=this;c.size=0;c.loaded=0;c.uploaded=0;c.failed=0;c.queued=0;c.percent=0;c.bytesPerSec=0;c.reset=function(){c.size=
c.loaded=c.uploaded=c.failed=c.queued=c.percent=c.bytesPerSec=0}};f.plupload=c})(window,mOxie);$.telligent=$.telligent||{};$.telligent.evolution=$.telligent.evolution||{};X("components composers events lib modules plugins lib.messageLinks lib.sheetProvider lib.sheet lib.actionSheet module.maxlength lib.touchEventAdapter lib.reflow lib.storageShim lib.imagePreview".split(" "),function(f,e,k,h,n,g,c,d,a,b,p,m,q,t,l,u,r){u(document).ready(function(){t.shim();q.monitor();m.adapt();d.sheet=new a({parent:u("body"),
enablePan:!0,maxHeightPerent:0.8,cssClass:"sheet",backgroundColor:"#333",backgroundOpacity:0.75,animationDuration:250,onOpening:function(){u.telligent.evolution.messaging.publish("sheet.opening")},onClosing:function(){u.telligent.evolution.messaging.publish("sheet.closing")},onOpened:function(){u.telligent.evolution.messaging.publish("sheet.opened")},onClosed:function(){u.telligent.evolution.messaging.publish("sheet.closed")}});d.actionSheet=new b({sheet:d.sheet});(new c({parent:"body"})).handle("click");
u.telligent.evolution.ui.render();p.shim();u.fn.evolutionValidation.init();l.register()})},jQuery,window)})();
